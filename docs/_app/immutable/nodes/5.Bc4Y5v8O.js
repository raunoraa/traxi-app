var ra=Object.defineProperty;var Dn=s=>{throw TypeError(s)};var ia=(s,f,o)=>f in s?ra(s,f,{enumerable:!0,configurable:!0,writable:!0,value:o}):s[f]=o;var Le=(s,f,o)=>ia(s,typeof f!="symbol"?f+"":f,o),Hr=(s,f,o)=>f.has(s)||Dn("Cannot "+o);var O=(s,f,o)=>(Hr(s,f,"read from private field"),o?o.call(s):f.get(s)),xe=(s,f,o)=>f.has(s)?Dn("Cannot add the same private member more than once"):f instanceof WeakSet?f.add(s):f.set(s,o),Oe=(s,f,o,u)=>(Hr(s,f,"write to private field"),u?u.call(s,o):f.set(s,o),o),Ie=(s,f,o)=>(Hr(s,f,"access private method"),o);var gr=(s,f,o,u)=>({set _(c){Oe(s,f,c,o)},get _(){return O(s,f,u)}});import"../chunks/CWj6FrbW.js";import"../chunks/PCJ5bLI3.js";import{z as na,p as oa,C as br,n as Fn,o as sa,b as aa,A as Lr,I as mr,aI as Vr,B as yr,a as la,s as Xe,f as De,D as Zt,E as Ft,F as Wn,J as zr,K as ua,M as ha}from"../chunks/CM7s3TdM.js";import{i as $n,s as ca,a as sr,b as fa}from"../chunks/CZY1Q9bT.js";import{t as Qr,e as da,i as pa,r as ga,s as ba,a as ma,b as ya}from"../chunks/ilezGdhm.js";import{c as wo,b as Kr,s as vo,d as St,e as wa,f as va}from"../chunks/DZQUrvsV.js";import{g as _a}from"../chunks/bJBsW7lg.js";var Tn=Object.defineProperty,Ea=Object.getOwnPropertyDescriptor,Sa=Object.getOwnPropertyNames,Aa=Object.prototype.hasOwnProperty,it=(s,f)=>()=>(s&&(f=s(s=0)),f),me=(s,f)=>()=>(f||s((f={exports:{}}).exports,f),f.exports),rr=(s,f)=>{for(var o in f)Tn(s,o,{get:f[o],enumerable:!0})},Ia=(s,f,o,u)=>{if(f&&typeof f=="object"||typeof f=="function")for(let c of Sa(f))!Aa.call(s,c)&&c!==o&&Tn(s,c,{get:()=>f[c],enumerable:!(u=Ea(f,c))||u.enumerable});return s},Ne=s=>Ia(Tn({},"__esModule",{value:!0}),s),fe=it(()=>{}),Me={};rr(Me,{_debugEnd:()=>Ni,_debugProcess:()=>ji,_events:()=>Zi,_eventsCount:()=>en,_exiting:()=>Si,_fatalExceptions:()=>Mi,_getActiveHandles:()=>To,_getActiveRequests:()=>ko,_kill:()=>ki,_linkedBinding:()=>Ao,_maxListeners:()=>Xi,_preload_modules:()=>Yi,_rawDebug:()=>vi,_startProfilerIdleNotifier:()=>Di,_stopProfilerIdleNotifier:()=>Fi,_tickCallback:()=>Ui,abort:()=>Hi,addListener:()=>tn,allowedNodeEnvironmentFlags:()=>Bi,arch:()=>ai,argv:()=>hi,argv0:()=>Gi,assert:()=>Oo,binding:()=>gi,chdir:()=>yi,config:()=>Ai,cpuUsage:()=>lr,cwd:()=>mi,debugPort:()=>Ki,default:()=>Pn,dlopen:()=>Io,domain:()=>Ei,emit:()=>an,emitWarning:()=>pi,env:()=>ui,execArgv:()=>ci,execPath:()=>Qi,exit:()=>Ci,features:()=>xi,hasUncaughtExceptionCaptureCallback:()=>Po,hrtime:()=>Ar,kill:()=>Pi,listeners:()=>Ro,memoryUsage:()=>Oi,moduleLoadList:()=>_i,nextTick:()=>Eo,off:()=>nn,on:()=>wt,once:()=>rn,openStdin:()=>Ri,pid:()=>Vi,platform:()=>li,ppid:()=>zi,prependListener:()=>ln,prependOnceListener:()=>un,reallyExit:()=>Ii,release:()=>wi,removeAllListeners:()=>sn,removeListener:()=>on,resourceUsage:()=>Ti,setSourceMapsEnabled:()=>Ji,setUncaughtExceptionCaptureCallback:()=>Li,stderr:()=>$i,stdin:()=>qi,stdout:()=>Wi,title:()=>si,umask:()=>bi,uptime:()=>Co,version:()=>fi,versions:()=>di});function On(s){throw new Error("Node.js process "+s+" is not supported by JSPM core outside of Node.js")}function ka(){!Qt||!Vt||(Qt=!1,Vt.length?gt=Vt.concat(gt):cr=-1,gt.length&&_o())}function _o(){if(!Qt){var s=setTimeout(ka,0);Qt=!0;for(var f=gt.length;f;){for(Vt=gt,gt=[];++cr<f;)Vt&&Vt[cr].run();cr=-1,f=gt.length}Vt=null,Qt=!1,clearTimeout(s)}}function Eo(s){var f=new Array(arguments.length-1);if(arguments.length>1)for(var o=1;o<arguments.length;o++)f[o-1]=arguments[o];gt.push(new So(s,f)),gt.length===1&&!Qt&&setTimeout(_o,0)}function So(s,f){this.fun=s,this.array=f}function tt(){}function Ao(s){On("_linkedBinding")}function Io(s){On("dlopen")}function ko(){return[]}function To(){return[]}function Oo(s,f){if(!s)throw new Error(f||"assertion error")}function Po(){return!1}function Co(){return At.now()/1e3}function Ar(s){var f=Math.floor((Date.now()-At.now())*.001),o=At.now()*.001,u=Math.floor(o)+f,c=Math.floor(o%1*1e9);return s&&(u=u-s[0],c=c-s[1],c<0&&(u--,c+=Ir)),[u,c]}function wt(){return Pn}function Ro(s){return[]}var gt,Qt,Vt,cr,si,ai,li,ui,hi,ci,fi,di,pi,gi,bi,mi,yi,wi,vi,_i,Ei,Si,Ai,Ii,ki,lr,Ti,Oi,Pi,Ci,Ri,Bi,xi,Mi,Li,Ui,ji,Ni,Di,Fi,Wi,$i,qi,Hi,Vi,zi,Qi,Ki,Gi,Yi,Ji,At,Gr,Ir,Xi,Zi,en,tn,rn,nn,on,sn,an,ln,un,Pn,Ta=it(()=>{fe(),pe(),de(),gt=[],Qt=!1,cr=-1,So.prototype.run=function(){this.fun.apply(null,this.array)},si="browser",ai="x64",li="browser",ui={PATH:"/usr/bin",LANG:navigator.language+".UTF-8",PWD:"/",HOME:"/home",TMP:"/tmp"},hi=["/usr/bin/node"],ci=[],fi="v16.8.0",di={},pi=function(s,f){console.warn((f?f+": ":"")+s)},gi=function(s){On("binding")},bi=function(s){return 0},mi=function(){return"/"},yi=function(s){},wi={name:"node",sourceUrl:"",headersUrl:"",libUrl:""},vi=tt,_i=[],Ei={},Si=!1,Ai={},Ii=tt,ki=tt,lr=function(){return{}},Ti=lr,Oi=lr,Pi=tt,Ci=tt,Ri=tt,Bi={},xi={inspector:!1,debug:!1,uv:!1,ipv6:!1,tls_alpn:!1,tls_sni:!1,tls_ocsp:!1,tls:!1,cached_builtins:!0},Mi=tt,Li=tt,Ui=tt,ji=tt,Ni=tt,Di=tt,Fi=tt,Wi=void 0,$i=void 0,qi=void 0,Hi=tt,Vi=2,zi=1,Qi="/bin/usr/node",Ki=9229,Gi="node",Yi=[],Ji=tt,At={now:typeof performance<"u"?performance.now.bind(performance):void 0,timing:typeof performance<"u"?performance.timing:void 0},At.now===void 0&&(Gr=Date.now(),At.timing&&At.timing.navigationStart&&(Gr=At.timing.navigationStart),At.now=()=>Date.now()-Gr),Ir=1e9,Ar.bigint=function(s){var f=Ar(s);return typeof BigInt>"u"?f[0]*Ir+f[1]:BigInt(f[0]*Ir)+BigInt(f[1])},Xi=10,Zi={},en=0,tn=wt,rn=wt,nn=wt,on=wt,sn=wt,an=tt,ln=wt,un=wt,Pn={version:fi,versions:di,arch:ai,platform:li,release:wi,_rawDebug:vi,moduleLoadList:_i,binding:gi,_linkedBinding:Ao,_events:Zi,_eventsCount:en,_maxListeners:Xi,on:wt,addListener:tn,once:rn,off:nn,removeListener:on,removeAllListeners:sn,emit:an,prependListener:ln,prependOnceListener:un,listeners:Ro,domain:Ei,_exiting:Si,config:Ai,dlopen:Io,uptime:Co,_getActiveRequests:ko,_getActiveHandles:To,reallyExit:Ii,_kill:ki,cpuUsage:lr,resourceUsage:Ti,memoryUsage:Oi,kill:Pi,exit:Ci,openStdin:Ri,allowedNodeEnvironmentFlags:Bi,assert:Oo,features:xi,_fatalExceptions:Mi,setUncaughtExceptionCaptureCallback:Li,hasUncaughtExceptionCaptureCallback:Po,emitWarning:pi,nextTick:Eo,_tickCallback:Ui,_debugProcess:ji,_debugEnd:Ni,_startProfilerIdleNotifier:Di,_stopProfilerIdleNotifier:Fi,stdout:Wi,stdin:qi,stderr:$i,abort:Hi,umask:bi,chdir:yi,cwd:mi,env:ui,title:si,argv:hi,execArgv:ci,pid:Vi,ppid:zi,execPath:Qi,debugPort:Ki,hrtime:Ar,argv0:Gi,_preload_modules:Yi,setSourceMapsEnabled:Ji}}),de=it(()=>{Ta()}),Ye={};rr(Ye,{Buffer:()=>Br,INSPECT_MAX_BYTES:()=>Bo,default:()=>vt,kMaxLength:()=>xo});function Oa(){if(hn)return tr;hn=!0,tr.byteLength=r,tr.toByteArray=n,tr.fromByteArray=p;for(var s=[],f=[],o=typeof Uint8Array<"u"?Uint8Array:Array,u="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",c=0,i=u.length;c<i;++c)s[c]=u[c],f[u.charCodeAt(c)]=c;f[45]=62,f[95]=63;function e(b){var m=b.length;if(m%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var w=b.indexOf("=");w===-1&&(w=m);var E=w===m?0:4-w%4;return[w,E]}function r(b){var m=e(b),w=m[0],E=m[1];return(w+E)*3/4-E}function t(b,m,w){return(m+w)*3/4-w}function n(b){var m,w=e(b),E=w[0],I=w[1],y=new o(t(b,E,I)),_=0,N=I>0?E-4:E,B;for(B=0;B<N;B+=4)m=f[b.charCodeAt(B)]<<18|f[b.charCodeAt(B+1)]<<12|f[b.charCodeAt(B+2)]<<6|f[b.charCodeAt(B+3)],y[_++]=m>>16&255,y[_++]=m>>8&255,y[_++]=m&255;return I===2&&(m=f[b.charCodeAt(B)]<<2|f[b.charCodeAt(B+1)]>>4,y[_++]=m&255),I===1&&(m=f[b.charCodeAt(B)]<<10|f[b.charCodeAt(B+1)]<<4|f[b.charCodeAt(B+2)]>>2,y[_++]=m>>8&255,y[_++]=m&255),y}function l(b){return s[b>>18&63]+s[b>>12&63]+s[b>>6&63]+s[b&63]}function d(b,m,w){for(var E,I=[],y=m;y<w;y+=3)E=(b[y]<<16&16711680)+(b[y+1]<<8&65280)+(b[y+2]&255),I.push(l(E));return I.join("")}function p(b){for(var m,w=b.length,E=w%3,I=[],y=16383,_=0,N=w-E;_<N;_+=y)I.push(d(b,_,_+y>N?N:_+y));return E===1?(m=b[w-1],I.push(s[m>>2]+s[m<<4&63]+"==")):E===2&&(m=(b[w-2]<<8)+b[w-1],I.push(s[m>>10]+s[m>>4&63]+s[m<<2&63]+"=")),I.join("")}return tr}function Pa(){return cn?ur:(cn=!0,ur.read=function(s,f,o,u,c){var i,e,r=c*8-u-1,t=(1<<r)-1,n=t>>1,l=-7,d=o?c-1:0,p=o?-1:1,b=s[f+d];for(d+=p,i=b&(1<<-l)-1,b>>=-l,l+=r;l>0;i=i*256+s[f+d],d+=p,l-=8);for(e=i&(1<<-l)-1,i>>=-l,l+=u;l>0;e=e*256+s[f+d],d+=p,l-=8);if(i===0)i=1-n;else{if(i===t)return e?NaN:(b?-1:1)*(1/0);e=e+Math.pow(2,u),i=i-n}return(b?-1:1)*e*Math.pow(2,i-u)},ur.write=function(s,f,o,u,c,i){var e,r,t,n=i*8-c-1,l=(1<<n)-1,d=l>>1,p=c===23?Math.pow(2,-24)-Math.pow(2,-77):0,b=u?0:i-1,m=u?1:-1,w=f<0||f===0&&1/f<0?1:0;for(f=Math.abs(f),isNaN(f)||f===1/0?(r=isNaN(f)?1:0,e=l):(e=Math.floor(Math.log(f)/Math.LN2),f*(t=Math.pow(2,-e))<1&&(e--,t*=2),e+d>=1?f+=p/t:f+=p*Math.pow(2,1-d),f*t>=2&&(e++,t/=2),e+d>=l?(r=0,e=l):e+d>=1?(r=(f*t-1)*Math.pow(2,c),e=e+d):(r=f*Math.pow(2,d-1)*Math.pow(2,c),e=0));c>=8;s[o+b]=r&255,b+=m,r/=256,c-=8);for(e=e<<c|r,n+=c;n>0;s[o+b]=e&255,b+=m,e/=256,n-=8);s[o+b-m]|=w*128},ur)}function Ca(){if(fn)return Rt;fn=!0;let s=Oa(),f=Pa(),o=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;Rt.Buffer=e,Rt.SlowBuffer=I,Rt.INSPECT_MAX_BYTES=50;let u=2147483647;Rt.kMaxLength=u,e.TYPED_ARRAY_SUPPORT=c(),!e.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function c(){try{let a=new Uint8Array(1),h={foo:function(){return 42}};return Object.setPrototypeOf(h,Uint8Array.prototype),Object.setPrototypeOf(a,h),a.foo()===42}catch{return!1}}Object.defineProperty(e.prototype,"parent",{enumerable:!0,get:function(){if(e.isBuffer(this))return this.buffer}}),Object.defineProperty(e.prototype,"offset",{enumerable:!0,get:function(){if(e.isBuffer(this))return this.byteOffset}});function i(a){if(a>u)throw new RangeError('The value "'+a+'" is invalid for option "size"');let h=new Uint8Array(a);return Object.setPrototypeOf(h,e.prototype),h}function e(a,h,g){if(typeof a=="number"){if(typeof h=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return l(a)}return r(a,h,g)}e.poolSize=8192;function r(a,h,g){if(typeof a=="string")return d(a,h);if(ArrayBuffer.isView(a))return b(a);if(a==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof a);if(W(a,ArrayBuffer)||a&&W(a.buffer,ArrayBuffer)||typeof SharedArrayBuffer<"u"&&(W(a,SharedArrayBuffer)||a&&W(a.buffer,SharedArrayBuffer)))return m(a,h,g);if(typeof a=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');let v=a.valueOf&&a.valueOf();if(v!=null&&v!==a)return e.from(v,h,g);let T=w(a);if(T)return T;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof a[Symbol.toPrimitive]=="function")return e.from(a[Symbol.toPrimitive]("string"),h,g);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof a)}e.from=function(a,h,g){return r(a,h,g)},Object.setPrototypeOf(e.prototype,Uint8Array.prototype),Object.setPrototypeOf(e,Uint8Array);function t(a){if(typeof a!="number")throw new TypeError('"size" argument must be of type number');if(a<0)throw new RangeError('The value "'+a+'" is invalid for option "size"')}function n(a,h,g){return t(a),a<=0?i(a):h!==void 0?typeof g=="string"?i(a).fill(h,g):i(a).fill(h):i(a)}e.alloc=function(a,h,g){return n(a,h,g)};function l(a){return t(a),i(a<0?0:E(a)|0)}e.allocUnsafe=function(a){return l(a)},e.allocUnsafeSlow=function(a){return l(a)};function d(a,h){if((typeof h!="string"||h==="")&&(h="utf8"),!e.isEncoding(h))throw new TypeError("Unknown encoding: "+h);let g=y(a,h)|0,v=i(g),T=v.write(a,h);return T!==g&&(v=v.slice(0,T)),v}function p(a){let h=a.length<0?0:E(a.length)|0,g=i(h);for(let v=0;v<h;v+=1)g[v]=a[v]&255;return g}function b(a){if(W(a,Uint8Array)){let h=new Uint8Array(a);return m(h.buffer,h.byteOffset,h.byteLength)}return p(a)}function m(a,h,g){if(h<0||a.byteLength<h)throw new RangeError('"offset" is outside of buffer bounds');if(a.byteLength<h+(g||0))throw new RangeError('"length" is outside of buffer bounds');let v;return h===void 0&&g===void 0?v=new Uint8Array(a):g===void 0?v=new Uint8Array(a,h):v=new Uint8Array(a,h,g),Object.setPrototypeOf(v,e.prototype),v}function w(a){if(e.isBuffer(a)){let h=E(a.length)|0,g=i(h);return g.length===0||a.copy(g,0,0,h),g}if(a.length!==void 0)return typeof a.length!="number"||le(a.length)?i(0):p(a);if(a.type==="Buffer"&&Array.isArray(a.data))return p(a.data)}function E(a){if(a>=u)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+u.toString(16)+" bytes");return a|0}function I(a){return+a!=a&&(a=0),e.alloc(+a)}e.isBuffer=function(a){return a!=null&&a._isBuffer===!0&&a!==e.prototype},e.compare=function(a,h){if(W(a,Uint8Array)&&(a=e.from(a,a.offset,a.byteLength)),W(h,Uint8Array)&&(h=e.from(h,h.offset,h.byteLength)),!e.isBuffer(a)||!e.isBuffer(h))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(a===h)return 0;let g=a.length,v=h.length;for(let T=0,U=Math.min(g,v);T<U;++T)if(a[T]!==h[T]){g=a[T],v=h[T];break}return g<v?-1:v<g?1:0},e.isEncoding=function(a){switch(String(a).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},e.concat=function(a,h){if(!Array.isArray(a))throw new TypeError('"list" argument must be an Array of Buffers');if(a.length===0)return e.alloc(0);let g;if(h===void 0)for(h=0,g=0;g<a.length;++g)h+=a[g].length;let v=e.allocUnsafe(h),T=0;for(g=0;g<a.length;++g){let U=a[g];if(W(U,Uint8Array))T+U.length>v.length?(e.isBuffer(U)||(U=e.from(U)),U.copy(v,T)):Uint8Array.prototype.set.call(v,U,T);else if(e.isBuffer(U))U.copy(v,T);else throw new TypeError('"list" argument must be an Array of Buffers');T+=U.length}return v};function y(a,h){if(e.isBuffer(a))return a.length;if(ArrayBuffer.isView(a)||W(a,ArrayBuffer))return a.byteLength;if(typeof a!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof a);let g=a.length,v=arguments.length>2&&arguments[2]===!0;if(!v&&g===0)return 0;let T=!1;for(;;)switch(h){case"ascii":case"latin1":case"binary":return g;case"utf8":case"utf-8":return F(a).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return g*2;case"hex":return g>>>1;case"base64":return re(a).length;default:if(T)return v?-1:F(a).length;h=(""+h).toLowerCase(),T=!0}}e.byteLength=y;function _(a,h,g){let v=!1;if((h===void 0||h<0)&&(h=0),h>this.length||((g===void 0||g>this.length)&&(g=this.length),g<=0)||(g>>>=0,h>>>=0,g<=h))return"";for(a||(a="utf8");;)switch(a){case"hex":return ie(this,h,g);case"utf8":case"utf-8":return q(this,h,g);case"ascii":return te(this,h,g);case"latin1":case"binary":return ae(this,h,g);case"base64":return C(this,h,g);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return ve(this,h,g);default:if(v)throw new TypeError("Unknown encoding: "+a);a=(a+"").toLowerCase(),v=!0}}e.prototype._isBuffer=!0;function N(a,h,g){let v=a[h];a[h]=a[g],a[g]=v}e.prototype.swap16=function(){let a=this.length;if(a%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let h=0;h<a;h+=2)N(this,h,h+1);return this},e.prototype.swap32=function(){let a=this.length;if(a%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let h=0;h<a;h+=4)N(this,h,h+3),N(this,h+1,h+2);return this},e.prototype.swap64=function(){let a=this.length;if(a%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let h=0;h<a;h+=8)N(this,h,h+7),N(this,h+1,h+6),N(this,h+2,h+5),N(this,h+3,h+4);return this},e.prototype.toString=function(){let a=this.length;return a===0?"":arguments.length===0?q(this,0,a):_.apply(this,arguments)},e.prototype.toLocaleString=e.prototype.toString,e.prototype.equals=function(a){if(!e.isBuffer(a))throw new TypeError("Argument must be a Buffer");return this===a?!0:e.compare(this,a)===0},e.prototype.inspect=function(){let a="",h=Rt.INSPECT_MAX_BYTES;return a=this.toString("hex",0,h).replace(/(.{2})/g,"$1 ").trim(),this.length>h&&(a+=" ... "),"<Buffer "+a+">"},o&&(e.prototype[o]=e.prototype.inspect),e.prototype.compare=function(a,h,g,v,T){if(W(a,Uint8Array)&&(a=e.from(a,a.offset,a.byteLength)),!e.isBuffer(a))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof a);if(h===void 0&&(h=0),g===void 0&&(g=a?a.length:0),v===void 0&&(v=0),T===void 0&&(T=this.length),h<0||g>a.length||v<0||T>this.length)throw new RangeError("out of range index");if(v>=T&&h>=g)return 0;if(v>=T)return-1;if(h>=g)return 1;if(h>>>=0,g>>>=0,v>>>=0,T>>>=0,this===a)return 0;let U=T-v,G=g-h,_e=Math.min(U,G),Ee=this.slice(v,T),Te=a.slice(h,g);for(let Be=0;Be<_e;++Be)if(Ee[Be]!==Te[Be]){U=Ee[Be],G=Te[Be];break}return U<G?-1:G<U?1:0};function B(a,h,g,v,T){if(a.length===0)return-1;if(typeof g=="string"?(v=g,g=0):g>2147483647?g=2147483647:g<-2147483648&&(g=-2147483648),g=+g,le(g)&&(g=T?0:a.length-1),g<0&&(g=a.length+g),g>=a.length){if(T)return-1;g=a.length-1}else if(g<0)if(T)g=0;else return-1;if(typeof h=="string"&&(h=e.from(h,v)),e.isBuffer(h))return h.length===0?-1:A(a,h,g,v,T);if(typeof h=="number")return h=h&255,typeof Uint8Array.prototype.indexOf=="function"?T?Uint8Array.prototype.indexOf.call(a,h,g):Uint8Array.prototype.lastIndexOf.call(a,h,g):A(a,[h],g,v,T);throw new TypeError("val must be string, number or Buffer")}function A(a,h,g,v,T){let U=1,G=a.length,_e=h.length;if(v!==void 0&&(v=String(v).toLowerCase(),v==="ucs2"||v==="ucs-2"||v==="utf16le"||v==="utf-16le")){if(a.length<2||h.length<2)return-1;U=2,G/=2,_e/=2,g/=2}function Ee(Be,Ce){return U===1?Be[Ce]:Be.readUInt16BE(Ce*U)}let Te;if(T){let Be=-1;for(Te=g;Te<G;Te++)if(Ee(a,Te)===Ee(h,Be===-1?0:Te-Be)){if(Be===-1&&(Be=Te),Te-Be+1===_e)return Be*U}else Be!==-1&&(Te-=Te-Be),Be=-1}else for(g+_e>G&&(g=G-_e),Te=g;Te>=0;Te--){let Be=!0;for(let Ce=0;Ce<_e;Ce++)if(Ee(a,Te+Ce)!==Ee(h,Ce)){Be=!1;break}if(Be)return Te}return-1}e.prototype.includes=function(a,h,g){return this.indexOf(a,h,g)!==-1},e.prototype.indexOf=function(a,h,g){return B(this,a,h,g,!0)},e.prototype.lastIndexOf=function(a,h,g){return B(this,a,h,g,!1)};function k(a,h,g,v){g=Number(g)||0;let T=a.length-g;v?(v=Number(v),v>T&&(v=T)):v=T;let U=h.length;v>U/2&&(v=U/2);let G;for(G=0;G<v;++G){let _e=parseInt(h.substr(G*2,2),16);if(le(_e))return G;a[g+G]=_e}return G}function M(a,h,g,v){return ce(F(h,a.length-g),a,g,v)}function J(a,h,g,v){return ce(Y(h),a,g,v)}function X(a,h,g,v){return ce(re(h),a,g,v)}function ue(a,h,g,v){return ce(se(h,a.length-g),a,g,v)}e.prototype.write=function(a,h,g,v){if(h===void 0)v="utf8",g=this.length,h=0;else if(g===void 0&&typeof h=="string")v=h,g=this.length,h=0;else if(isFinite(h))h=h>>>0,isFinite(g)?(g=g>>>0,v===void 0&&(v="utf8")):(v=g,g=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");let T=this.length-h;if((g===void 0||g>T)&&(g=T),a.length>0&&(g<0||h<0)||h>this.length)throw new RangeError("Attempt to write outside buffer bounds");v||(v="utf8");let U=!1;for(;;)switch(v){case"hex":return k(this,a,h,g);case"utf8":case"utf-8":return M(this,a,h,g);case"ascii":case"latin1":case"binary":return J(this,a,h,g);case"base64":return X(this,a,h,g);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return ue(this,a,h,g);default:if(U)throw new TypeError("Unknown encoding: "+v);v=(""+v).toLowerCase(),U=!0}},e.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function C(a,h,g){return h===0&&g===a.length?s.fromByteArray(a):s.fromByteArray(a.slice(h,g))}function q(a,h,g){g=Math.min(a.length,g);let v=[],T=h;for(;T<g;){let U=a[T],G=null,_e=U>239?4:U>223?3:U>191?2:1;if(T+_e<=g){let Ee,Te,Be,Ce;switch(_e){case 1:U<128&&(G=U);break;case 2:Ee=a[T+1],(Ee&192)===128&&(Ce=(U&31)<<6|Ee&63,Ce>127&&(G=Ce));break;case 3:Ee=a[T+1],Te=a[T+2],(Ee&192)===128&&(Te&192)===128&&(Ce=(U&15)<<12|(Ee&63)<<6|Te&63,Ce>2047&&(Ce<55296||Ce>57343)&&(G=Ce));break;case 4:Ee=a[T+1],Te=a[T+2],Be=a[T+3],(Ee&192)===128&&(Te&192)===128&&(Be&192)===128&&(Ce=(U&15)<<18|(Ee&63)<<12|(Te&63)<<6|Be&63,Ce>65535&&Ce<1114112&&(G=Ce))}}G===null?(G=65533,_e=1):G>65535&&(G-=65536,v.push(G>>>10&1023|55296),G=56320|G&1023),v.push(G),T+=_e}return j(v)}let K=4096;function j(a){let h=a.length;if(h<=K)return String.fromCharCode.apply(String,a);let g="",v=0;for(;v<h;)g+=String.fromCharCode.apply(String,a.slice(v,v+=K));return g}function te(a,h,g){let v="";g=Math.min(a.length,g);for(let T=h;T<g;++T)v+=String.fromCharCode(a[T]&127);return v}function ae(a,h,g){let v="";g=Math.min(a.length,g);for(let T=h;T<g;++T)v+=String.fromCharCode(a[T]);return v}function ie(a,h,g){let v=a.length;(!h||h<0)&&(h=0),(!g||g<0||g>v)&&(g=v);let T="";for(let U=h;U<g;++U)T+=ye[a[U]];return T}function ve(a,h,g){let v=a.slice(h,g),T="";for(let U=0;U<v.length-1;U+=2)T+=String.fromCharCode(v[U]+v[U+1]*256);return T}e.prototype.slice=function(a,h){let g=this.length;a=~~a,h=h===void 0?g:~~h,a<0?(a+=g,a<0&&(a=0)):a>g&&(a=g),h<0?(h+=g,h<0&&(h=0)):h>g&&(h=g),h<a&&(h=a);let v=this.subarray(a,h);return Object.setPrototypeOf(v,e.prototype),v};function z(a,h,g){if(a%1!==0||a<0)throw new RangeError("offset is not uint");if(a+h>g)throw new RangeError("Trying to access beyond buffer length")}e.prototype.readUintLE=e.prototype.readUIntLE=function(a,h,g){a=a>>>0,h=h>>>0,g||z(a,h,this.length);let v=this[a],T=1,U=0;for(;++U<h&&(T*=256);)v+=this[a+U]*T;return v},e.prototype.readUintBE=e.prototype.readUIntBE=function(a,h,g){a=a>>>0,h=h>>>0,g||z(a,h,this.length);let v=this[a+--h],T=1;for(;h>0&&(T*=256);)v+=this[a+--h]*T;return v},e.prototype.readUint8=e.prototype.readUInt8=function(a,h){return a=a>>>0,h||z(a,1,this.length),this[a]},e.prototype.readUint16LE=e.prototype.readUInt16LE=function(a,h){return a=a>>>0,h||z(a,2,this.length),this[a]|this[a+1]<<8},e.prototype.readUint16BE=e.prototype.readUInt16BE=function(a,h){return a=a>>>0,h||z(a,2,this.length),this[a]<<8|this[a+1]},e.prototype.readUint32LE=e.prototype.readUInt32LE=function(a,h){return a=a>>>0,h||z(a,4,this.length),(this[a]|this[a+1]<<8|this[a+2]<<16)+this[a+3]*16777216},e.prototype.readUint32BE=e.prototype.readUInt32BE=function(a,h){return a=a>>>0,h||z(a,4,this.length),this[a]*16777216+(this[a+1]<<16|this[a+2]<<8|this[a+3])},e.prototype.readBigUInt64LE=ee(function(a){a=a>>>0,V(a,"offset");let h=this[a],g=this[a+7];(h===void 0||g===void 0)&&he(a,this.length-8);let v=h+this[++a]*2**8+this[++a]*2**16+this[++a]*2**24,T=this[++a]+this[++a]*2**8+this[++a]*2**16+g*2**24;return BigInt(v)+(BigInt(T)<<BigInt(32))}),e.prototype.readBigUInt64BE=ee(function(a){a=a>>>0,V(a,"offset");let h=this[a],g=this[a+7];(h===void 0||g===void 0)&&he(a,this.length-8);let v=h*2**24+this[++a]*2**16+this[++a]*2**8+this[++a],T=this[++a]*2**24+this[++a]*2**16+this[++a]*2**8+g;return(BigInt(v)<<BigInt(32))+BigInt(T)}),e.prototype.readIntLE=function(a,h,g){a=a>>>0,h=h>>>0,g||z(a,h,this.length);let v=this[a],T=1,U=0;for(;++U<h&&(T*=256);)v+=this[a+U]*T;return T*=128,v>=T&&(v-=Math.pow(2,8*h)),v},e.prototype.readIntBE=function(a,h,g){a=a>>>0,h=h>>>0,g||z(a,h,this.length);let v=h,T=1,U=this[a+--v];for(;v>0&&(T*=256);)U+=this[a+--v]*T;return T*=128,U>=T&&(U-=Math.pow(2,8*h)),U},e.prototype.readInt8=function(a,h){return a=a>>>0,h||z(a,1,this.length),this[a]&128?(255-this[a]+1)*-1:this[a]},e.prototype.readInt16LE=function(a,h){a=a>>>0,h||z(a,2,this.length);let g=this[a]|this[a+1]<<8;return g&32768?g|4294901760:g},e.prototype.readInt16BE=function(a,h){a=a>>>0,h||z(a,2,this.length);let g=this[a+1]|this[a]<<8;return g&32768?g|4294901760:g},e.prototype.readInt32LE=function(a,h){return a=a>>>0,h||z(a,4,this.length),this[a]|this[a+1]<<8|this[a+2]<<16|this[a+3]<<24},e.prototype.readInt32BE=function(a,h){return a=a>>>0,h||z(a,4,this.length),this[a]<<24|this[a+1]<<16|this[a+2]<<8|this[a+3]},e.prototype.readBigInt64LE=ee(function(a){a=a>>>0,V(a,"offset");let h=this[a],g=this[a+7];(h===void 0||g===void 0)&&he(a,this.length-8);let v=this[a+4]+this[a+5]*2**8+this[a+6]*2**16+(g<<24);return(BigInt(v)<<BigInt(32))+BigInt(h+this[++a]*2**8+this[++a]*2**16+this[++a]*2**24)}),e.prototype.readBigInt64BE=ee(function(a){a=a>>>0,V(a,"offset");let h=this[a],g=this[a+7];(h===void 0||g===void 0)&&he(a,this.length-8);let v=(h<<24)+this[++a]*2**16+this[++a]*2**8+this[++a];return(BigInt(v)<<BigInt(32))+BigInt(this[++a]*2**24+this[++a]*2**16+this[++a]*2**8+g)}),e.prototype.readFloatLE=function(a,h){return a=a>>>0,h||z(a,4,this.length),f.read(this,a,!0,23,4)},e.prototype.readFloatBE=function(a,h){return a=a>>>0,h||z(a,4,this.length),f.read(this,a,!1,23,4)},e.prototype.readDoubleLE=function(a,h){return a=a>>>0,h||z(a,8,this.length),f.read(this,a,!0,52,8)},e.prototype.readDoubleBE=function(a,h){return a=a>>>0,h||z(a,8,this.length),f.read(this,a,!1,52,8)};function ge(a,h,g,v,T,U){if(!e.isBuffer(a))throw new TypeError('"buffer" argument must be a Buffer instance');if(h>T||h<U)throw new RangeError('"value" argument is out of bounds');if(g+v>a.length)throw new RangeError("Index out of range")}e.prototype.writeUintLE=e.prototype.writeUIntLE=function(a,h,g,v){if(a=+a,h=h>>>0,g=g>>>0,!v){let G=Math.pow(2,8*g)-1;ge(this,a,h,g,G,0)}let T=1,U=0;for(this[h]=a&255;++U<g&&(T*=256);)this[h+U]=a/T&255;return h+g},e.prototype.writeUintBE=e.prototype.writeUIntBE=function(a,h,g,v){if(a=+a,h=h>>>0,g=g>>>0,!v){let G=Math.pow(2,8*g)-1;ge(this,a,h,g,G,0)}let T=g-1,U=1;for(this[h+T]=a&255;--T>=0&&(U*=256);)this[h+T]=a/U&255;return h+g},e.prototype.writeUint8=e.prototype.writeUInt8=function(a,h,g){return a=+a,h=h>>>0,g||ge(this,a,h,1,255,0),this[h]=a&255,h+1},e.prototype.writeUint16LE=e.prototype.writeUInt16LE=function(a,h,g){return a=+a,h=h>>>0,g||ge(this,a,h,2,65535,0),this[h]=a&255,this[h+1]=a>>>8,h+2},e.prototype.writeUint16BE=e.prototype.writeUInt16BE=function(a,h,g){return a=+a,h=h>>>0,g||ge(this,a,h,2,65535,0),this[h]=a>>>8,this[h+1]=a&255,h+2},e.prototype.writeUint32LE=e.prototype.writeUInt32LE=function(a,h,g){return a=+a,h=h>>>0,g||ge(this,a,h,4,4294967295,0),this[h+3]=a>>>24,this[h+2]=a>>>16,this[h+1]=a>>>8,this[h]=a&255,h+4},e.prototype.writeUint32BE=e.prototype.writeUInt32BE=function(a,h,g){return a=+a,h=h>>>0,g||ge(this,a,h,4,4294967295,0),this[h]=a>>>24,this[h+1]=a>>>16,this[h+2]=a>>>8,this[h+3]=a&255,h+4};function R(a,h,g,v,T){H(h,v,T,a,g,7);let U=Number(h&BigInt(4294967295));a[g++]=U,U=U>>8,a[g++]=U,U=U>>8,a[g++]=U,U=U>>8,a[g++]=U;let G=Number(h>>BigInt(32)&BigInt(4294967295));return a[g++]=G,G=G>>8,a[g++]=G,G=G>>8,a[g++]=G,G=G>>8,a[g++]=G,g}function ne(a,h,g,v,T){H(h,v,T,a,g,7);let U=Number(h&BigInt(4294967295));a[g+7]=U,U=U>>8,a[g+6]=U,U=U>>8,a[g+5]=U,U=U>>8,a[g+4]=U;let G=Number(h>>BigInt(32)&BigInt(4294967295));return a[g+3]=G,G=G>>8,a[g+2]=G,G=G>>8,a[g+1]=G,G=G>>8,a[g]=G,g+8}e.prototype.writeBigUInt64LE=ee(function(a,h=0){return R(this,a,h,BigInt(0),BigInt("0xffffffffffffffff"))}),e.prototype.writeBigUInt64BE=ee(function(a,h=0){return ne(this,a,h,BigInt(0),BigInt("0xffffffffffffffff"))}),e.prototype.writeIntLE=function(a,h,g,v){if(a=+a,h=h>>>0,!v){let _e=Math.pow(2,8*g-1);ge(this,a,h,g,_e-1,-_e)}let T=0,U=1,G=0;for(this[h]=a&255;++T<g&&(U*=256);)a<0&&G===0&&this[h+T-1]!==0&&(G=1),this[h+T]=(a/U>>0)-G&255;return h+g},e.prototype.writeIntBE=function(a,h,g,v){if(a=+a,h=h>>>0,!v){let _e=Math.pow(2,8*g-1);ge(this,a,h,g,_e-1,-_e)}let T=g-1,U=1,G=0;for(this[h+T]=a&255;--T>=0&&(U*=256);)a<0&&G===0&&this[h+T+1]!==0&&(G=1),this[h+T]=(a/U>>0)-G&255;return h+g},e.prototype.writeInt8=function(a,h,g){return a=+a,h=h>>>0,g||ge(this,a,h,1,127,-128),a<0&&(a=255+a+1),this[h]=a&255,h+1},e.prototype.writeInt16LE=function(a,h,g){return a=+a,h=h>>>0,g||ge(this,a,h,2,32767,-32768),this[h]=a&255,this[h+1]=a>>>8,h+2},e.prototype.writeInt16BE=function(a,h,g){return a=+a,h=h>>>0,g||ge(this,a,h,2,32767,-32768),this[h]=a>>>8,this[h+1]=a&255,h+2},e.prototype.writeInt32LE=function(a,h,g){return a=+a,h=h>>>0,g||ge(this,a,h,4,2147483647,-2147483648),this[h]=a&255,this[h+1]=a>>>8,this[h+2]=a>>>16,this[h+3]=a>>>24,h+4},e.prototype.writeInt32BE=function(a,h,g){return a=+a,h=h>>>0,g||ge(this,a,h,4,2147483647,-2147483648),a<0&&(a=4294967295+a+1),this[h]=a>>>24,this[h+1]=a>>>16,this[h+2]=a>>>8,this[h+3]=a&255,h+4},e.prototype.writeBigInt64LE=ee(function(a,h=0){return R(this,a,h,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),e.prototype.writeBigInt64BE=ee(function(a,h=0){return ne(this,a,h,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});function be(a,h,g,v,T,U){if(g+v>a.length)throw new RangeError("Index out of range");if(g<0)throw new RangeError("Index out of range")}function D(a,h,g,v,T){return h=+h,g=g>>>0,T||be(a,h,g,4),f.write(a,h,g,v,23,4),g+4}e.prototype.writeFloatLE=function(a,h,g){return D(this,a,h,!0,g)},e.prototype.writeFloatBE=function(a,h,g){return D(this,a,h,!1,g)};function Ae(a,h,g,v,T){return h=+h,g=g>>>0,T||be(a,h,g,8),f.write(a,h,g,v,52,8),g+8}e.prototype.writeDoubleLE=function(a,h,g){return Ae(this,a,h,!0,g)},e.prototype.writeDoubleBE=function(a,h,g){return Ae(this,a,h,!1,g)},e.prototype.copy=function(a,h,g,v){if(!e.isBuffer(a))throw new TypeError("argument should be a Buffer");if(g||(g=0),!v&&v!==0&&(v=this.length),h>=a.length&&(h=a.length),h||(h=0),v>0&&v<g&&(v=g),v===g||a.length===0||this.length===0)return 0;if(h<0)throw new RangeError("targetStart out of bounds");if(g<0||g>=this.length)throw new RangeError("Index out of range");if(v<0)throw new RangeError("sourceEnd out of bounds");v>this.length&&(v=this.length),a.length-h<v-g&&(v=a.length-h+g);let T=v-g;return this===a&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin(h,g,v):Uint8Array.prototype.set.call(a,this.subarray(g,v),h),T},e.prototype.fill=function(a,h,g,v){if(typeof a=="string"){if(typeof h=="string"?(v=h,h=0,g=this.length):typeof g=="string"&&(v=g,g=this.length),v!==void 0&&typeof v!="string")throw new TypeError("encoding must be a string");if(typeof v=="string"&&!e.isEncoding(v))throw new TypeError("Unknown encoding: "+v);if(a.length===1){let U=a.charCodeAt(0);(v==="utf8"&&U<128||v==="latin1")&&(a=U)}}else typeof a=="number"?a=a&255:typeof a=="boolean"&&(a=Number(a));if(h<0||this.length<h||this.length<g)throw new RangeError("Out of range index");if(g<=h)return this;h=h>>>0,g=g===void 0?this.length:g>>>0,a||(a=0);let T;if(typeof a=="number")for(T=h;T<g;++T)this[T]=a;else{let U=e.isBuffer(a)?a:e.from(a,v),G=U.length;if(G===0)throw new TypeError('The value "'+a+'" is invalid for argument "value"');for(T=0;T<g-h;++T)this[T+h]=U[T%G]}return this};let Q={};function L(a,h,g){Q[a]=class extends g{constructor(){super(),Object.defineProperty(this,"message",{value:h.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${a}]`,this.stack,delete this.name}get code(){return a}set code(v){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:v,writable:!0})}toString(){return`${this.name} [${a}]: ${this.message}`}}}L("ERR_BUFFER_OUT_OF_BOUNDS",function(a){return a?`${a} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError),L("ERR_INVALID_ARG_TYPE",function(a,h){return`The "${a}" argument must be of type number. Received type ${typeof h}`},TypeError),L("ERR_OUT_OF_RANGE",function(a,h,g){let v=`The value of "${a}" is out of range.`,T=g;return Number.isInteger(g)&&Math.abs(g)>2**32?T=Z(String(g)):typeof g=="bigint"&&(T=String(g),(g>BigInt(2)**BigInt(32)||g<-(BigInt(2)**BigInt(32)))&&(T=Z(T)),T+="n"),v+=` It must be ${h}. Received ${T}`,v},RangeError);function Z(a){let h="",g=a.length,v=a[0]==="-"?1:0;for(;g>=v+4;g-=3)h=`_${a.slice(g-3,g)}${h}`;return`${a.slice(0,g)}${h}`}function $(a,h,g){V(h,"offset"),(a[h]===void 0||a[h+g]===void 0)&&he(h,a.length-(g+1))}function H(a,h,g,v,T,U){if(a>g||a<h){let G=typeof h=="bigint"?"n":"",_e;throw h===0||h===BigInt(0)?_e=`>= 0${G} and < 2${G} ** ${(U+1)*8}${G}`:_e=`>= -(2${G} ** ${(U+1)*8-1}${G}) and < 2 ** ${(U+1)*8-1}${G}`,new Q.ERR_OUT_OF_RANGE("value",_e,a)}$(v,T,U)}function V(a,h){if(typeof a!="number")throw new Q.ERR_INVALID_ARG_TYPE(h,"number",a)}function he(a,h,g){throw Math.floor(a)!==a?(V(a,g),new Q.ERR_OUT_OF_RANGE("offset","an integer",a)):h<0?new Q.ERR_BUFFER_OUT_OF_BOUNDS:new Q.ERR_OUT_OF_RANGE("offset",`>= 0 and <= ${h}`,a)}let oe=/[^+/0-9A-Za-z-_]/g;function x(a){if(a=a.split("=")[0],a=a.trim().replace(oe,""),a.length<2)return"";for(;a.length%4!==0;)a=a+"=";return a}function F(a,h){h=h||1/0;let g,v=a.length,T=null,U=[];for(let G=0;G<v;++G){if(g=a.charCodeAt(G),g>55295&&g<57344){if(!T){if(g>56319){(h-=3)>-1&&U.push(239,191,189);continue}else if(G+1===v){(h-=3)>-1&&U.push(239,191,189);continue}T=g;continue}if(g<56320){(h-=3)>-1&&U.push(239,191,189),T=g;continue}g=(T-55296<<10|g-56320)+65536}else T&&(h-=3)>-1&&U.push(239,191,189);if(T=null,g<128){if((h-=1)<0)break;U.push(g)}else if(g<2048){if((h-=2)<0)break;U.push(g>>6|192,g&63|128)}else if(g<65536){if((h-=3)<0)break;U.push(g>>12|224,g>>6&63|128,g&63|128)}else if(g<1114112){if((h-=4)<0)break;U.push(g>>18|240,g>>12&63|128,g>>6&63|128,g&63|128)}else throw new Error("Invalid code point")}return U}function Y(a){let h=[];for(let g=0;g<a.length;++g)h.push(a.charCodeAt(g)&255);return h}function se(a,h){let g,v,T,U=[];for(let G=0;G<a.length&&!((h-=2)<0);++G)g=a.charCodeAt(G),v=g>>8,T=g%256,U.push(T),U.push(v);return U}function re(a){return s.toByteArray(x(a))}function ce(a,h,g,v){let T;for(T=0;T<v&&!(T+g>=h.length||T>=a.length);++T)h[T+g]=a[T];return T}function W(a,h){return a instanceof h||a!=null&&a.constructor!=null&&a.constructor.name!=null&&a.constructor.name===h.name}function le(a){return a!==a}let ye=function(){let a="0123456789abcdef",h=new Array(256);for(let g=0;g<16;++g){let v=g*16;for(let T=0;T<16;++T)h[v+T]=a[g]+a[T]}return h}();function ee(a){return typeof BigInt>"u"?Pe:a}function Pe(){throw new Error("BigInt not supported")}return Rt}var tr,hn,ur,cn,Rt,fn,vt,Br,Bo,xo,Je=it(()=>{fe(),pe(),de(),tr={},hn=!1,ur={},cn=!1,Rt={},fn=!1,vt=Ca(),vt.Buffer,vt.SlowBuffer,vt.INSPECT_MAX_BYTES,vt.kMaxLength,Br=vt.Buffer,Bo=vt.INSPECT_MAX_BYTES,xo=vt.kMaxLength}),pe=it(()=>{Je()}),Ra=me(s=>{fe(),pe(),de(),Object.defineProperty(s,"__esModule",{value:!0});var f=class{constructor(o){this.aliasToTopic={},this.max=o}put(o,u){return u===0||u>this.max?!1:(this.aliasToTopic[u]=o,this.length=Object.keys(this.aliasToTopic).length,!0)}getTopicByAlias(o){return this.aliasToTopic[o]}clear(){this.aliasToTopic={}}};s.default=f}),ze=me((s,f)=>{fe(),pe(),de();var o=class extends Error{constructor(u){if(!Array.isArray(u))throw new TypeError(`Expected input to be an Array, got ${typeof u}`);let c="";for(let i=0;i<u.length;i++)c+=`    ${u[i].stack}
`;super(c),this.name="AggregateError",this.errors=u}};f.exports={AggregateError:o,ArrayIsArray(u){return Array.isArray(u)},ArrayPrototypeIncludes(u,c){return u.includes(c)},ArrayPrototypeIndexOf(u,c){return u.indexOf(c)},ArrayPrototypeJoin(u,c){return u.join(c)},ArrayPrototypeMap(u,c){return u.map(c)},ArrayPrototypePop(u,c){return u.pop(c)},ArrayPrototypePush(u,c){return u.push(c)},ArrayPrototypeSlice(u,c,i){return u.slice(c,i)},Error,FunctionPrototypeCall(u,c,...i){return u.call(c,...i)},FunctionPrototypeSymbolHasInstance(u,c){return Function.prototype[Symbol.hasInstance].call(u,c)},MathFloor:Math.floor,Number,NumberIsInteger:Number.isInteger,NumberIsNaN:Number.isNaN,NumberMAX_SAFE_INTEGER:Number.MAX_SAFE_INTEGER,NumberMIN_SAFE_INTEGER:Number.MIN_SAFE_INTEGER,NumberParseInt:Number.parseInt,ObjectDefineProperties(u,c){return Object.defineProperties(u,c)},ObjectDefineProperty(u,c,i){return Object.defineProperty(u,c,i)},ObjectGetOwnPropertyDescriptor(u,c){return Object.getOwnPropertyDescriptor(u,c)},ObjectKeys(u){return Object.keys(u)},ObjectSetPrototypeOf(u,c){return Object.setPrototypeOf(u,c)},Promise,PromisePrototypeCatch(u,c){return u.catch(c)},PromisePrototypeThen(u,c,i){return u.then(c,i)},PromiseReject(u){return Promise.reject(u)},PromiseResolve(u){return Promise.resolve(u)},ReflectApply:Reflect.apply,RegExpPrototypeTest(u,c){return u.test(c)},SafeSet:Set,String,StringPrototypeSlice(u,c,i){return u.slice(c,i)},StringPrototypeToLowerCase(u){return u.toLowerCase()},StringPrototypeToUpperCase(u){return u.toUpperCase()},StringPrototypeTrim(u){return u.trim()},Symbol,SymbolFor:Symbol.for,SymbolAsyncIterator:Symbol.asyncIterator,SymbolHasInstance:Symbol.hasInstance,SymbolIterator:Symbol.iterator,SymbolDispose:Symbol.dispose||Symbol("Symbol.dispose"),SymbolAsyncDispose:Symbol.asyncDispose||Symbol("Symbol.asyncDispose"),TypedArrayPrototypeSet(u,c,i){return u.set(c,i)},Boolean,Uint8Array}}),Mo=me((s,f)=>{fe(),pe(),de(),f.exports={format(o,...u){return o.replace(/%([sdifj])/g,function(...[c,i]){let e=u.shift();return i==="f"?e.toFixed(6):i==="j"?JSON.stringify(e):i==="s"&&typeof e=="object"?`${e.constructor!==Object?e.constructor.name:""} {}`.trim():e.toString()})},inspect(o){switch(typeof o){case"string":if(o.includes("'"))if(o.includes('"')){if(!o.includes("`")&&!o.includes("${"))return`\`${o}\``}else return`"${o}"`;return`'${o}'`;case"number":return isNaN(o)?"NaN":Object.is(o,-0)?String(o):o;case"bigint":return`${String(o)}n`;case"boolean":case"undefined":return String(o);case"object":return"{}"}}}}),nt=me((s,f)=>{fe(),pe(),de();var{format:o,inspect:u}=Mo(),{AggregateError:c}=ze(),i=globalThis.AggregateError||c,e=Symbol("kIsNodeError"),r=["string","function","number","object","Function","Object","boolean","bigint","symbol"],t=/^([A-Z][a-z0-9]*)+$/,n="__node_internal_",l={};function d(y,_){if(!y)throw new l.ERR_INTERNAL_ASSERTION(_)}function p(y){let _="",N=y.length,B=y[0]==="-"?1:0;for(;N>=B+4;N-=3)_=`_${y.slice(N-3,N)}${_}`;return`${y.slice(0,N)}${_}`}function b(y,_,N){if(typeof _=="function")return d(_.length<=N.length,`Code: ${y}; The provided arguments length (${N.length}) does not match the required ones (${_.length}).`),_(...N);let B=(_.match(/%[dfijoOs]/g)||[]).length;return d(B===N.length,`Code: ${y}; The provided arguments length (${N.length}) does not match the required ones (${B}).`),N.length===0?_:o(_,...N)}function m(y,_,N){N||(N=Error);class B extends N{constructor(...k){super(b(y,_,k))}toString(){return`${this.name} [${y}]: ${this.message}`}}Object.defineProperties(B.prototype,{name:{value:N.name,writable:!0,enumerable:!1,configurable:!0},toString:{value(){return`${this.name} [${y}]: ${this.message}`},writable:!0,enumerable:!1,configurable:!0}}),B.prototype.code=y,B.prototype[e]=!0,l[y]=B}function w(y){let _=n+y.name;return Object.defineProperty(y,"name",{value:_}),y}function E(y,_){if(y&&_&&y!==_){if(Array.isArray(_.errors))return _.errors.push(y),_;let N=new i([_,y],_.message);return N.code=_.code,N}return y||_}var I=class extends Error{constructor(y="The operation was aborted",_=void 0){if(_!==void 0&&typeof _!="object")throw new l.ERR_INVALID_ARG_TYPE("options","Object",_);super(y,_),this.code="ABORT_ERR",this.name="AbortError"}};m("ERR_ASSERTION","%s",Error),m("ERR_INVALID_ARG_TYPE",(y,_,N)=>{d(typeof y=="string","'name' must be a string"),Array.isArray(_)||(_=[_]);let B="The ";y.endsWith(" argument")?B+=`${y} `:B+=`"${y}" ${y.includes(".")?"property":"argument"} `,B+="must be ";let A=[],k=[],M=[];for(let X of _)d(typeof X=="string","All expected entries have to be of type string"),r.includes(X)?A.push(X.toLowerCase()):t.test(X)?k.push(X):(d(X!=="object",'The value "object" should be written as "Object"'),M.push(X));if(k.length>0){let X=A.indexOf("object");X!==-1&&(A.splice(A,X,1),k.push("Object"))}if(A.length>0){switch(A.length){case 1:B+=`of type ${A[0]}`;break;case 2:B+=`one of type ${A[0]} or ${A[1]}`;break;default:{let X=A.pop();B+=`one of type ${A.join(", ")}, or ${X}`}}(k.length>0||M.length>0)&&(B+=" or ")}if(k.length>0){switch(k.length){case 1:B+=`an instance of ${k[0]}`;break;case 2:B+=`an instance of ${k[0]} or ${k[1]}`;break;default:{let X=k.pop();B+=`an instance of ${k.join(", ")}, or ${X}`}}M.length>0&&(B+=" or ")}switch(M.length){case 0:break;case 1:M[0].toLowerCase()!==M[0]&&(B+="an "),B+=`${M[0]}`;break;case 2:B+=`one of ${M[0]} or ${M[1]}`;break;default:{let X=M.pop();B+=`one of ${M.join(", ")}, or ${X}`}}if(N==null)B+=`. Received ${N}`;else if(typeof N=="function"&&N.name)B+=`. Received function ${N.name}`;else if(typeof N=="object"){var J;if((J=N.constructor)!==null&&J!==void 0&&J.name)B+=`. Received an instance of ${N.constructor.name}`;else{let X=u(N,{depth:-1});B+=`. Received ${X}`}}else{let X=u(N,{colors:!1});X.length>25&&(X=`${X.slice(0,25)}...`),B+=`. Received type ${typeof N} (${X})`}return B},TypeError),m("ERR_INVALID_ARG_VALUE",(y,_,N="is invalid")=>{let B=u(_);return B.length>128&&(B=B.slice(0,128)+"..."),`The ${y.includes(".")?"property":"argument"} '${y}' ${N}. Received ${B}`},TypeError),m("ERR_INVALID_RETURN_VALUE",(y,_,N)=>{var B;let A=N!=null&&(B=N.constructor)!==null&&B!==void 0&&B.name?`instance of ${N.constructor.name}`:`type ${typeof N}`;return`Expected ${y} to be returned from the "${_}" function but got ${A}.`},TypeError),m("ERR_MISSING_ARGS",(...y)=>{d(y.length>0,"At least one arg needs to be specified");let _,N=y.length;switch(y=(Array.isArray(y)?y:[y]).map(B=>`"${B}"`).join(" or "),N){case 1:_+=`The ${y[0]} argument`;break;case 2:_+=`The ${y[0]} and ${y[1]} arguments`;break;default:{let B=y.pop();_+=`The ${y.join(", ")}, and ${B} arguments`}break}return`${_} must be specified`},TypeError),m("ERR_OUT_OF_RANGE",(y,_,N)=>{d(_,'Missing "range" argument');let B;if(Number.isInteger(N)&&Math.abs(N)>2**32)B=p(String(N));else if(typeof N=="bigint"){B=String(N);let A=BigInt(2)**BigInt(32);(N>A||N<-A)&&(B=p(B)),B+="n"}else B=u(N);return`The value of "${y}" is out of range. It must be ${_}. Received ${B}`},RangeError),m("ERR_MULTIPLE_CALLBACK","Callback called multiple times",Error),m("ERR_METHOD_NOT_IMPLEMENTED","The %s method is not implemented",Error),m("ERR_STREAM_ALREADY_FINISHED","Cannot call %s after a stream was finished",Error),m("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable",Error),m("ERR_STREAM_DESTROYED","Cannot call %s after a stream was destroyed",Error),m("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError),m("ERR_STREAM_PREMATURE_CLOSE","Premature close",Error),m("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF",Error),m("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event",Error),m("ERR_STREAM_WRITE_AFTER_END","write after end",Error),m("ERR_UNKNOWN_ENCODING","Unknown encoding: %s",TypeError),f.exports={AbortError:I,aggregateTwoErrors:w(E),hideStackFrames:w,codes:l}}),dr=me((s,f)=>{fe(),pe(),de();var{AbortController:o,AbortSignal:u}=typeof self<"u"?self:typeof window<"u"?window:void 0;f.exports=o,f.exports.AbortSignal=u,f.exports.default=o});function je(){je.init.call(this)}function kr(s){if(typeof s!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof s)}function Lo(s){return s._maxListeners===void 0?je.defaultMaxListeners:s._maxListeners}function qn(s,f,o,u){var c,i,e,r;if(kr(o),(i=s._events)===void 0?(i=s._events=Object.create(null),s._eventsCount=0):(i.newListener!==void 0&&(s.emit("newListener",f,o.listener?o.listener:o),i=s._events),e=i[f]),e===void 0)e=i[f]=o,++s._eventsCount;else if(typeof e=="function"?e=i[f]=u?[o,e]:[e,o]:u?e.unshift(o):e.push(o),(c=Lo(s))>0&&e.length>c&&!e.warned){e.warned=!0;var t=new Error("Possible EventEmitter memory leak detected. "+e.length+" "+String(f)+" listeners added. Use emitter.setMaxListeners() to increase limit");t.name="MaxListenersExceededWarning",t.emitter=s,t.type=f,t.count=e.length,r=t,console&&console.warn&&console.warn(r)}return s}function Ba(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function Hn(s,f,o){var u={fired:!1,wrapFn:void 0,target:s,type:f,listener:o},c=Ba.bind(u);return c.listener=o,u.wrapFn=c,c}function Vn(s,f,o){var u=s._events;if(u===void 0)return[];var c=u[f];return c===void 0?[]:typeof c=="function"?o?[c.listener||c]:[c]:o?function(i){for(var e=new Array(i.length),r=0;r<e.length;++r)e[r]=i[r].listener||i[r];return e}(c):Uo(c,c.length)}function zn(s){var f=this._events;if(f!==void 0){var o=f[s];if(typeof o=="function")return 1;if(o!==void 0)return o.length}return 0}function Uo(s,f){for(var o=new Array(f),u=0;u<f;++u)o[u]=s[u];return o}var Qn,Kn,Wt,Yr,Jr,Xr,lt,Gn=it(()=>{fe(),pe(),de(),Wt=typeof Reflect=="object"?Reflect:null,Yr=Wt&&typeof Wt.apply=="function"?Wt.apply:function(s,f,o){return Function.prototype.apply.call(s,f,o)},Kn=Wt&&typeof Wt.ownKeys=="function"?Wt.ownKeys:Object.getOwnPropertySymbols?function(s){return Object.getOwnPropertyNames(s).concat(Object.getOwnPropertySymbols(s))}:function(s){return Object.getOwnPropertyNames(s)},Jr=Number.isNaN||function(s){return s!=s},Qn=je,je.EventEmitter=je,je.prototype._events=void 0,je.prototype._eventsCount=0,je.prototype._maxListeners=void 0,Xr=10,Object.defineProperty(je,"defaultMaxListeners",{enumerable:!0,get:function(){return Xr},set:function(s){if(typeof s!="number"||s<0||Jr(s))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+s+".");Xr=s}}),je.init=function(){this._events!==void 0&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},je.prototype.setMaxListeners=function(s){if(typeof s!="number"||s<0||Jr(s))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+s+".");return this._maxListeners=s,this},je.prototype.getMaxListeners=function(){return Lo(this)},je.prototype.emit=function(s){for(var f=[],o=1;o<arguments.length;o++)f.push(arguments[o]);var u=s==="error",c=this._events;if(c!==void 0)u=u&&c.error===void 0;else if(!u)return!1;if(u){var i;if(f.length>0&&(i=f[0]),i instanceof Error)throw i;var e=new Error("Unhandled error."+(i?" ("+i.message+")":""));throw e.context=i,e}var r=c[s];if(r===void 0)return!1;if(typeof r=="function")Yr(r,this,f);else{var t=r.length,n=Uo(r,t);for(o=0;o<t;++o)Yr(n[o],this,f)}return!0},je.prototype.addListener=function(s,f){return qn(this,s,f,!1)},je.prototype.on=je.prototype.addListener,je.prototype.prependListener=function(s,f){return qn(this,s,f,!0)},je.prototype.once=function(s,f){return kr(f),this.on(s,Hn(this,s,f)),this},je.prototype.prependOnceListener=function(s,f){return kr(f),this.prependListener(s,Hn(this,s,f)),this},je.prototype.removeListener=function(s,f){var o,u,c,i,e;if(kr(f),(u=this._events)===void 0)return this;if((o=u[s])===void 0)return this;if(o===f||o.listener===f)--this._eventsCount==0?this._events=Object.create(null):(delete u[s],u.removeListener&&this.emit("removeListener",s,o.listener||f));else if(typeof o!="function"){for(c=-1,i=o.length-1;i>=0;i--)if(o[i]===f||o[i].listener===f){e=o[i].listener,c=i;break}if(c<0)return this;c===0?o.shift():function(r,t){for(;t+1<r.length;t++)r[t]=r[t+1];r.pop()}(o,c),o.length===1&&(u[s]=o[0]),u.removeListener!==void 0&&this.emit("removeListener",s,e||f)}return this},je.prototype.off=je.prototype.removeListener,je.prototype.removeAllListeners=function(s){var f,o,u;if((o=this._events)===void 0)return this;if(o.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):o[s]!==void 0&&(--this._eventsCount==0?this._events=Object.create(null):delete o[s]),this;if(arguments.length===0){var c,i=Object.keys(o);for(u=0;u<i.length;++u)(c=i[u])!=="removeListener"&&this.removeAllListeners(c);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(typeof(f=o[s])=="function")this.removeListener(s,f);else if(f!==void 0)for(u=f.length-1;u>=0;u--)this.removeListener(s,f[u]);return this},je.prototype.listeners=function(s){return Vn(this,s,!0)},je.prototype.rawListeners=function(s){return Vn(this,s,!1)},je.listenerCount=function(s,f){return typeof s.listenerCount=="function"?s.listenerCount(f):zn.call(s,f)},je.prototype.listenerCount=zn,je.prototype.eventNames=function(){return this._eventsCount>0?Kn(this._events):[]},lt=Qn,lt.EventEmitter,lt.defaultMaxListeners,lt.init,lt.listenerCount,lt.EventEmitter,lt.defaultMaxListeners,lt.init,lt.listenerCount}),Ut={};rr(Ut,{EventEmitter:()=>jo,default:()=>lt,defaultMaxListeners:()=>No,init:()=>Do,listenerCount:()=>Fo,on:()=>Wo,once:()=>$o});var jo,No,Do,Fo,Wo,$o,Yt=it(()=>{fe(),pe(),de(),Gn(),Gn(),lt.once=function(s,f){return new Promise((o,u)=>{function c(...e){i!==void 0&&s.removeListener("error",i),o(e)}let i;f!=="error"&&(i=e=>{s.removeListener(name,c),u(e)},s.once("error",i)),s.once(f,c)})},lt.on=function(s,f){let o=[],u=[],c=null,i=!1,e={async next(){let n=o.shift();if(n)return createIterResult(n,!1);if(c){let l=Promise.reject(c);return c=null,l}return i?createIterResult(void 0,!0):new Promise((l,d)=>u.push({resolve:l,reject:d}))},async return(){s.removeListener(f,r),s.removeListener("error",t),i=!0;for(let n of u)n.resolve(createIterResult(void 0,!0));return createIterResult(void 0,!0)},throw(n){c=n,s.removeListener(f,r),s.removeListener("error",t)},[Symbol.asyncIterator](){return this}};return s.on(f,r),s.on("error",t),e;function r(...n){let l=u.shift();l?l.resolve(createIterResult(n,!1)):o.push(n)}function t(n){i=!0;let l=u.shift();l?l.reject(n):c=n,e.return()}},{EventEmitter:jo,defaultMaxListeners:No,init:Do,listenerCount:Fo,on:Wo,once:$o}=lt}),st=me((s,f)=>{fe(),pe(),de();var o=(Je(),Ne(Ye)),{format:u,inspect:c}=Mo(),{codes:{ERR_INVALID_ARG_TYPE:i}}=nt(),{kResistStopPropagation:e,AggregateError:r,SymbolDispose:t}=ze(),n=globalThis.AbortSignal||dr().AbortSignal,l=globalThis.AbortController||dr().AbortController,d=Object.getPrototypeOf(async function(){}).constructor,p=globalThis.Blob||o.Blob,b=typeof p<"u"?function(E){return E instanceof p}:function(E){return!1},m=(E,I)=>{if(E!==void 0&&(E===null||typeof E!="object"||!("aborted"in E)))throw new i(I,"AbortSignal",E)},w=(E,I)=>{if(typeof E!="function")throw new i(I,"Function",E)};f.exports={AggregateError:r,kEmptyObject:Object.freeze({}),once(E){let I=!1;return function(...y){I||(I=!0,E.apply(this,y))}},createDeferredPromise:function(){let E,I;return{promise:new Promise((y,_)=>{E=y,I=_}),resolve:E,reject:I}},promisify(E){return new Promise((I,y)=>{E((_,...N)=>_?y(_):I(...N))})},debuglog(){return function(){}},format:u,inspect:c,types:{isAsyncFunction(E){return E instanceof d},isArrayBufferView(E){return ArrayBuffer.isView(E)}},isBlob:b,deprecate(E,I){return E},addAbortListener:(Yt(),Ne(Ut)).addAbortListener||function(E,I){if(E===void 0)throw new i("signal","AbortSignal",E);m(E,"signal"),w(I,"listener");let y;return E.aborted?queueMicrotask(()=>I()):(E.addEventListener("abort",I,{__proto__:null,once:!0,[e]:!0}),y=()=>{E.removeEventListener("abort",I)}),{__proto__:null,[t](){var _;(_=y)===null||_===void 0||_()}}},AbortSignalAny:n.any||function(E){if(E.length===1)return E[0];let I=new l,y=()=>I.abort();return E.forEach(_=>{m(_,"signals"),_.addEventListener("abort",y,{once:!0})}),I.signal.addEventListener("abort",()=>{E.forEach(_=>_.removeEventListener("abort",y))},{once:!0}),I.signal}},f.exports.promisify.custom=Symbol.for("nodejs.util.promisify.custom")}),pr=me((s,f)=>{fe(),pe(),de();var{ArrayIsArray:o,ArrayPrototypeIncludes:u,ArrayPrototypeJoin:c,ArrayPrototypeMap:i,NumberIsInteger:e,NumberIsNaN:r,NumberMAX_SAFE_INTEGER:t,NumberMIN_SAFE_INTEGER:n,NumberParseInt:l,ObjectPrototypeHasOwnProperty:d,RegExpPrototypeExec:p,String:b,StringPrototypeToUpperCase:m,StringPrototypeTrim:w}=ze(),{hideStackFrames:E,codes:{ERR_SOCKET_BAD_PORT:I,ERR_INVALID_ARG_TYPE:y,ERR_INVALID_ARG_VALUE:_,ERR_OUT_OF_RANGE:N,ERR_UNKNOWN_SIGNAL:B}}=nt(),{normalizeEncoding:A}=st(),{isAsyncFunction:k,isArrayBufferView:M}=st().types,J={};function X(W){return W===(W|0)}function ue(W){return W===W>>>0}var C=/^[0-7]+$/,q="must be a 32-bit unsigned integer or an octal string";function K(W,le,ye){if(typeof W>"u"&&(W=ye),typeof W=="string"){if(p(C,W)===null)throw new _(le,W,q);W=l(W,8)}return ae(W,le),W}var j=E((W,le,ye=n,ee=t)=>{if(typeof W!="number")throw new y(le,"number",W);if(!e(W))throw new N(le,"an integer",W);if(W<ye||W>ee)throw new N(le,`>= ${ye} && <= ${ee}`,W)}),te=E((W,le,ye=-2147483648,ee=2147483647)=>{if(typeof W!="number")throw new y(le,"number",W);if(!e(W))throw new N(le,"an integer",W);if(W<ye||W>ee)throw new N(le,`>= ${ye} && <= ${ee}`,W)}),ae=E((W,le,ye=!1)=>{if(typeof W!="number")throw new y(le,"number",W);if(!e(W))throw new N(le,"an integer",W);let ee=ye?1:0,Pe=4294967295;if(W<ee||W>Pe)throw new N(le,`>= ${ee} && <= ${Pe}`,W)});function ie(W,le){if(typeof W!="string")throw new y(le,"string",W)}function ve(W,le,ye=void 0,ee){if(typeof W!="number")throw new y(le,"number",W);if(ye!=null&&W<ye||ee!=null&&W>ee||(ye!=null||ee!=null)&&r(W))throw new N(le,`${ye!=null?`>= ${ye}`:""}${ye!=null&&ee!=null?" && ":""}${ee!=null?`<= ${ee}`:""}`,W)}var z=E((W,le,ye)=>{if(!u(ye,W)){let ee="must be one of: "+c(i(ye,Pe=>typeof Pe=="string"?`'${Pe}'`:b(Pe)),", ");throw new _(le,W,ee)}});function ge(W,le){if(typeof W!="boolean")throw new y(le,"boolean",W)}function R(W,le,ye){return W==null||!d(W,le)?ye:W[le]}var ne=E((W,le,ye=null)=>{let ee=R(ye,"allowArray",!1),Pe=R(ye,"allowFunction",!1);if(!R(ye,"nullable",!1)&&W===null||!ee&&o(W)||typeof W!="object"&&(!Pe||typeof W!="function"))throw new y(le,"Object",W)}),be=E((W,le)=>{if(W!=null&&typeof W!="object"&&typeof W!="function")throw new y(le,"a dictionary",W)}),D=E((W,le,ye=0)=>{if(!o(W))throw new y(le,"Array",W);if(W.length<ye){let ee=`must be longer than ${ye}`;throw new _(le,W,ee)}});function Ae(W,le){D(W,le);for(let ye=0;ye<W.length;ye++)ie(W[ye],`${le}[${ye}]`)}function Q(W,le){D(W,le);for(let ye=0;ye<W.length;ye++)ge(W[ye],`${le}[${ye}]`)}function L(W,le){D(W,le);for(let ye=0;ye<W.length;ye++){let ee=W[ye],Pe=`${le}[${ye}]`;if(ee==null)throw new y(Pe,"AbortSignal",ee);he(ee,Pe)}}function Z(W,le="signal"){if(ie(W,le),J[W]===void 0)throw J[m(W)]!==void 0?new B(W+" (signals must use all capital letters)"):new B(W)}var $=E((W,le="buffer")=>{if(!M(W))throw new y(le,["Buffer","TypedArray","DataView"],W)});function H(W,le){let ye=A(le),ee=W.length;if(ye==="hex"&&ee%2!==0)throw new _("encoding",le,`is invalid for data of length ${ee}`)}function V(W,le="Port",ye=!0){if(typeof W!="number"&&typeof W!="string"||typeof W=="string"&&w(W).length===0||+W!==+W>>>0||W>65535||W===0&&!ye)throw new I(le,W,ye);return W|0}var he=E((W,le)=>{if(W!==void 0&&(W===null||typeof W!="object"||!("aborted"in W)))throw new y(le,"AbortSignal",W)}),oe=E((W,le)=>{if(typeof W!="function")throw new y(le,"Function",W)}),x=E((W,le)=>{if(typeof W!="function"||k(W))throw new y(le,"Function",W)}),F=E((W,le)=>{if(W!==void 0)throw new y(le,"undefined",W)});function Y(W,le,ye){if(!u(ye,W))throw new y(le,`('${c(ye,"|")}')`,W)}var se=/^(?:<[^>]*>)(?:\s*;\s*[^;"\s]+(?:=(")?[^;"\s]*\1)?)*$/;function re(W,le){if(typeof W>"u"||!p(se,W))throw new _(le,W,'must be an array or string of format "</styles.css>; rel=preload; as=style"')}function ce(W){if(typeof W=="string")return re(W,"hints"),W;if(o(W)){let le=W.length,ye="";if(le===0)return ye;for(let ee=0;ee<le;ee++){let Pe=W[ee];re(Pe,"hints"),ye+=Pe,ee!==le-1&&(ye+=", ")}return ye}throw new _("hints",W,'must be an array or string of format "</styles.css>; rel=preload; as=style"')}f.exports={isInt32:X,isUint32:ue,parseFileMode:K,validateArray:D,validateStringArray:Ae,validateBooleanArray:Q,validateAbortSignalArray:L,validateBoolean:ge,validateBuffer:$,validateDictionary:be,validateEncoding:H,validateFunction:oe,validateInt32:te,validateInteger:j,validateNumber:ve,validateObject:ne,validateOneOf:z,validatePlainFunction:x,validatePort:V,validateSignalName:Z,validateString:ie,validateUint32:ae,validateUndefined:F,validateUnion:Y,validateAbortSignal:he,validateLinkHeaderValue:ce}}),Jt=me((s,f)=>{fe(),pe(),de();var o=f.exports={},u,c;function i(){throw new Error("setTimeout has not been defined")}function e(){throw new Error("clearTimeout has not been defined")}(function(){try{typeof setTimeout=="function"?u=setTimeout:u=i}catch{u=i}try{typeof clearTimeout=="function"?c=clearTimeout:c=e}catch{c=e}})();function r(I){if(u===setTimeout)return setTimeout(I,0);if((u===i||!u)&&setTimeout)return u=setTimeout,setTimeout(I,0);try{return u(I,0)}catch{try{return u.call(null,I,0)}catch{return u.call(this,I,0)}}}function t(I){if(c===clearTimeout)return clearTimeout(I);if((c===e||!c)&&clearTimeout)return c=clearTimeout,clearTimeout(I);try{return c(I)}catch{try{return c.call(null,I)}catch{return c.call(this,I)}}}var n=[],l=!1,d,p=-1;function b(){!l||!d||(l=!1,d.length?n=d.concat(n):p=-1,n.length&&m())}function m(){if(!l){var I=r(b);l=!0;for(var y=n.length;y;){for(d=n,n=[];++p<y;)d&&d[p].run();p=-1,y=n.length}d=null,l=!1,t(I)}}o.nextTick=function(I){var y=new Array(arguments.length-1);if(arguments.length>1)for(var _=1;_<arguments.length;_++)y[_-1]=arguments[_];n.push(new w(I,y)),n.length===1&&!l&&r(m)};function w(I,y){this.fun=I,this.array=y}w.prototype.run=function(){this.fun.apply(null,this.array)},o.title="browser",o.browser=!0,o.env={},o.argv=[],o.version="",o.versions={};function E(){}o.on=E,o.addListener=E,o.once=E,o.off=E,o.removeListener=E,o.removeAllListeners=E,o.emit=E,o.prependListener=E,o.prependOnceListener=E,o.listeners=function(I){return[]},o.binding=function(I){throw new Error("process.binding is not supported")},o.cwd=function(){return"/"},o.chdir=function(I){throw new Error("process.chdir is not supported")},o.umask=function(){return 0}}),Tt=me((s,f)=>{fe(),pe(),de();var{SymbolAsyncIterator:o,SymbolIterator:u,SymbolFor:c}=ze(),i=c("nodejs.stream.destroyed"),e=c("nodejs.stream.errored"),r=c("nodejs.stream.readable"),t=c("nodejs.stream.writable"),n=c("nodejs.stream.disturbed"),l=c("nodejs.webstream.isClosedPromise"),d=c("nodejs.webstream.controllerErrorFunction");function p(R,ne=!1){var be;return!!(R&&typeof R.pipe=="function"&&typeof R.on=="function"&&(!ne||typeof R.pause=="function"&&typeof R.resume=="function")&&(!R._writableState||((be=R._readableState)===null||be===void 0?void 0:be.readable)!==!1)&&(!R._writableState||R._readableState))}function b(R){var ne;return!!(R&&typeof R.write=="function"&&typeof R.on=="function"&&(!R._readableState||((ne=R._writableState)===null||ne===void 0?void 0:ne.writable)!==!1))}function m(R){return!!(R&&typeof R.pipe=="function"&&R._readableState&&typeof R.on=="function"&&typeof R.write=="function")}function w(R){return R&&(R._readableState||R._writableState||typeof R.write=="function"&&typeof R.on=="function"||typeof R.pipe=="function"&&typeof R.on=="function")}function E(R){return!!(R&&!w(R)&&typeof R.pipeThrough=="function"&&typeof R.getReader=="function"&&typeof R.cancel=="function")}function I(R){return!!(R&&!w(R)&&typeof R.getWriter=="function"&&typeof R.abort=="function")}function y(R){return!!(R&&!w(R)&&typeof R.readable=="object"&&typeof R.writable=="object")}function _(R){return E(R)||I(R)||y(R)}function N(R,ne){return R==null?!1:ne===!0?typeof R[o]=="function":ne===!1?typeof R[u]=="function":typeof R[o]=="function"||typeof R[u]=="function"}function B(R){if(!w(R))return null;let ne=R._writableState,be=R._readableState,D=ne||be;return!!(R.destroyed||R[i]||D!=null&&D.destroyed)}function A(R){if(!b(R))return null;if(R.writableEnded===!0)return!0;let ne=R._writableState;return ne!=null&&ne.errored?!1:typeof(ne==null?void 0:ne.ended)!="boolean"?null:ne.ended}function k(R,ne){if(!b(R))return null;if(R.writableFinished===!0)return!0;let be=R._writableState;return be!=null&&be.errored?!1:typeof(be==null?void 0:be.finished)!="boolean"?null:!!(be.finished||ne===!1&&be.ended===!0&&be.length===0)}function M(R){if(!p(R))return null;if(R.readableEnded===!0)return!0;let ne=R._readableState;return!ne||ne.errored?!1:typeof(ne==null?void 0:ne.ended)!="boolean"?null:ne.ended}function J(R,ne){if(!p(R))return null;let be=R._readableState;return be!=null&&be.errored?!1:typeof(be==null?void 0:be.endEmitted)!="boolean"?null:!!(be.endEmitted||ne===!1&&be.ended===!0&&be.length===0)}function X(R){return R&&R[r]!=null?R[r]:typeof(R==null?void 0:R.readable)!="boolean"?null:B(R)?!1:p(R)&&R.readable&&!J(R)}function ue(R){return R&&R[t]!=null?R[t]:typeof(R==null?void 0:R.writable)!="boolean"?null:B(R)?!1:b(R)&&R.writable&&!A(R)}function C(R,ne){return w(R)?B(R)?!0:!((ne==null?void 0:ne.readable)!==!1&&X(R)||(ne==null?void 0:ne.writable)!==!1&&ue(R)):null}function q(R){var ne,be;return w(R)?R.writableErrored?R.writableErrored:(ne=(be=R._writableState)===null||be===void 0?void 0:be.errored)!==null&&ne!==void 0?ne:null:null}function K(R){var ne,be;return w(R)?R.readableErrored?R.readableErrored:(ne=(be=R._readableState)===null||be===void 0?void 0:be.errored)!==null&&ne!==void 0?ne:null:null}function j(R){if(!w(R))return null;if(typeof R.closed=="boolean")return R.closed;let ne=R._writableState,be=R._readableState;return typeof(ne==null?void 0:ne.closed)=="boolean"||typeof(be==null?void 0:be.closed)=="boolean"?(ne==null?void 0:ne.closed)||(be==null?void 0:be.closed):typeof R._closed=="boolean"&&te(R)?R._closed:null}function te(R){return typeof R._closed=="boolean"&&typeof R._defaultKeepAlive=="boolean"&&typeof R._removedConnection=="boolean"&&typeof R._removedContLen=="boolean"}function ae(R){return typeof R._sent100=="boolean"&&te(R)}function ie(R){var ne;return typeof R._consuming=="boolean"&&typeof R._dumped=="boolean"&&((ne=R.req)===null||ne===void 0?void 0:ne.upgradeOrConnect)===void 0}function ve(R){if(!w(R))return null;let ne=R._writableState,be=R._readableState,D=ne||be;return!D&&ae(R)||!!(D&&D.autoDestroy&&D.emitClose&&D.closed===!1)}function z(R){var ne;return!!(R&&((ne=R[n])!==null&&ne!==void 0?ne:R.readableDidRead||R.readableAborted))}function ge(R){var ne,be,D,Ae,Q,L,Z,$,H,V;return!!(R&&((ne=(be=(D=(Ae=(Q=(L=R[e])!==null&&L!==void 0?L:R.readableErrored)!==null&&Q!==void 0?Q:R.writableErrored)!==null&&Ae!==void 0?Ae:(Z=R._readableState)===null||Z===void 0?void 0:Z.errorEmitted)!==null&&D!==void 0?D:($=R._writableState)===null||$===void 0?void 0:$.errorEmitted)!==null&&be!==void 0?be:(H=R._readableState)===null||H===void 0?void 0:H.errored)!==null&&ne!==void 0?ne:!((V=R._writableState)===null||V===void 0)&&V.errored))}f.exports={isDestroyed:B,kIsDestroyed:i,isDisturbed:z,kIsDisturbed:n,isErrored:ge,kIsErrored:e,isReadable:X,kIsReadable:r,kIsClosedPromise:l,kControllerErrorFunction:d,kIsWritable:t,isClosed:j,isDuplexNodeStream:m,isFinished:C,isIterable:N,isReadableNodeStream:p,isReadableStream:E,isReadableEnded:M,isReadableFinished:J,isReadableErrored:K,isNodeStream:w,isWebStream:_,isWritable:ue,isWritableNodeStream:b,isWritableStream:I,isWritableEnded:A,isWritableFinished:k,isWritableErrored:q,isServerRequest:ie,isServerResponse:ae,willEmitClose:ve,isTransformStream:y}}),jt=me((s,f)=>{fe(),pe(),de();var o=Jt(),{AbortError:u,codes:c}=nt(),{ERR_INVALID_ARG_TYPE:i,ERR_STREAM_PREMATURE_CLOSE:e}=c,{kEmptyObject:r,once:t}=st(),{validateAbortSignal:n,validateFunction:l,validateObject:d,validateBoolean:p}=pr(),{Promise:b,PromisePrototypeThen:m,SymbolDispose:w}=ze(),{isClosed:E,isReadable:I,isReadableNodeStream:y,isReadableStream:_,isReadableFinished:N,isReadableErrored:B,isWritable:A,isWritableNodeStream:k,isWritableStream:M,isWritableFinished:J,isWritableErrored:X,isNodeStream:ue,willEmitClose:C,kIsClosedPromise:q}=Tt(),K;function j(z){return z.setHeader&&typeof z.abort=="function"}var te=()=>{};function ae(z,ge,R){var ne,be;if(arguments.length===2?(R=ge,ge=r):ge==null?ge=r:d(ge,"options"),l(R,"callback"),n(ge.signal,"options.signal"),R=t(R),_(z)||M(z))return ie(z,ge,R);if(!ue(z))throw new i("stream",["ReadableStream","WritableStream","Stream"],z);let D=(ne=ge.readable)!==null&&ne!==void 0?ne:y(z),Ae=(be=ge.writable)!==null&&be!==void 0?be:k(z),Q=z._writableState,L=z._readableState,Z=()=>{z.writable||V()},$=C(z)&&y(z)===D&&k(z)===Ae,H=J(z,!1),V=()=>{H=!0,z.destroyed&&($=!1),!($&&(!z.readable||D))&&(!D||he)&&R.call(z)},he=N(z,!1),oe=()=>{he=!0,z.destroyed&&($=!1),!($&&(!z.writable||Ae))&&(!Ae||H)&&R.call(z)},x=W=>{R.call(z,W)},F=E(z),Y=()=>{F=!0;let W=X(z)||B(z);if(W&&typeof W!="boolean")return R.call(z,W);if(D&&!he&&y(z,!0)&&!N(z,!1))return R.call(z,new e);if(Ae&&!H&&!J(z,!1))return R.call(z,new e);R.call(z)},se=()=>{F=!0;let W=X(z)||B(z);if(W&&typeof W!="boolean")return R.call(z,W);R.call(z)},re=()=>{z.req.on("finish",V)};j(z)?(z.on("complete",V),$||z.on("abort",Y),z.req?re():z.on("request",re)):Ae&&!Q&&(z.on("end",Z),z.on("close",Z)),!$&&typeof z.aborted=="boolean"&&z.on("aborted",Y),z.on("end",oe),z.on("finish",V),ge.error!==!1&&z.on("error",x),z.on("close",Y),F?o.nextTick(Y):Q!=null&&Q.errorEmitted||L!=null&&L.errorEmitted?$||o.nextTick(se):(!D&&(!$||I(z))&&(H||A(z)===!1)||!Ae&&(!$||A(z))&&(he||I(z)===!1)||L&&z.req&&z.aborted)&&o.nextTick(se);let ce=()=>{R=te,z.removeListener("aborted",Y),z.removeListener("complete",V),z.removeListener("abort",Y),z.removeListener("request",re),z.req&&z.req.removeListener("finish",V),z.removeListener("end",Z),z.removeListener("close",Z),z.removeListener("finish",V),z.removeListener("end",oe),z.removeListener("error",x),z.removeListener("close",Y)};if(ge.signal&&!F){let W=()=>{let le=R;ce(),le.call(z,new u(void 0,{cause:ge.signal.reason}))};if(ge.signal.aborted)o.nextTick(W);else{K=K||st().addAbortListener;let le=K(ge.signal,W),ye=R;R=t((...ee)=>{le[w](),ye.apply(z,ee)})}}return ce}function ie(z,ge,R){let ne=!1,be=te;if(ge.signal)if(be=()=>{ne=!0,R.call(z,new u(void 0,{cause:ge.signal.reason}))},ge.signal.aborted)o.nextTick(be);else{K=K||st().addAbortListener;let Ae=K(ge.signal,be),Q=R;R=t((...L)=>{Ae[w](),Q.apply(z,L)})}let D=(...Ae)=>{ne||o.nextTick(()=>R.apply(z,Ae))};return m(z[q].promise,D,D),te}function ve(z,ge){var R;let ne=!1;return ge===null&&(ge=r),(R=ge)!==null&&R!==void 0&&R.cleanup&&(p(ge.cleanup,"cleanup"),ne=ge.cleanup),new b((be,D)=>{let Ae=ae(z,ge,Q=>{ne&&Ae(),Q?D(Q):be()})})}f.exports=ae,f.exports.finished=ve}),ir=me((s,f)=>{fe(),pe(),de();var o=Jt(),{aggregateTwoErrors:u,codes:{ERR_MULTIPLE_CALLBACK:c},AbortError:i}=nt(),{Symbol:e}=ze(),{kIsDestroyed:r,isDestroyed:t,isFinished:n,isServerRequest:l}=Tt(),d=e("kDestroy"),p=e("kConstruct");function b(C,q,K){C&&(C.stack,q&&!q.errored&&(q.errored=C),K&&!K.errored&&(K.errored=C))}function m(C,q){let K=this._readableState,j=this._writableState,te=j||K;return j!=null&&j.destroyed||K!=null&&K.destroyed?(typeof q=="function"&&q(),this):(b(C,j,K),j&&(j.destroyed=!0),K&&(K.destroyed=!0),te.constructed?w(this,C,q):this.once(d,function(ae){w(this,u(ae,C),q)}),this)}function w(C,q,K){let j=!1;function te(ae){if(j)return;j=!0;let ie=C._readableState,ve=C._writableState;b(ae,ve,ie),ve&&(ve.closed=!0),ie&&(ie.closed=!0),typeof K=="function"&&K(ae),ae?o.nextTick(E,C,ae):o.nextTick(I,C)}try{C._destroy(q||null,te)}catch(ae){te(ae)}}function E(C,q){y(C,q),I(C)}function I(C){let q=C._readableState,K=C._writableState;K&&(K.closeEmitted=!0),q&&(q.closeEmitted=!0),(K!=null&&K.emitClose||q!=null&&q.emitClose)&&C.emit("close")}function y(C,q){let K=C._readableState,j=C._writableState;j!=null&&j.errorEmitted||K!=null&&K.errorEmitted||(j&&(j.errorEmitted=!0),K&&(K.errorEmitted=!0),C.emit("error",q))}function _(){let C=this._readableState,q=this._writableState;C&&(C.constructed=!0,C.closed=!1,C.closeEmitted=!1,C.destroyed=!1,C.errored=null,C.errorEmitted=!1,C.reading=!1,C.ended=C.readable===!1,C.endEmitted=C.readable===!1),q&&(q.constructed=!0,q.destroyed=!1,q.closed=!1,q.closeEmitted=!1,q.errored=null,q.errorEmitted=!1,q.finalCalled=!1,q.prefinished=!1,q.ended=q.writable===!1,q.ending=q.writable===!1,q.finished=q.writable===!1)}function N(C,q,K){let j=C._readableState,te=C._writableState;if(te!=null&&te.destroyed||j!=null&&j.destroyed)return this;j!=null&&j.autoDestroy||te!=null&&te.autoDestroy?C.destroy(q):q&&(q.stack,te&&!te.errored&&(te.errored=q),j&&!j.errored&&(j.errored=q),K?o.nextTick(y,C,q):y(C,q))}function B(C,q){if(typeof C._construct!="function")return;let K=C._readableState,j=C._writableState;K&&(K.constructed=!1),j&&(j.constructed=!1),C.once(p,q),!(C.listenerCount(p)>1)&&o.nextTick(A,C)}function A(C){let q=!1;function K(j){if(q){N(C,j??new c);return}q=!0;let te=C._readableState,ae=C._writableState,ie=ae||te;te&&(te.constructed=!0),ae&&(ae.constructed=!0),ie.destroyed?C.emit(d,j):j?N(C,j,!0):o.nextTick(k,C)}try{C._construct(j=>{o.nextTick(K,j)})}catch(j){o.nextTick(K,j)}}function k(C){C.emit(p)}function M(C){return(C==null?void 0:C.setHeader)&&typeof C.abort=="function"}function J(C){C.emit("close")}function X(C,q){C.emit("error",q),o.nextTick(J,C)}function ue(C,q){!C||t(C)||(!q&&!n(C)&&(q=new i),l(C)?(C.socket=null,C.destroy(q)):M(C)?C.abort():M(C.req)?C.req.abort():typeof C.destroy=="function"?C.destroy(q):typeof C.close=="function"?C.close():q?o.nextTick(X,C,q):o.nextTick(J,C),C.destroyed||(C[r]=!0))}f.exports={construct:B,destroyer:ue,destroy:m,undestroy:_,errorOrDestroy:N}}),Cn=me((s,f)=>{fe(),pe(),de();var{ArrayIsArray:o,ObjectSetPrototypeOf:u}=ze(),{EventEmitter:c}=(Yt(),Ne(Ut));function i(r){c.call(this,r)}u(i.prototype,c.prototype),u(i,c),i.prototype.pipe=function(r,t){let n=this;function l(I){r.writable&&r.write(I)===!1&&n.pause&&n.pause()}n.on("data",l);function d(){n.readable&&n.resume&&n.resume()}r.on("drain",d),!r._isStdio&&(!t||t.end!==!1)&&(n.on("end",b),n.on("close",m));let p=!1;function b(){p||(p=!0,r.end())}function m(){p||(p=!0,typeof r.destroy=="function"&&r.destroy())}function w(I){E(),c.listenerCount(this,"error")===0&&this.emit("error",I)}e(n,"error",w),e(r,"error",w);function E(){n.removeListener("data",l),r.removeListener("drain",d),n.removeListener("end",b),n.removeListener("close",m),n.removeListener("error",w),r.removeListener("error",w),n.removeListener("end",E),n.removeListener("close",E),r.removeListener("close",E)}return n.on("end",E),n.on("close",E),r.on("close",E),r.emit("pipe",n),r};function e(r,t,n){if(typeof r.prependListener=="function")return r.prependListener(t,n);!r._events||!r._events[t]?r.on(t,n):o(r._events[t])?r._events[t].unshift(n):r._events[t]=[n,r._events[t]]}f.exports={Stream:i,prependListener:e}}),Ur=me((s,f)=>{fe(),pe(),de();var{SymbolDispose:o}=ze(),{AbortError:u,codes:c}=nt(),{isNodeStream:i,isWebStream:e,kControllerErrorFunction:r}=Tt(),t=jt(),{ERR_INVALID_ARG_TYPE:n}=c,l,d=(p,b)=>{if(typeof p!="object"||!("aborted"in p))throw new n(b,"AbortSignal",p)};f.exports.addAbortSignal=function(p,b){if(d(p,"signal"),!i(b)&&!e(b))throw new n("stream",["ReadableStream","WritableStream","Stream"],b);return f.exports.addAbortSignalNoValidate(p,b)},f.exports.addAbortSignalNoValidate=function(p,b){if(typeof p!="object"||!("aborted"in p))return b;let m=i(b)?()=>{b.destroy(new u(void 0,{cause:p.reason}))}:()=>{b[r](new u(void 0,{cause:p.reason}))};if(p.aborted)m();else{l=l||st().addAbortListener;let w=l(p,m);t(b,w[o])}return b}}),xa=me((s,f)=>{fe(),pe(),de();var{StringPrototypeSlice:o,SymbolIterator:u,TypedArrayPrototypeSet:c,Uint8Array:i}=ze(),{Buffer:e}=(Je(),Ne(Ye)),{inspect:r}=st();f.exports=class{constructor(){this.head=null,this.tail=null,this.length=0}push(t){let n={data:t,next:null};this.length>0?this.tail.next=n:this.head=n,this.tail=n,++this.length}unshift(t){let n={data:t,next:this.head};this.length===0&&(this.tail=n),this.head=n,++this.length}shift(){if(this.length===0)return;let t=this.head.data;return this.length===1?this.head=this.tail=null:this.head=this.head.next,--this.length,t}clear(){this.head=this.tail=null,this.length=0}join(t){if(this.length===0)return"";let n=this.head,l=""+n.data;for(;(n=n.next)!==null;)l+=t+n.data;return l}concat(t){if(this.length===0)return e.alloc(0);let n=e.allocUnsafe(t>>>0),l=this.head,d=0;for(;l;)c(n,l.data,d),d+=l.data.length,l=l.next;return n}consume(t,n){let l=this.head.data;if(t<l.length){let d=l.slice(0,t);return this.head.data=l.slice(t),d}return t===l.length?this.shift():n?this._getString(t):this._getBuffer(t)}first(){return this.head.data}*[u](){for(let t=this.head;t;t=t.next)yield t.data}_getString(t){let n="",l=this.head,d=0;do{let p=l.data;if(t>p.length)n+=p,t-=p.length;else{t===p.length?(n+=p,++d,l.next?this.head=l.next:this.head=this.tail=null):(n+=o(p,0,t),this.head=l,l.data=o(p,t));break}++d}while((l=l.next)!==null);return this.length-=d,n}_getBuffer(t){let n=e.allocUnsafe(t),l=t,d=this.head,p=0;do{let b=d.data;if(t>b.length)c(n,b,l-t),t-=b.length;else{t===b.length?(c(n,b,l-t),++p,d.next?this.head=d.next:this.head=this.tail=null):(c(n,new i(b.buffer,b.byteOffset,t),l-t),this.head=d,d.data=b.slice(t));break}++p}while((d=d.next)!==null);return this.length-=p,n}[Symbol.for("nodejs.util.inspect.custom")](t,n){return r(this,{...n,depth:0,customInspect:!1})}}}),jr=me((s,f)=>{fe(),pe(),de();var{MathFloor:o,NumberIsInteger:u}=ze(),{validateInteger:c}=pr(),{ERR_INVALID_ARG_VALUE:i}=nt().codes,e=16*1024,r=16;function t(p,b,m){return p.highWaterMark!=null?p.highWaterMark:b?p[m]:null}function n(p){return p?r:e}function l(p,b){c(b,"value",0),p?r=b:e=b}function d(p,b,m,w){let E=t(b,w,m);if(E!=null){if(!u(E)||E<0){let I=w?`options.${m}`:"options.highWaterMark";throw new i(I,E)}return o(E)}return n(p.objectMode)}f.exports={getHighWaterMark:d,getDefaultHighWaterMark:n,setDefaultHighWaterMark:l}}),Ma=me((s,f)=>{fe(),pe(),de();var o=(Je(),Ne(Ye)),u=o.Buffer;function c(e,r){for(var t in e)r[t]=e[t]}u.from&&u.alloc&&u.allocUnsafe&&u.allocUnsafeSlow?f.exports=o:(c(o,s),s.Buffer=i);function i(e,r,t){return u(e,r,t)}i.prototype=Object.create(u.prototype),c(u,i),i.from=function(e,r,t){if(typeof e=="number")throw new TypeError("Argument must not be a number");return u(e,r,t)},i.alloc=function(e,r,t){if(typeof e!="number")throw new TypeError("Argument must be a number");var n=u(e);return r!==void 0?typeof t=="string"?n.fill(r,t):n.fill(r):n.fill(0),n},i.allocUnsafe=function(e){if(typeof e!="number")throw new TypeError("Argument must be a number");return u(e)},i.allocUnsafeSlow=function(e){if(typeof e!="number")throw new TypeError("Argument must be a number");return o.SlowBuffer(e)}}),La=me(s=>{fe(),pe(),de();var f=Ma().Buffer,o=f.isEncoding||function(y){switch(y=""+y,y&&y.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function u(y){if(!y)return"utf8";for(var _;;)switch(y){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return y;default:if(_)return;y=(""+y).toLowerCase(),_=!0}}function c(y){var _=u(y);if(typeof _!="string"&&(f.isEncoding===o||!o(y)))throw new Error("Unknown encoding: "+y);return _||y}s.StringDecoder=i;function i(y){this.encoding=c(y);var _;switch(this.encoding){case"utf16le":this.text=p,this.end=b,_=4;break;case"utf8":this.fillLast=n,_=4;break;case"base64":this.text=m,this.end=w,_=3;break;default:this.write=E,this.end=I;return}this.lastNeed=0,this.lastTotal=0,this.lastChar=f.allocUnsafe(_)}i.prototype.write=function(y){if(y.length===0)return"";var _,N;if(this.lastNeed){if(_=this.fillLast(y),_===void 0)return"";N=this.lastNeed,this.lastNeed=0}else N=0;return N<y.length?_?_+this.text(y,N):this.text(y,N):_||""},i.prototype.end=d,i.prototype.text=l,i.prototype.fillLast=function(y){if(this.lastNeed<=y.length)return y.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);y.copy(this.lastChar,this.lastTotal-this.lastNeed,0,y.length),this.lastNeed-=y.length};function e(y){return y<=127?0:y>>5===6?2:y>>4===14?3:y>>3===30?4:y>>6===2?-1:-2}function r(y,_,N){var B=_.length-1;if(B<N)return 0;var A=e(_[B]);return A>=0?(A>0&&(y.lastNeed=A-1),A):--B<N||A===-2?0:(A=e(_[B]),A>=0?(A>0&&(y.lastNeed=A-2),A):--B<N||A===-2?0:(A=e(_[B]),A>=0?(A>0&&(A===2?A=0:y.lastNeed=A-3),A):0))}function t(y,_,N){if((_[0]&192)!==128)return y.lastNeed=0,"";if(y.lastNeed>1&&_.length>1){if((_[1]&192)!==128)return y.lastNeed=1,"";if(y.lastNeed>2&&_.length>2&&(_[2]&192)!==128)return y.lastNeed=2,""}}function n(y){var _=this.lastTotal-this.lastNeed,N=t(this,y);if(N!==void 0)return N;if(this.lastNeed<=y.length)return y.copy(this.lastChar,_,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);y.copy(this.lastChar,_,0,y.length),this.lastNeed-=y.length}function l(y,_){var N=r(this,y,_);if(!this.lastNeed)return y.toString("utf8",_);this.lastTotal=N;var B=y.length-(N-this.lastNeed);return y.copy(this.lastChar,0,B),y.toString("utf8",_,B)}function d(y){var _=y&&y.length?this.write(y):"";return this.lastNeed?_+"":_}function p(y,_){if((y.length-_)%2===0){var N=y.toString("utf16le",_);if(N){var B=N.charCodeAt(N.length-1);if(B>=55296&&B<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=y[y.length-2],this.lastChar[1]=y[y.length-1],N.slice(0,-1)}return N}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=y[y.length-1],y.toString("utf16le",_,y.length-1)}function b(y){var _=y&&y.length?this.write(y):"";if(this.lastNeed){var N=this.lastTotal-this.lastNeed;return _+this.lastChar.toString("utf16le",0,N)}return _}function m(y,_){var N=(y.length-_)%3;return N===0?y.toString("base64",_):(this.lastNeed=3-N,this.lastTotal=3,N===1?this.lastChar[0]=y[y.length-1]:(this.lastChar[0]=y[y.length-2],this.lastChar[1]=y[y.length-1]),y.toString("base64",_,y.length-N))}function w(y){var _=y&&y.length?this.write(y):"";return this.lastNeed?_+this.lastChar.toString("base64",0,3-this.lastNeed):_}function E(y){return y.toString(this.encoding)}function I(y){return y&&y.length?this.write(y):""}}),qo=me((s,f)=>{fe(),pe(),de();var o=Jt(),{PromisePrototypeThen:u,SymbolAsyncIterator:c,SymbolIterator:i}=ze(),{Buffer:e}=(Je(),Ne(Ye)),{ERR_INVALID_ARG_TYPE:r,ERR_STREAM_NULL_VALUES:t}=nt().codes;function n(l,d,p){let b;if(typeof d=="string"||d instanceof e)return new l({objectMode:!0,...p,read(){this.push(d),this.push(null)}});let m;if(d&&d[c])m=!0,b=d[c]();else if(d&&d[i])m=!1,b=d[i]();else throw new r("iterable",["Iterable"],d);let w=new l({objectMode:!0,highWaterMark:1,...p}),E=!1;w._read=function(){E||(E=!0,y())},w._destroy=function(_,N){u(I(_),()=>o.nextTick(N,_),B=>o.nextTick(N,B||_))};async function I(_){let N=_!=null,B=typeof b.throw=="function";if(N&&B){let{value:A,done:k}=await b.throw(_);if(await A,k)return}if(typeof b.return=="function"){let{value:A}=await b.return();await A}}async function y(){for(;;){try{let{value:_,done:N}=m?await b.next():b.next();if(N)w.push(null);else{let B=_&&typeof _.then=="function"?await _:_;if(B===null)throw E=!1,new t;if(w.push(B))continue;E=!1}}catch(_){w.destroy(_)}break}}return w}f.exports=n}),Nr=me((s,f)=>{fe(),pe(),de();var o=Jt(),{ArrayPrototypeIndexOf:u,NumberIsInteger:c,NumberIsNaN:i,NumberParseInt:e,ObjectDefineProperties:r,ObjectKeys:t,ObjectSetPrototypeOf:n,Promise:l,SafeSet:d,SymbolAsyncDispose:p,SymbolAsyncIterator:b,Symbol:m}=ze();f.exports=ee,ee.ReadableState=ye;var{EventEmitter:w}=(Yt(),Ne(Ut)),{Stream:E,prependListener:I}=Cn(),{Buffer:y}=(Je(),Ne(Ye)),{addAbortSignal:_}=Ur(),N=jt(),B=st().debuglog("stream",S=>{B=S}),A=xa(),k=ir(),{getHighWaterMark:M,getDefaultHighWaterMark:J}=jr(),{aggregateTwoErrors:X,codes:{ERR_INVALID_ARG_TYPE:ue,ERR_METHOD_NOT_IMPLEMENTED:C,ERR_OUT_OF_RANGE:q,ERR_STREAM_PUSH_AFTER_EOF:K,ERR_STREAM_UNSHIFT_AFTER_END_EVENT:j},AbortError:te}=nt(),{validateObject:ae}=pr(),ie=m("kPaused"),{StringDecoder:ve}=La(),z=qo();n(ee.prototype,E.prototype),n(ee,E);var ge=()=>{},{errorOrDestroy:R}=k,ne=1,be=2,D=4,Ae=8,Q=16,L=32,Z=64,$=128,H=256,V=512,he=1024,oe=2048,x=4096,F=8192,Y=16384,se=32768,re=65536,ce=1<<17,W=1<<18;function le(S){return{enumerable:!1,get(){return(this.state&S)!==0},set(P){P?this.state|=S:this.state&=~S}}}r(ye.prototype,{objectMode:le(ne),ended:le(be),endEmitted:le(D),reading:le(Ae),constructed:le(Q),sync:le(L),needReadable:le(Z),emittedReadable:le($),readableListening:le(H),resumeScheduled:le(V),errorEmitted:le(he),emitClose:le(oe),autoDestroy:le(x),destroyed:le(F),closed:le(Y),closeEmitted:le(se),multiAwaitDrain:le(re),readingMore:le(ce),dataEmitted:le(W)});function ye(S,P,we){typeof we!="boolean"&&(we=P instanceof It()),this.state=oe|x|Q|L,S&&S.objectMode&&(this.state|=ne),we&&S&&S.readableObjectMode&&(this.state|=ne),this.highWaterMark=S?M(this,S,"readableHighWaterMark",we):J(!1),this.buffer=new A,this.length=0,this.pipes=[],this.flowing=null,this[ie]=null,S&&S.emitClose===!1&&(this.state&=~oe),S&&S.autoDestroy===!1&&(this.state&=~x),this.errored=null,this.defaultEncoding=S&&S.defaultEncoding||"utf8",this.awaitDrainWriters=null,this.decoder=null,this.encoding=null,S&&S.encoding&&(this.decoder=new ve(S.encoding),this.encoding=S.encoding)}function ee(S){if(!(this instanceof ee))return new ee(S);let P=this instanceof It();this._readableState=new ye(S,this,P),S&&(typeof S.read=="function"&&(this._read=S.read),typeof S.destroy=="function"&&(this._destroy=S.destroy),typeof S.construct=="function"&&(this._construct=S.construct),S.signal&&!P&&_(S.signal,this)),E.call(this,S),k.construct(this,()=>{this._readableState.needReadable&&_e(this,this._readableState)})}ee.prototype.destroy=k.destroy,ee.prototype._undestroy=k.undestroy,ee.prototype._destroy=function(S,P){P(S)},ee.prototype[w.captureRejectionSymbol]=function(S){this.destroy(S)},ee.prototype[p]=function(){let S;return this.destroyed||(S=this.readableEnded?null:new te,this.destroy(S)),new l((P,we)=>N(this,Se=>Se&&Se!==S?we(Se):P(null)))},ee.prototype.push=function(S,P){return Pe(this,S,P,!1)},ee.prototype.unshift=function(S,P){return Pe(this,S,P,!0)};function Pe(S,P,we,Se){B("readableAddChunk",P);let ke=S._readableState,et;if((ke.state&ne)===0&&(typeof P=="string"?(we=we||ke.defaultEncoding,ke.encoding!==we&&(Se&&ke.encoding?P=y.from(P,we).toString(ke.encoding):(P=y.from(P,we),we=""))):P instanceof y?we="":E._isUint8Array(P)?(P=E._uint8ArrayToBuffer(P),we=""):P!=null&&(et=new ue("chunk",["string","Buffer","Uint8Array"],P))),et)R(S,et);else if(P===null)ke.state&=~Ae,T(S,ke);else if((ke.state&ne)!==0||P&&P.length>0)if(Se)if((ke.state&D)!==0)R(S,new j);else{if(ke.destroyed||ke.errored)return!1;a(S,ke,P,!0)}else if(ke.ended)R(S,new K);else{if(ke.destroyed||ke.errored)return!1;ke.state&=~Ae,ke.decoder&&!we?(P=ke.decoder.write(P),ke.objectMode||P.length!==0?a(S,ke,P,!1):_e(S,ke)):a(S,ke,P,!1)}else Se||(ke.state&=~Ae,_e(S,ke));return!ke.ended&&(ke.length<ke.highWaterMark||ke.length===0)}function a(S,P,we,Se){P.flowing&&P.length===0&&!P.sync&&S.listenerCount("data")>0?((P.state&re)!==0?P.awaitDrainWriters.clear():P.awaitDrainWriters=null,P.dataEmitted=!0,S.emit("data",we)):(P.length+=P.objectMode?1:we.length,Se?P.buffer.unshift(we):P.buffer.push(we),(P.state&Z)!==0&&U(S)),_e(S,P)}ee.prototype.isPaused=function(){let S=this._readableState;return S[ie]===!0||S.flowing===!1},ee.prototype.setEncoding=function(S){let P=new ve(S);this._readableState.decoder=P,this._readableState.encoding=this._readableState.decoder.encoding;let we=this._readableState.buffer,Se="";for(let ke of we)Se+=P.write(ke);return we.clear(),Se!==""&&we.push(Se),this._readableState.length=Se.length,this};var h=1073741824;function g(S){if(S>h)throw new q("size","<= 1GiB",S);return S--,S|=S>>>1,S|=S>>>2,S|=S>>>4,S|=S>>>8,S|=S>>>16,S++,S}function v(S,P){return S<=0||P.length===0&&P.ended?0:(P.state&ne)!==0?1:i(S)?P.flowing&&P.length?P.buffer.first().length:P.length:S<=P.length?S:P.ended?P.length:0}ee.prototype.read=function(S){B("read",S),S===void 0?S=NaN:c(S)||(S=e(S,10));let P=this._readableState,we=S;if(S>P.highWaterMark&&(P.highWaterMark=g(S)),S!==0&&(P.state&=~$),S===0&&P.needReadable&&((P.highWaterMark!==0?P.length>=P.highWaterMark:P.length>0)||P.ended))return B("read: emitReadable",P.length,P.ended),P.length===0&&P.ended?Fe(this):U(this),null;if(S=v(S,P),S===0&&P.ended)return P.length===0&&Fe(this),null;let Se=(P.state&Z)!==0;if(B("need readable",Se),(P.length===0||P.length-S<P.highWaterMark)&&(Se=!0,B("length less than watermark",Se)),P.ended||P.reading||P.destroyed||P.errored||!P.constructed)Se=!1,B("reading, ended or constructing",Se);else if(Se){B("do read"),P.state|=Ae|L,P.length===0&&(P.state|=Z);try{this._read(P.highWaterMark)}catch(et){R(this,et)}P.state&=~L,P.reading||(S=v(we,P))}let ke;return S>0?ke=Re(S,P):ke=null,ke===null?(P.needReadable=P.length<=P.highWaterMark,S=0):(P.length-=S,P.multiAwaitDrain?P.awaitDrainWriters.clear():P.awaitDrainWriters=null),P.length===0&&(P.ended||(P.needReadable=!0),we!==S&&P.ended&&Fe(this)),ke!==null&&!P.errorEmitted&&!P.closeEmitted&&(P.dataEmitted=!0,this.emit("data",ke)),ke};function T(S,P){if(B("onEofChunk"),!P.ended){if(P.decoder){let we=P.decoder.end();we&&we.length&&(P.buffer.push(we),P.length+=P.objectMode?1:we.length)}P.ended=!0,P.sync?U(S):(P.needReadable=!1,P.emittedReadable=!0,G(S))}}function U(S){let P=S._readableState;B("emitReadable",P.needReadable,P.emittedReadable),P.needReadable=!1,P.emittedReadable||(B("emitReadable",P.flowing),P.emittedReadable=!0,o.nextTick(G,S))}function G(S){let P=S._readableState;B("emitReadable_",P.destroyed,P.length,P.ended),!P.destroyed&&!P.errored&&(P.length||P.ended)&&(S.emit("readable"),P.emittedReadable=!1),P.needReadable=!P.flowing&&!P.ended&&P.length<=P.highWaterMark,at(S)}function _e(S,P){!P.readingMore&&P.constructed&&(P.readingMore=!0,o.nextTick(Ee,S,P))}function Ee(S,P){for(;!P.reading&&!P.ended&&(P.length<P.highWaterMark||P.flowing&&P.length===0);){let we=P.length;if(B("maybeReadMore read 0"),S.read(0),we===P.length)break}P.readingMore=!1}ee.prototype._read=function(S){throw new C("_read()")},ee.prototype.pipe=function(S,P){let we=this,Se=this._readableState;Se.pipes.length===1&&(Se.multiAwaitDrain||(Se.multiAwaitDrain=!0,Se.awaitDrainWriters=new d(Se.awaitDrainWriters?[Se.awaitDrainWriters]:[]))),Se.pipes.push(S),B("pipe count=%d opts=%j",Se.pipes.length,P);let ke=(!P||P.end!==!1)&&S!==o.stdout&&S!==o.stderr?ut:or;Se.endEmitted?o.nextTick(ke):we.once("end",ke),S.on("unpipe",et);function et(Dt,mt){B("onunpipe"),Dt===we&&mt&&mt.hasUnpiped===!1&&(mt.hasUnpiped=!0,ta())}function ut(){B("onend"),S.end()}let Nt,Un=!1;function ta(){B("cleanup"),S.removeListener("close",$r),S.removeListener("finish",qr),Nt&&S.removeListener("drain",Nt),S.removeListener("error",Wr),S.removeListener("unpipe",et),we.removeListener("end",ut),we.removeListener("end",or),we.removeListener("data",Nn),Un=!0,Nt&&Se.awaitDrainWriters&&(!S._writableState||S._writableState.needDrain)&&Nt()}function jn(){Un||(Se.pipes.length===1&&Se.pipes[0]===S?(B("false write response, pause",0),Se.awaitDrainWriters=S,Se.multiAwaitDrain=!1):Se.pipes.length>1&&Se.pipes.includes(S)&&(B("false write response, pause",Se.awaitDrainWriters.size),Se.awaitDrainWriters.add(S)),we.pause()),Nt||(Nt=Te(we,S),S.on("drain",Nt))}we.on("data",Nn);function Nn(Dt){B("ondata");let mt=S.write(Dt);B("dest.write",mt),mt===!1&&jn()}function Wr(Dt){if(B("onerror",Dt),or(),S.removeListener("error",Wr),S.listenerCount("error")===0){let mt=S._writableState||S._readableState;mt&&!mt.errorEmitted?R(S,Dt):S.emit("error",Dt)}}I(S,"error",Wr);function $r(){S.removeListener("finish",qr),or()}S.once("close",$r);function qr(){B("onfinish"),S.removeListener("close",$r),or()}S.once("finish",qr);function or(){B("unpipe"),we.unpipe(S)}return S.emit("pipe",we),S.writableNeedDrain===!0?jn():Se.flowing||(B("pipe resume"),we.resume()),S};function Te(S,P){return function(){let we=S._readableState;we.awaitDrainWriters===P?(B("pipeOnDrain",1),we.awaitDrainWriters=null):we.multiAwaitDrain&&(B("pipeOnDrain",we.awaitDrainWriters.size),we.awaitDrainWriters.delete(P)),(!we.awaitDrainWriters||we.awaitDrainWriters.size===0)&&S.listenerCount("data")&&S.resume()}}ee.prototype.unpipe=function(S){let P=this._readableState,we={hasUnpiped:!1};if(P.pipes.length===0)return this;if(!S){let ke=P.pipes;P.pipes=[],this.pause();for(let et=0;et<ke.length;et++)ke[et].emit("unpipe",this,{hasUnpiped:!1});return this}let Se=u(P.pipes,S);return Se===-1?this:(P.pipes.splice(Se,1),P.pipes.length===0&&this.pause(),S.emit("unpipe",this,we),this)},ee.prototype.on=function(S,P){let we=E.prototype.on.call(this,S,P),Se=this._readableState;return S==="data"?(Se.readableListening=this.listenerCount("readable")>0,Se.flowing!==!1&&this.resume()):S==="readable"&&!Se.endEmitted&&!Se.readableListening&&(Se.readableListening=Se.needReadable=!0,Se.flowing=!1,Se.emittedReadable=!1,B("on readable",Se.length,Se.reading),Se.length?U(this):Se.reading||o.nextTick(Ce,this)),we},ee.prototype.addListener=ee.prototype.on,ee.prototype.removeListener=function(S,P){let we=E.prototype.removeListener.call(this,S,P);return S==="readable"&&o.nextTick(Be,this),we},ee.prototype.off=ee.prototype.removeListener,ee.prototype.removeAllListeners=function(S){let P=E.prototype.removeAllListeners.apply(this,arguments);return(S==="readable"||S===void 0)&&o.nextTick(Be,this),P};function Be(S){let P=S._readableState;P.readableListening=S.listenerCount("readable")>0,P.resumeScheduled&&P[ie]===!1?P.flowing=!0:S.listenerCount("data")>0?S.resume():P.readableListening||(P.flowing=null)}function Ce(S){B("readable nexttick read 0"),S.read(0)}ee.prototype.resume=function(){let S=this._readableState;return S.flowing||(B("resume"),S.flowing=!S.readableListening,dt(this,S)),S[ie]=!1,this};function dt(S,P){P.resumeScheduled||(P.resumeScheduled=!0,o.nextTick(ot,S,P))}function ot(S,P){B("resume",P.reading),P.reading||S.read(0),P.resumeScheduled=!1,S.emit("resume"),at(S),P.flowing&&!P.reading&&S.read(0)}ee.prototype.pause=function(){return B("call pause flowing=%j",this._readableState.flowing),this._readableState.flowing!==!1&&(B("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState[ie]=!0,this};function at(S){let P=S._readableState;for(B("flow",P.flowing);P.flowing&&S.read()!==null;);}ee.prototype.wrap=function(S){let P=!1;S.on("data",Se=>{!this.push(Se)&&S.pause&&(P=!0,S.pause())}),S.on("end",()=>{this.push(null)}),S.on("error",Se=>{R(this,Se)}),S.on("close",()=>{this.destroy()}),S.on("destroy",()=>{this.destroy()}),this._read=()=>{P&&S.resume&&(P=!1,S.resume())};let we=t(S);for(let Se=1;Se<we.length;Se++){let ke=we[Se];this[ke]===void 0&&typeof S[ke]=="function"&&(this[ke]=S[ke].bind(S))}return this},ee.prototype[b]=function(){return $e(this)},ee.prototype.iterator=function(S){return S!==void 0&&ae(S,"options"),$e(this,S)};function $e(S,P){typeof S.read!="function"&&(S=ee.wrap(S,{objectMode:!0}));let we=Ge(S,P);return we.stream=S,we}async function*Ge(S,P){let we=ge;function Se(ut){this===S?(we(),we=ge):we=ut}S.on("readable",Se);let ke,et=N(S,{writable:!1},ut=>{ke=ut?X(ke,ut):null,we(),we=ge});try{for(;;){let ut=S.destroyed?null:S.read();if(ut!==null)yield ut;else{if(ke)throw ke;if(ke===null)return;await new l(Se)}}}catch(ut){throw ke=X(ke,ut),ke}finally{(ke||(P==null?void 0:P.destroyOnReturn)!==!1)&&(ke===void 0||S._readableState.autoDestroy)?k.destroyer(S,null):(S.off("readable",Se),et())}}r(ee.prototype,{readable:{__proto__:null,get(){let S=this._readableState;return!!S&&S.readable!==!1&&!S.destroyed&&!S.errorEmitted&&!S.endEmitted},set(S){this._readableState&&(this._readableState.readable=!!S)}},readableDidRead:{__proto__:null,enumerable:!1,get:function(){return this._readableState.dataEmitted}},readableAborted:{__proto__:null,enumerable:!1,get:function(){return!!(this._readableState.readable!==!1&&(this._readableState.destroyed||this._readableState.errored)&&!this._readableState.endEmitted)}},readableHighWaterMark:{__proto__:null,enumerable:!1,get:function(){return this._readableState.highWaterMark}},readableBuffer:{__proto__:null,enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}},readableFlowing:{__proto__:null,enumerable:!1,get:function(){return this._readableState.flowing},set:function(S){this._readableState&&(this._readableState.flowing=S)}},readableLength:{__proto__:null,enumerable:!1,get(){return this._readableState.length}},readableObjectMode:{__proto__:null,enumerable:!1,get(){return this._readableState?this._readableState.objectMode:!1}},readableEncoding:{__proto__:null,enumerable:!1,get(){return this._readableState?this._readableState.encoding:null}},errored:{__proto__:null,enumerable:!1,get(){return this._readableState?this._readableState.errored:null}},closed:{__proto__:null,get(){return this._readableState?this._readableState.closed:!1}},destroyed:{__proto__:null,enumerable:!1,get(){return this._readableState?this._readableState.destroyed:!1},set(S){this._readableState&&(this._readableState.destroyed=S)}},readableEnded:{__proto__:null,enumerable:!1,get(){return this._readableState?this._readableState.endEmitted:!1}}}),r(ye.prototype,{pipesCount:{__proto__:null,get(){return this.pipes.length}},paused:{__proto__:null,get(){return this[ie]!==!1},set(S){this[ie]=!!S}}}),ee._fromList=Re;function Re(S,P){if(P.length===0)return null;let we;return P.objectMode?we=P.buffer.shift():!S||S>=P.length?(P.decoder?we=P.buffer.join(""):P.buffer.length===1?we=P.buffer.first():we=P.buffer.concat(P.length),P.buffer.clear()):we=P.buffer.consume(S,P.decoder),we}function Fe(S){let P=S._readableState;B("endReadable",P.endEmitted),P.endEmitted||(P.ended=!0,o.nextTick(Ze,P,S))}function Ze(S,P){if(B("endReadableNT",S.endEmitted,S.length),!S.errored&&!S.closeEmitted&&!S.endEmitted&&S.length===0){if(S.endEmitted=!0,P.emit("end"),P.writable&&P.allowHalfOpen===!1)o.nextTick(Ke,P);else if(S.autoDestroy){let we=P._writableState;(!we||we.autoDestroy&&(we.finished||we.writable===!1))&&P.destroy()}}}function Ke(S){S.writable&&!S.writableEnded&&!S.destroyed&&S.end()}ee.from=function(S,P){return z(ee,S,P)};var rt;function Ct(){return rt===void 0&&(rt={}),rt}ee.fromWeb=function(S,P){return Ct().newStreamReadableFromReadableStream(S,P)},ee.toWeb=function(S,P){return Ct().newReadableStreamFromStreamReadable(S,P)},ee.wrap=function(S,P){var we,Se;return new ee({objectMode:(we=(Se=S.readableObjectMode)!==null&&Se!==void 0?Se:S.objectMode)!==null&&we!==void 0?we:!0,...P,destroy(ke,et){k.destroyer(S,ke),et(ke)}}).wrap(S)}}),Rn=me((s,f)=>{fe(),pe(),de();var o=Jt(),{ArrayPrototypeSlice:u,Error:c,FunctionPrototypeSymbolHasInstance:i,ObjectDefineProperty:e,ObjectDefineProperties:r,ObjectSetPrototypeOf:t,StringPrototypeToLowerCase:n,Symbol:l,SymbolHasInstance:d}=ze();f.exports=ae,ae.WritableState=j;var{EventEmitter:p}=(Yt(),Ne(Ut)),b=Cn().Stream,{Buffer:m}=(Je(),Ne(Ye)),w=ir(),{addAbortSignal:E}=Ur(),{getHighWaterMark:I,getDefaultHighWaterMark:y}=jr(),{ERR_INVALID_ARG_TYPE:_,ERR_METHOD_NOT_IMPLEMENTED:N,ERR_MULTIPLE_CALLBACK:B,ERR_STREAM_CANNOT_PIPE:A,ERR_STREAM_DESTROYED:k,ERR_STREAM_ALREADY_FINISHED:M,ERR_STREAM_NULL_VALUES:J,ERR_STREAM_WRITE_AFTER_END:X,ERR_UNKNOWN_ENCODING:ue}=nt().codes,{errorOrDestroy:C}=w;t(ae.prototype,b.prototype),t(ae,b);function q(){}var K=l("kOnFinished");function j(x,F,Y){typeof Y!="boolean"&&(Y=F instanceof It()),this.objectMode=!!(x&&x.objectMode),Y&&(this.objectMode=this.objectMode||!!(x&&x.writableObjectMode)),this.highWaterMark=x?I(this,x,"writableHighWaterMark",Y):y(!1),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;let se=!!(x&&x.decodeStrings===!1);this.decodeStrings=!se,this.defaultEncoding=x&&x.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=R.bind(void 0,F),this.writecb=null,this.writelen=0,this.afterWriteTickInfo=null,te(this),this.pendingcb=0,this.constructed=!0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=!x||x.emitClose!==!1,this.autoDestroy=!x||x.autoDestroy!==!1,this.errored=null,this.closed=!1,this.closeEmitted=!1,this[K]=[]}function te(x){x.buffered=[],x.bufferedIndex=0,x.allBuffers=!0,x.allNoop=!0}j.prototype.getBuffer=function(){return u(this.buffered,this.bufferedIndex)},e(j.prototype,"bufferedRequestCount",{__proto__:null,get(){return this.buffered.length-this.bufferedIndex}});function ae(x){let F=this instanceof It();if(!F&&!i(ae,this))return new ae(x);this._writableState=new j(x,this,F),x&&(typeof x.write=="function"&&(this._write=x.write),typeof x.writev=="function"&&(this._writev=x.writev),typeof x.destroy=="function"&&(this._destroy=x.destroy),typeof x.final=="function"&&(this._final=x.final),typeof x.construct=="function"&&(this._construct=x.construct),x.signal&&E(x.signal,this)),b.call(this,x),w.construct(this,()=>{let Y=this._writableState;Y.writing||Ae(this,Y),$(this,Y)})}e(ae,d,{__proto__:null,value:function(x){return i(this,x)?!0:this!==ae?!1:x&&x._writableState instanceof j}}),ae.prototype.pipe=function(){C(this,new A)};function ie(x,F,Y,se){let re=x._writableState;if(typeof Y=="function")se=Y,Y=re.defaultEncoding;else{if(!Y)Y=re.defaultEncoding;else if(Y!=="buffer"&&!m.isEncoding(Y))throw new ue(Y);typeof se!="function"&&(se=q)}if(F===null)throw new J;if(!re.objectMode)if(typeof F=="string")re.decodeStrings!==!1&&(F=m.from(F,Y),Y="buffer");else if(F instanceof m)Y="buffer";else if(b._isUint8Array(F))F=b._uint8ArrayToBuffer(F),Y="buffer";else throw new _("chunk",["string","Buffer","Uint8Array"],F);let ce;return re.ending?ce=new X:re.destroyed&&(ce=new k("write")),ce?(o.nextTick(se,ce),C(x,ce,!0),ce):(re.pendingcb++,ve(x,re,F,Y,se))}ae.prototype.write=function(x,F,Y){return ie(this,x,F,Y)===!0},ae.prototype.cork=function(){this._writableState.corked++},ae.prototype.uncork=function(){let x=this._writableState;x.corked&&(x.corked--,x.writing||Ae(this,x))},ae.prototype.setDefaultEncoding=function(x){if(typeof x=="string"&&(x=n(x)),!m.isEncoding(x))throw new ue(x);return this._writableState.defaultEncoding=x,this};function ve(x,F,Y,se,re){let ce=F.objectMode?1:Y.length;F.length+=ce;let W=F.length<F.highWaterMark;return W||(F.needDrain=!0),F.writing||F.corked||F.errored||!F.constructed?(F.buffered.push({chunk:Y,encoding:se,callback:re}),F.allBuffers&&se!=="buffer"&&(F.allBuffers=!1),F.allNoop&&re!==q&&(F.allNoop=!1)):(F.writelen=ce,F.writecb=re,F.writing=!0,F.sync=!0,x._write(Y,se,F.onwrite),F.sync=!1),W&&!F.errored&&!F.destroyed}function z(x,F,Y,se,re,ce,W){F.writelen=se,F.writecb=W,F.writing=!0,F.sync=!0,F.destroyed?F.onwrite(new k("write")):Y?x._writev(re,F.onwrite):x._write(re,ce,F.onwrite),F.sync=!1}function ge(x,F,Y,se){--F.pendingcb,se(Y),D(F),C(x,Y)}function R(x,F){let Y=x._writableState,se=Y.sync,re=Y.writecb;if(typeof re!="function"){C(x,new B);return}Y.writing=!1,Y.writecb=null,Y.length-=Y.writelen,Y.writelen=0,F?(F.stack,Y.errored||(Y.errored=F),x._readableState&&!x._readableState.errored&&(x._readableState.errored=F),se?o.nextTick(ge,x,Y,F,re):ge(x,Y,F,re)):(Y.buffered.length>Y.bufferedIndex&&Ae(x,Y),se?Y.afterWriteTickInfo!==null&&Y.afterWriteTickInfo.cb===re?Y.afterWriteTickInfo.count++:(Y.afterWriteTickInfo={count:1,cb:re,stream:x,state:Y},o.nextTick(ne,Y.afterWriteTickInfo)):be(x,Y,1,re))}function ne({stream:x,state:F,count:Y,cb:se}){return F.afterWriteTickInfo=null,be(x,F,Y,se)}function be(x,F,Y,se){for(!F.ending&&!x.destroyed&&F.length===0&&F.needDrain&&(F.needDrain=!1,x.emit("drain"));Y-- >0;)F.pendingcb--,se();F.destroyed&&D(F),$(x,F)}function D(x){if(x.writing)return;for(let re=x.bufferedIndex;re<x.buffered.length;++re){var F;let{chunk:ce,callback:W}=x.buffered[re],le=x.objectMode?1:ce.length;x.length-=le,W((F=x.errored)!==null&&F!==void 0?F:new k("write"))}let Y=x[K].splice(0);for(let re=0;re<Y.length;re++){var se;Y[re]((se=x.errored)!==null&&se!==void 0?se:new k("end"))}te(x)}function Ae(x,F){if(F.corked||F.bufferProcessing||F.destroyed||!F.constructed)return;let{buffered:Y,bufferedIndex:se,objectMode:re}=F,ce=Y.length-se;if(!ce)return;let W=se;if(F.bufferProcessing=!0,ce>1&&x._writev){F.pendingcb-=ce-1;let le=F.allNoop?q:ee=>{for(let Pe=W;Pe<Y.length;++Pe)Y[Pe].callback(ee)},ye=F.allNoop&&W===0?Y:u(Y,W);ye.allBuffers=F.allBuffers,z(x,F,!0,F.length,ye,"",le),te(F)}else{do{let{chunk:le,encoding:ye,callback:ee}=Y[W];Y[W++]=null;let Pe=re?1:le.length;z(x,F,!1,Pe,le,ye,ee)}while(W<Y.length&&!F.writing);W===Y.length?te(F):W>256?(Y.splice(0,W),F.bufferedIndex=0):F.bufferedIndex=W}F.bufferProcessing=!1}ae.prototype._write=function(x,F,Y){if(this._writev)this._writev([{chunk:x,encoding:F}],Y);else throw new N("_write()")},ae.prototype._writev=null,ae.prototype.end=function(x,F,Y){let se=this._writableState;typeof x=="function"?(Y=x,x=null,F=null):typeof F=="function"&&(Y=F,F=null);let re;if(x!=null){let ce=ie(this,x,F);ce instanceof c&&(re=ce)}return se.corked&&(se.corked=1,this.uncork()),re||(!se.errored&&!se.ending?(se.ending=!0,$(this,se,!0),se.ended=!0):se.finished?re=new M("end"):se.destroyed&&(re=new k("end"))),typeof Y=="function"&&(re||se.finished?o.nextTick(Y,re):se[K].push(Y)),this};function Q(x){return x.ending&&!x.destroyed&&x.constructed&&x.length===0&&!x.errored&&x.buffered.length===0&&!x.finished&&!x.writing&&!x.errorEmitted&&!x.closeEmitted}function L(x,F){let Y=!1;function se(re){if(Y){C(x,re??B());return}if(Y=!0,F.pendingcb--,re){let ce=F[K].splice(0);for(let W=0;W<ce.length;W++)ce[W](re);C(x,re,F.sync)}else Q(F)&&(F.prefinished=!0,x.emit("prefinish"),F.pendingcb++,o.nextTick(H,x,F))}F.sync=!0,F.pendingcb++;try{x._final(se)}catch(re){se(re)}F.sync=!1}function Z(x,F){!F.prefinished&&!F.finalCalled&&(typeof x._final=="function"&&!F.destroyed?(F.finalCalled=!0,L(x,F)):(F.prefinished=!0,x.emit("prefinish")))}function $(x,F,Y){Q(F)&&(Z(x,F),F.pendingcb===0&&(Y?(F.pendingcb++,o.nextTick((se,re)=>{Q(re)?H(se,re):re.pendingcb--},x,F)):Q(F)&&(F.pendingcb++,H(x,F))))}function H(x,F){F.pendingcb--,F.finished=!0;let Y=F[K].splice(0);for(let se=0;se<Y.length;se++)Y[se]();if(x.emit("finish"),F.autoDestroy){let se=x._readableState;(!se||se.autoDestroy&&(se.endEmitted||se.readable===!1))&&x.destroy()}}r(ae.prototype,{closed:{__proto__:null,get(){return this._writableState?this._writableState.closed:!1}},destroyed:{__proto__:null,get(){return this._writableState?this._writableState.destroyed:!1},set(x){this._writableState&&(this._writableState.destroyed=x)}},writable:{__proto__:null,get(){let x=this._writableState;return!!x&&x.writable!==!1&&!x.destroyed&&!x.errored&&!x.ending&&!x.ended},set(x){this._writableState&&(this._writableState.writable=!!x)}},writableFinished:{__proto__:null,get(){return this._writableState?this._writableState.finished:!1}},writableObjectMode:{__proto__:null,get(){return this._writableState?this._writableState.objectMode:!1}},writableBuffer:{__proto__:null,get(){return this._writableState&&this._writableState.getBuffer()}},writableEnded:{__proto__:null,get(){return this._writableState?this._writableState.ending:!1}},writableNeedDrain:{__proto__:null,get(){let x=this._writableState;return x?!x.destroyed&&!x.ending&&x.needDrain:!1}},writableHighWaterMark:{__proto__:null,get(){return this._writableState&&this._writableState.highWaterMark}},writableCorked:{__proto__:null,get(){return this._writableState?this._writableState.corked:0}},writableLength:{__proto__:null,get(){return this._writableState&&this._writableState.length}},errored:{__proto__:null,enumerable:!1,get(){return this._writableState?this._writableState.errored:null}},writableAborted:{__proto__:null,enumerable:!1,get:function(){return!!(this._writableState.writable!==!1&&(this._writableState.destroyed||this._writableState.errored)&&!this._writableState.finished)}}});var V=w.destroy;ae.prototype.destroy=function(x,F){let Y=this._writableState;return!Y.destroyed&&(Y.bufferedIndex<Y.buffered.length||Y[K].length)&&o.nextTick(D,Y),V.call(this,x,F),this},ae.prototype._undestroy=w.undestroy,ae.prototype._destroy=function(x,F){F(x)},ae.prototype[p.captureRejectionSymbol]=function(x){this.destroy(x)};var he;function oe(){return he===void 0&&(he={}),he}ae.fromWeb=function(x,F){return oe().newStreamWritableFromWritableStream(x,F)},ae.toWeb=function(x){return oe().newWritableStreamFromStreamWritable(x)}}),Ua=me((s,f)=>{fe(),pe(),de();var o=Jt(),u=(Je(),Ne(Ye)),{isReadable:c,isWritable:i,isIterable:e,isNodeStream:r,isReadableNodeStream:t,isWritableNodeStream:n,isDuplexNodeStream:l,isReadableStream:d,isWritableStream:p}=Tt(),b=jt(),{AbortError:m,codes:{ERR_INVALID_ARG_TYPE:w,ERR_INVALID_RETURN_VALUE:E}}=nt(),{destroyer:I}=ir(),y=It(),_=Nr(),N=Rn(),{createDeferredPromise:B}=st(),A=qo(),k=globalThis.Blob||u.Blob,M=typeof k<"u"?function(K){return K instanceof k}:function(K){return!1},J=globalThis.AbortController||dr().AbortController,{FunctionPrototypeCall:X}=ze(),ue=class extends y{constructor(K){super(K),(K==null?void 0:K.readable)===!1&&(this._readableState.readable=!1,this._readableState.ended=!0,this._readableState.endEmitted=!0),(K==null?void 0:K.writable)===!1&&(this._writableState.writable=!1,this._writableState.ending=!0,this._writableState.ended=!0,this._writableState.finished=!0)}};f.exports=function K(j,te){if(l(j))return j;if(t(j))return q({readable:j});if(n(j))return q({writable:j});if(r(j))return q({writable:!1,readable:!1});if(d(j))return q({readable:_.fromWeb(j)});if(p(j))return q({writable:N.fromWeb(j)});if(typeof j=="function"){let{value:ie,write:ve,final:z,destroy:ge}=C(j);if(e(ie))return A(ue,ie,{objectMode:!0,write:ve,final:z,destroy:ge});let R=ie==null?void 0:ie.then;if(typeof R=="function"){let ne,be=X(R,ie,D=>{if(D!=null)throw new E("nully","body",D)},D=>{I(ne,D)});return ne=new ue({objectMode:!0,readable:!1,write:ve,final(D){z(async()=>{try{await be,o.nextTick(D,null)}catch(Ae){o.nextTick(D,Ae)}})},destroy:ge})}throw new E("Iterable, AsyncIterable or AsyncFunction",te,ie)}if(M(j))return K(j.arrayBuffer());if(e(j))return A(ue,j,{objectMode:!0,writable:!1});if(d(j==null?void 0:j.readable)&&p(j==null?void 0:j.writable))return ue.fromWeb(j);if(typeof(j==null?void 0:j.writable)=="object"||typeof(j==null?void 0:j.readable)=="object"){let ie=j!=null&&j.readable?t(j==null?void 0:j.readable)?j==null?void 0:j.readable:K(j.readable):void 0,ve=j!=null&&j.writable?n(j==null?void 0:j.writable)?j==null?void 0:j.writable:K(j.writable):void 0;return q({readable:ie,writable:ve})}let ae=j==null?void 0:j.then;if(typeof ae=="function"){let ie;return X(ae,j,ve=>{ve!=null&&ie.push(ve),ie.push(null)},ve=>{I(ie,ve)}),ie=new ue({objectMode:!0,writable:!1,read(){}})}throw new w(te,["Blob","ReadableStream","WritableStream","Stream","Iterable","AsyncIterable","Function","{ readable, writable } pair","Promise"],j)};function C(K){let{promise:j,resolve:te}=B(),ae=new J,ie=ae.signal;return{value:K(async function*(){for(;;){let ve=j;j=null;let{chunk:z,done:ge,cb:R}=await ve;if(o.nextTick(R),ge)return;if(ie.aborted)throw new m(void 0,{cause:ie.reason});({promise:j,resolve:te}=B()),yield z}}(),{signal:ie}),write(ve,z,ge){let R=te;te=null,R({chunk:ve,done:!1,cb:ge})},final(ve){let z=te;te=null,z({done:!0,cb:ve})},destroy(ve,z){ae.abort(),z(ve)}}}function q(K){let j=K.readable&&typeof K.readable.read!="function"?_.wrap(K.readable):K.readable,te=K.writable,ae=!!c(j),ie=!!i(te),ve,z,ge,R,ne;function be(D){let Ae=R;R=null,Ae?Ae(D):D&&ne.destroy(D)}return ne=new ue({readableObjectMode:!!(j!=null&&j.readableObjectMode),writableObjectMode:!!(te!=null&&te.writableObjectMode),readable:ae,writable:ie}),ie&&(b(te,D=>{ie=!1,D&&I(j,D),be(D)}),ne._write=function(D,Ae,Q){te.write(D,Ae)?Q():ve=Q},ne._final=function(D){te.end(),z=D},te.on("drain",function(){if(ve){let D=ve;ve=null,D()}}),te.on("finish",function(){if(z){let D=z;z=null,D()}})),ae&&(b(j,D=>{ae=!1,D&&I(j,D),be(D)}),j.on("readable",function(){if(ge){let D=ge;ge=null,D()}}),j.on("end",function(){ne.push(null)}),ne._read=function(){for(;;){let D=j.read();if(D===null){ge=ne._read;return}if(!ne.push(D))return}}),ne._destroy=function(D,Ae){!D&&R!==null&&(D=new m),ge=null,ve=null,z=null,R===null?Ae(D):(R=Ae,I(te,D),I(j,D))},ne}}),It=me((s,f)=>{fe(),pe(),de();var{ObjectDefineProperties:o,ObjectGetOwnPropertyDescriptor:u,ObjectKeys:c,ObjectSetPrototypeOf:i}=ze();f.exports=t;var e=Nr(),r=Rn();i(t.prototype,e.prototype),i(t,e);{let p=c(r.prototype);for(let b=0;b<p.length;b++){let m=p[b];t.prototype[m]||(t.prototype[m]=r.prototype[m])}}function t(p){if(!(this instanceof t))return new t(p);e.call(this,p),r.call(this,p),p?(this.allowHalfOpen=p.allowHalfOpen!==!1,p.readable===!1&&(this._readableState.readable=!1,this._readableState.ended=!0,this._readableState.endEmitted=!0),p.writable===!1&&(this._writableState.writable=!1,this._writableState.ending=!0,this._writableState.ended=!0,this._writableState.finished=!0)):this.allowHalfOpen=!0}o(t.prototype,{writable:{__proto__:null,...u(r.prototype,"writable")},writableHighWaterMark:{__proto__:null,...u(r.prototype,"writableHighWaterMark")},writableObjectMode:{__proto__:null,...u(r.prototype,"writableObjectMode")},writableBuffer:{__proto__:null,...u(r.prototype,"writableBuffer")},writableLength:{__proto__:null,...u(r.prototype,"writableLength")},writableFinished:{__proto__:null,...u(r.prototype,"writableFinished")},writableCorked:{__proto__:null,...u(r.prototype,"writableCorked")},writableEnded:{__proto__:null,...u(r.prototype,"writableEnded")},writableNeedDrain:{__proto__:null,...u(r.prototype,"writableNeedDrain")},destroyed:{__proto__:null,get(){return this._readableState===void 0||this._writableState===void 0?!1:this._readableState.destroyed&&this._writableState.destroyed},set(p){this._readableState&&this._writableState&&(this._readableState.destroyed=p,this._writableState.destroyed=p)}}});var n;function l(){return n===void 0&&(n={}),n}t.fromWeb=function(p,b){return l().newStreamDuplexFromReadableWritablePair(p,b)},t.toWeb=function(p){return l().newReadableWritablePairFromDuplex(p)};var d;t.from=function(p){return d||(d=Ua()),d(p,"body")}}),Ho=me((s,f)=>{fe(),pe(),de();var{ObjectSetPrototypeOf:o,Symbol:u}=ze();f.exports=t;var{ERR_METHOD_NOT_IMPLEMENTED:c}=nt().codes,i=It(),{getHighWaterMark:e}=jr();o(t.prototype,i.prototype),o(t,i);var r=u("kCallback");function t(d){if(!(this instanceof t))return new t(d);let p=d?e(this,d,"readableHighWaterMark",!0):null;p===0&&(d={...d,highWaterMark:null,readableHighWaterMark:p,writableHighWaterMark:d.writableHighWaterMark||0}),i.call(this,d),this._readableState.sync=!1,this[r]=null,d&&(typeof d.transform=="function"&&(this._transform=d.transform),typeof d.flush=="function"&&(this._flush=d.flush)),this.on("prefinish",l)}function n(d){typeof this._flush=="function"&&!this.destroyed?this._flush((p,b)=>{if(p){d?d(p):this.destroy(p);return}b!=null&&this.push(b),this.push(null),d&&d()}):(this.push(null),d&&d())}function l(){this._final!==n&&n.call(this)}t.prototype._final=n,t.prototype._transform=function(d,p,b){throw new c("_transform()")},t.prototype._write=function(d,p,b){let m=this._readableState,w=this._writableState,E=m.length;this._transform(d,p,(I,y)=>{if(I){b(I);return}y!=null&&this.push(y),w.ended||E===m.length||m.length<m.highWaterMark?b():this[r]=b})},t.prototype._read=function(){if(this[r]){let d=this[r];this[r]=null,d()}}}),Vo=me((s,f)=>{fe(),pe(),de();var{ObjectSetPrototypeOf:o}=ze();f.exports=c;var u=Ho();o(c.prototype,u.prototype),o(c,u);function c(i){if(!(this instanceof c))return new c(i);u.call(this,i)}c.prototype._transform=function(i,e,r){r(null,i)}}),Bn=me((s,f)=>{fe(),pe(),de();var o=Jt(),{ArrayIsArray:u,Promise:c,SymbolAsyncIterator:i,SymbolDispose:e}=ze(),r=jt(),{once:t}=st(),n=ir(),l=It(),{aggregateTwoErrors:d,codes:{ERR_INVALID_ARG_TYPE:p,ERR_INVALID_RETURN_VALUE:b,ERR_MISSING_ARGS:m,ERR_STREAM_DESTROYED:w,ERR_STREAM_PREMATURE_CLOSE:E},AbortError:I}=nt(),{validateFunction:y,validateAbortSignal:_}=pr(),{isIterable:N,isReadable:B,isReadableNodeStream:A,isNodeStream:k,isTransformStream:M,isWebStream:J,isReadableStream:X,isReadableFinished:ue}=Tt(),C=globalThis.AbortController||dr().AbortController,q,K,j;function te(D,Ae,Q){let L=!1;D.on("close",()=>{L=!0});let Z=r(D,{readable:Ae,writable:Q},$=>{L=!$});return{destroy:$=>{L||(L=!0,n.destroyer(D,$||new w("pipe")))},cleanup:Z}}function ae(D){return y(D[D.length-1],"streams[stream.length - 1]"),D.pop()}function ie(D){if(N(D))return D;if(A(D))return ve(D);throw new p("val",["Readable","Iterable","AsyncIterable"],D)}async function*ve(D){K||(K=Nr()),yield*K.prototype[i].call(D)}async function z(D,Ae,Q,{end:L}){let Z,$=null,H=oe=>{if(oe&&(Z=oe),$){let x=$;$=null,x()}},V=()=>new c((oe,x)=>{Z?x(Z):$=()=>{Z?x(Z):oe()}});Ae.on("drain",H);let he=r(Ae,{readable:!1},H);try{Ae.writableNeedDrain&&await V();for await(let oe of D)Ae.write(oe)||await V();L&&(Ae.end(),await V()),Q()}catch(oe){Q(Z!==oe?d(Z,oe):oe)}finally{he(),Ae.off("drain",H)}}async function ge(D,Ae,Q,{end:L}){M(Ae)&&(Ae=Ae.writable);let Z=Ae.getWriter();try{for await(let $ of D)await Z.ready,Z.write($).catch(()=>{});await Z.ready,L&&await Z.close(),Q()}catch($){try{await Z.abort($),Q($)}catch(H){Q(H)}}}function R(...D){return ne(D,t(ae(D)))}function ne(D,Ae,Q){if(D.length===1&&u(D[0])&&(D=D[0]),D.length<2)throw new m("streams");let L=new C,Z=L.signal,$=Q==null?void 0:Q.signal,H=[];_($,"options.signal");function V(){re(new I)}j=j||st().addAbortListener;let he;$&&(he=j($,V));let oe,x,F=[],Y=0;function se(ye){re(ye,--Y===0)}function re(ye,ee){var Pe;if(ye&&(!oe||oe.code==="ERR_STREAM_PREMATURE_CLOSE")&&(oe=ye),!(!oe&&!ee)){for(;F.length;)F.shift()(oe);(Pe=he)===null||Pe===void 0||Pe[e](),L.abort(),ee&&(oe||H.forEach(a=>a()),o.nextTick(Ae,oe,x))}}let ce;for(let ye=0;ye<D.length;ye++){let ee=D[ye],Pe=ye<D.length-1,a=ye>0,h=Pe||(Q==null?void 0:Q.end)!==!1,g=ye===D.length-1;if(k(ee)){let v=function(T){T&&T.name!=="AbortError"&&T.code!=="ERR_STREAM_PREMATURE_CLOSE"&&se(T)};if(h){let{destroy:T,cleanup:U}=te(ee,Pe,a);F.push(T),B(ee)&&g&&H.push(U)}ee.on("error",v),B(ee)&&g&&H.push(()=>{ee.removeListener("error",v)})}if(ye===0)if(typeof ee=="function"){if(ce=ee({signal:Z}),!N(ce))throw new b("Iterable, AsyncIterable or Stream","source",ce)}else N(ee)||A(ee)||M(ee)?ce=ee:ce=l.from(ee);else if(typeof ee=="function"){if(M(ce)){var W;ce=ie((W=ce)===null||W===void 0?void 0:W.readable)}else ce=ie(ce);if(ce=ee(ce,{signal:Z}),Pe){if(!N(ce,!0))throw new b("AsyncIterable",`transform[${ye-1}]`,ce)}else{var le;q||(q=Vo());let v=new q({objectMode:!0}),T=(le=ce)===null||le===void 0?void 0:le.then;if(typeof T=="function")Y++,T.call(ce,_e=>{x=_e,_e!=null&&v.write(_e),h&&v.end(),o.nextTick(se)},_e=>{v.destroy(_e),o.nextTick(se,_e)});else if(N(ce,!0))Y++,z(ce,v,se,{end:h});else if(X(ce)||M(ce)){let _e=ce.readable||ce;Y++,z(_e,v,se,{end:h})}else throw new b("AsyncIterable or Promise","destination",ce);ce=v;let{destroy:U,cleanup:G}=te(ce,!1,!0);F.push(U),g&&H.push(G)}}else if(k(ee)){if(A(ce)){Y+=2;let v=be(ce,ee,se,{end:h});B(ee)&&g&&H.push(v)}else if(M(ce)||X(ce)){let v=ce.readable||ce;Y++,z(v,ee,se,{end:h})}else if(N(ce))Y++,z(ce,ee,se,{end:h});else throw new p("val",["Readable","Iterable","AsyncIterable","ReadableStream","TransformStream"],ce);ce=ee}else if(J(ee)){if(A(ce))Y++,ge(ie(ce),ee,se,{end:h});else if(X(ce)||N(ce))Y++,ge(ce,ee,se,{end:h});else if(M(ce))Y++,ge(ce.readable,ee,se,{end:h});else throw new p("val",["Readable","Iterable","AsyncIterable","ReadableStream","TransformStream"],ce);ce=ee}else ce=l.from(ee)}return(Z!=null&&Z.aborted||$!=null&&$.aborted)&&o.nextTick(V),ce}function be(D,Ae,Q,{end:L}){let Z=!1;if(Ae.on("close",()=>{Z||Q(new E)}),D.pipe(Ae,{end:!1}),L){let $=function(){Z=!0,Ae.end()};ue(D)?o.nextTick($):D.once("end",$)}else Q();return r(D,{readable:!0,writable:!1},$=>{let H=D._readableState;$&&$.code==="ERR_STREAM_PREMATURE_CLOSE"&&H&&H.ended&&!H.errored&&!H.errorEmitted?D.once("end",Q).once("error",Q):Q($)}),r(Ae,{readable:!1,writable:!0},Q)}f.exports={pipelineImpl:ne,pipeline:R}}),zo=me((s,f)=>{fe(),pe(),de();var{pipeline:o}=Bn(),u=It(),{destroyer:c}=ir(),{isNodeStream:i,isReadable:e,isWritable:r,isWebStream:t,isTransformStream:n,isWritableStream:l,isReadableStream:d}=Tt(),{AbortError:p,codes:{ERR_INVALID_ARG_VALUE:b,ERR_MISSING_ARGS:m}}=nt(),w=jt();f.exports=function(...E){if(E.length===0)throw new m("streams");if(E.length===1)return u.from(E[0]);let I=[...E];if(typeof E[0]=="function"&&(E[0]=u.from(E[0])),typeof E[E.length-1]=="function"){let C=E.length-1;E[C]=u.from(E[C])}for(let C=0;C<E.length;++C)if(!(!i(E[C])&&!t(E[C]))){if(C<E.length-1&&!(e(E[C])||d(E[C])||n(E[C])))throw new b(`streams[${C}]`,I[C],"must be readable");if(C>0&&!(r(E[C])||l(E[C])||n(E[C])))throw new b(`streams[${C}]`,I[C],"must be writable")}let y,_,N,B,A;function k(C){let q=B;B=null,q?q(C):C?A.destroy(C):!ue&&!X&&A.destroy()}let M=E[0],J=o(E,k),X=!!(r(M)||l(M)||n(M)),ue=!!(e(J)||d(J)||n(J));if(A=new u({writableObjectMode:!!(M!=null&&M.writableObjectMode),readableObjectMode:!!(J!=null&&J.readableObjectMode),writable:X,readable:ue}),X){if(i(M))A._write=function(q,K,j){M.write(q,K)?j():y=j},A._final=function(q){M.end(),_=q},M.on("drain",function(){if(y){let q=y;y=null,q()}});else if(t(M)){let q=(n(M)?M.writable:M).getWriter();A._write=async function(K,j,te){try{await q.ready,q.write(K).catch(()=>{}),te()}catch(ae){te(ae)}},A._final=async function(K){try{await q.ready,q.close().catch(()=>{}),_=K}catch(j){K(j)}}}let C=n(J)?J.readable:J;w(C,()=>{if(_){let q=_;_=null,q()}})}if(ue){if(i(J))J.on("readable",function(){if(N){let C=N;N=null,C()}}),J.on("end",function(){A.push(null)}),A._read=function(){for(;;){let C=J.read();if(C===null){N=A._read;return}if(!A.push(C))return}};else if(t(J)){let C=(n(J)?J.readable:J).getReader();A._read=async function(){for(;;)try{let{value:q,done:K}=await C.read();if(!A.push(q))return;if(K){A.push(null);return}}catch{return}}}}return A._destroy=function(C,q){!C&&B!==null&&(C=new p),N=null,y=null,_=null,B===null?q(C):(B=q,i(J)&&c(J,C))},A}}),ja=me((s,f)=>{fe(),pe(),de();var o=globalThis.AbortController||dr().AbortController,{codes:{ERR_INVALID_ARG_VALUE:u,ERR_INVALID_ARG_TYPE:c,ERR_MISSING_ARGS:i,ERR_OUT_OF_RANGE:e},AbortError:r}=nt(),{validateAbortSignal:t,validateInteger:n,validateObject:l}=pr(),d=ze().Symbol("kWeak"),p=ze().Symbol("kResistStopPropagation"),{finished:b}=jt(),m=zo(),{addAbortSignalNoValidate:w}=Ur(),{isWritable:E,isNodeStream:I}=Tt(),{deprecate:y}=st(),{ArrayPrototypePush:_,Boolean:N,MathFloor:B,Number:A,NumberIsNaN:k,Promise:M,PromiseReject:J,PromiseResolve:X,PromisePrototypeThen:ue,Symbol:C}=ze(),q=C("kEmpty"),K=C("kEof");function j($,H){if(H!=null&&l(H,"options"),(H==null?void 0:H.signal)!=null&&t(H.signal,"options.signal"),I($)&&!E($))throw new u("stream",$,"must be writable");let V=m(this,$);return H!=null&&H.signal&&w(H.signal,V),V}function te($,H){if(typeof $!="function")throw new c("fn",["Function","AsyncFunction"],$);H!=null&&l(H,"options"),(H==null?void 0:H.signal)!=null&&t(H.signal,"options.signal");let V=1;(H==null?void 0:H.concurrency)!=null&&(V=B(H.concurrency));let he=V-1;return(H==null?void 0:H.highWaterMark)!=null&&(he=B(H.highWaterMark)),n(V,"options.concurrency",1),n(he,"options.highWaterMark",0),he+=V,(async function*(){let oe=st().AbortSignalAny([H==null?void 0:H.signal].filter(N)),x=this,F=[],Y={signal:oe},se,re,ce=!1,W=0;function le(){ce=!0,ye()}function ye(){W-=1,ee()}function ee(){re&&!ce&&W<V&&F.length<he&&(re(),re=null)}async function Pe(){try{for await(let a of x){if(ce)return;if(oe.aborted)throw new r;try{if(a=$(a,Y),a===q)continue;a=X(a)}catch(h){a=J(h)}W+=1,ue(a,ye,le),F.push(a),se&&(se(),se=null),!ce&&(F.length>=he||W>=V)&&await new M(h=>{re=h})}F.push(K)}catch(a){let h=J(a);ue(h,ye,le),F.push(h)}finally{ce=!0,se&&(se(),se=null)}}Pe();try{for(;;){for(;F.length>0;){let a=await F[0];if(a===K)return;if(oe.aborted)throw new r;a!==q&&(yield a),F.shift(),ee()}await new M(a=>{se=a})}}finally{ce=!0,re&&(re(),re=null)}}).call(this)}function ae($=void 0){return $!=null&&l($,"options"),($==null?void 0:$.signal)!=null&&t($.signal,"options.signal"),(async function*(){let H=0;for await(let he of this){var V;if($!=null&&(V=$.signal)!==null&&V!==void 0&&V.aborted)throw new r({cause:$.signal.reason});yield[H++,he]}}).call(this)}async function ie($,H=void 0){for await(let V of R.call(this,$,H))return!0;return!1}async function ve($,H=void 0){if(typeof $!="function")throw new c("fn",["Function","AsyncFunction"],$);return!await ie.call(this,async(...V)=>!await $(...V),H)}async function z($,H){for await(let V of R.call(this,$,H))return V}async function ge($,H){if(typeof $!="function")throw new c("fn",["Function","AsyncFunction"],$);async function V(he,oe){return await $(he,oe),q}for await(let he of te.call(this,V,H));}function R($,H){if(typeof $!="function")throw new c("fn",["Function","AsyncFunction"],$);async function V(he,oe){return await $(he,oe)?he:q}return te.call(this,V,H)}var ne=class extends i{constructor(){super("reduce"),this.message="Reduce of an empty stream requires an initial value"}};async function be($,H,V){var he;if(typeof $!="function")throw new c("reducer",["Function","AsyncFunction"],$);V!=null&&l(V,"options"),(V==null?void 0:V.signal)!=null&&t(V.signal,"options.signal");let oe=arguments.length>1;if(V!=null&&(he=V.signal)!==null&&he!==void 0&&he.aborted){let re=new r(void 0,{cause:V.signal.reason});throw this.once("error",()=>{}),await b(this.destroy(re)),re}let x=new o,F=x.signal;if(V!=null&&V.signal){let re={once:!0,[d]:this,[p]:!0};V.signal.addEventListener("abort",()=>x.abort(),re)}let Y=!1;try{for await(let re of this){var se;if(Y=!0,V!=null&&(se=V.signal)!==null&&se!==void 0&&se.aborted)throw new r;oe?H=await $(H,re,{signal:F}):(H=re,oe=!0)}if(!Y&&!oe)throw new ne}finally{x.abort()}return H}async function D($){$!=null&&l($,"options"),($==null?void 0:$.signal)!=null&&t($.signal,"options.signal");let H=[];for await(let he of this){var V;if($!=null&&(V=$.signal)!==null&&V!==void 0&&V.aborted)throw new r(void 0,{cause:$.signal.reason});_(H,he)}return H}function Ae($,H){let V=te.call(this,$,H);return(async function*(){for await(let he of V)yield*he}).call(this)}function Q($){if($=A($),k($))return 0;if($<0)throw new e("number",">= 0",$);return $}function L($,H=void 0){return H!=null&&l(H,"options"),(H==null?void 0:H.signal)!=null&&t(H.signal,"options.signal"),$=Q($),(async function*(){var V;if(H!=null&&(V=H.signal)!==null&&V!==void 0&&V.aborted)throw new r;for await(let oe of this){var he;if(H!=null&&(he=H.signal)!==null&&he!==void 0&&he.aborted)throw new r;$--<=0&&(yield oe)}}).call(this)}function Z($,H=void 0){return H!=null&&l(H,"options"),(H==null?void 0:H.signal)!=null&&t(H.signal,"options.signal"),$=Q($),(async function*(){var V;if(H!=null&&(V=H.signal)!==null&&V!==void 0&&V.aborted)throw new r;for await(let oe of this){var he;if(H!=null&&(he=H.signal)!==null&&he!==void 0&&he.aborted)throw new r;if($-- >0&&(yield oe),$<=0)return}}).call(this)}f.exports.streamReturningOperators={asIndexedPairs:y(ae,"readable.asIndexedPairs will be removed in a future version."),drop:L,filter:R,flatMap:Ae,map:te,take:Z,compose:j},f.exports.promiseReturningOperators={every:ve,forEach:ge,reduce:be,toArray:D,some:ie,find:z}}),Qo=me((s,f)=>{fe(),pe(),de();var{ArrayPrototypePop:o,Promise:u}=ze(),{isIterable:c,isNodeStream:i,isWebStream:e}=Tt(),{pipelineImpl:r}=Bn(),{finished:t}=jt();Ko();function n(...l){return new u((d,p)=>{let b,m,w=l[l.length-1];if(w&&typeof w=="object"&&!i(w)&&!c(w)&&!e(w)){let E=o(l);b=E.signal,m=E.end}r(l,(E,I)=>{E?p(E):d(I)},{signal:b,end:m})})}f.exports={finished:t,pipeline:n}}),Ko=me((s,f)=>{fe(),pe(),de();var{Buffer:o}=(Je(),Ne(Ye)),{ObjectDefineProperty:u,ObjectKeys:c,ReflectApply:i}=ze(),{promisify:{custom:e}}=st(),{streamReturningOperators:r,promiseReturningOperators:t}=ja(),{codes:{ERR_ILLEGAL_CONSTRUCTOR:n}}=nt(),l=zo(),{setDefaultHighWaterMark:d,getDefaultHighWaterMark:p}=jr(),{pipeline:b}=Bn(),{destroyer:m}=ir(),w=jt(),E=Qo(),I=Tt(),y=f.exports=Cn().Stream;y.isDestroyed=I.isDestroyed,y.isDisturbed=I.isDisturbed,y.isErrored=I.isErrored,y.isReadable=I.isReadable,y.isWritable=I.isWritable,y.Readable=Nr();for(let N of c(r)){let B=function(...k){if(new.target)throw n();return y.Readable.from(i(A,this,k))},A=r[N];u(B,"name",{__proto__:null,value:A.name}),u(B,"length",{__proto__:null,value:A.length}),u(y.Readable.prototype,N,{__proto__:null,value:B,enumerable:!1,configurable:!0,writable:!0})}for(let N of c(t)){let B=function(...k){if(new.target)throw n();return i(A,this,k)},A=t[N];u(B,"name",{__proto__:null,value:A.name}),u(B,"length",{__proto__:null,value:A.length}),u(y.Readable.prototype,N,{__proto__:null,value:B,enumerable:!1,configurable:!0,writable:!0})}y.Writable=Rn(),y.Duplex=It(),y.Transform=Ho(),y.PassThrough=Vo(),y.pipeline=b;var{addAbortSignal:_}=Ur();y.addAbortSignal=_,y.finished=w,y.destroy=m,y.compose=l,y.setDefaultHighWaterMark=d,y.getDefaultHighWaterMark=p,u(y,"promises",{__proto__:null,configurable:!0,enumerable:!0,get(){return E}}),u(b,e,{__proto__:null,enumerable:!0,get(){return E.pipeline}}),u(w,e,{__proto__:null,enumerable:!0,get(){return E.finished}}),y.Stream=y,y._isUint8Array=function(N){return N instanceof Uint8Array},y._uint8ArrayToBuffer=function(N){return o.from(N.buffer,N.byteOffset,N.byteLength)}}),Xt=me((s,f)=>{fe(),pe(),de();var o=Ko(),u=Qo(),c=o.Readable.destroy;f.exports=o.Readable,f.exports._uint8ArrayToBuffer=o._uint8ArrayToBuffer,f.exports._isUint8Array=o._isUint8Array,f.exports.isDisturbed=o.isDisturbed,f.exports.isErrored=o.isErrored,f.exports.isReadable=o.isReadable,f.exports.Readable=o.Readable,f.exports.Writable=o.Writable,f.exports.Duplex=o.Duplex,f.exports.Transform=o.Transform,f.exports.PassThrough=o.PassThrough,f.exports.addAbortSignal=o.addAbortSignal,f.exports.finished=o.finished,f.exports.destroy=o.destroy,f.exports.destroy=c,f.exports.pipeline=o.pipeline,f.exports.compose=o.compose,Object.defineProperty(o,"promises",{configurable:!0,enumerable:!0,get(){return u}}),f.exports.Stream=o.Stream,f.exports.default=f.exports}),Na=me((s,f)=>{fe(),pe(),de(),typeof Object.create=="function"?f.exports=function(o,u){u&&(o.super_=u,o.prototype=Object.create(u.prototype,{constructor:{value:o,enumerable:!1,writable:!0,configurable:!0}}))}:f.exports=function(o,u){if(u){o.super_=u;var c=function(){};c.prototype=u.prototype,o.prototype=new c,o.prototype.constructor=o}}}),Da=me((s,f)=>{fe(),pe(),de();var{Buffer:o}=(Je(),Ne(Ye)),u=Symbol.for("BufferList");function c(i){if(!(this instanceof c))return new c(i);c._init.call(this,i)}c._init=function(i){Object.defineProperty(this,u,{value:!0}),this._bufs=[],this.length=0,i&&this.append(i)},c.prototype._new=function(i){return new c(i)},c.prototype._offset=function(i){if(i===0)return[0,0];let e=0;for(let r=0;r<this._bufs.length;r++){let t=e+this._bufs[r].length;if(i<t||r===this._bufs.length-1)return[r,i-e];e=t}},c.prototype._reverseOffset=function(i){let e=i[0],r=i[1];for(let t=0;t<e;t++)r+=this._bufs[t].length;return r},c.prototype.get=function(i){if(i>this.length||i<0)return;let e=this._offset(i);return this._bufs[e[0]][e[1]]},c.prototype.slice=function(i,e){return typeof i=="number"&&i<0&&(i+=this.length),typeof e=="number"&&e<0&&(e+=this.length),this.copy(null,0,i,e)},c.prototype.copy=function(i,e,r,t){if((typeof r!="number"||r<0)&&(r=0),(typeof t!="number"||t>this.length)&&(t=this.length),r>=this.length||t<=0)return i||o.alloc(0);let n=!!i,l=this._offset(r),d=t-r,p=d,b=n&&e||0,m=l[1];if(r===0&&t===this.length){if(!n)return this._bufs.length===1?this._bufs[0]:o.concat(this._bufs,this.length);for(let w=0;w<this._bufs.length;w++)this._bufs[w].copy(i,b),b+=this._bufs[w].length;return i}if(p<=this._bufs[l[0]].length-m)return n?this._bufs[l[0]].copy(i,e,m,m+p):this._bufs[l[0]].slice(m,m+p);n||(i=o.allocUnsafe(d));for(let w=l[0];w<this._bufs.length;w++){let E=this._bufs[w].length-m;if(p>E)this._bufs[w].copy(i,b,m),b+=E;else{this._bufs[w].copy(i,b,m,m+p),b+=E;break}p-=E,m&&(m=0)}return i.length>b?i.slice(0,b):i},c.prototype.shallowSlice=function(i,e){if(i=i||0,e=typeof e!="number"?this.length:e,i<0&&(i+=this.length),e<0&&(e+=this.length),i===e)return this._new();let r=this._offset(i),t=this._offset(e),n=this._bufs.slice(r[0],t[0]+1);return t[1]===0?n.pop():n[n.length-1]=n[n.length-1].slice(0,t[1]),r[1]!==0&&(n[0]=n[0].slice(r[1])),this._new(n)},c.prototype.toString=function(i,e,r){return this.slice(e,r).toString(i)},c.prototype.consume=function(i){if(i=Math.trunc(i),Number.isNaN(i)||i<=0)return this;for(;this._bufs.length;)if(i>=this._bufs[0].length)i-=this._bufs[0].length,this.length-=this._bufs[0].length,this._bufs.shift();else{this._bufs[0]=this._bufs[0].slice(i),this.length-=i;break}return this},c.prototype.duplicate=function(){let i=this._new();for(let e=0;e<this._bufs.length;e++)i.append(this._bufs[e]);return i},c.prototype.append=function(i){if(i==null)return this;if(i.buffer)this._appendBuffer(o.from(i.buffer,i.byteOffset,i.byteLength));else if(Array.isArray(i))for(let e=0;e<i.length;e++)this.append(i[e]);else if(this._isBufferList(i))for(let e=0;e<i._bufs.length;e++)this.append(i._bufs[e]);else typeof i=="number"&&(i=i.toString()),this._appendBuffer(o.from(i));return this},c.prototype._appendBuffer=function(i){this._bufs.push(i),this.length+=i.length},c.prototype.indexOf=function(i,e,r){if(r===void 0&&typeof e=="string"&&(r=e,e=void 0),typeof i=="function"||Array.isArray(i))throw new TypeError('The "value" argument must be one of type string, Buffer, BufferList, or Uint8Array.');if(typeof i=="number"?i=o.from([i]):typeof i=="string"?i=o.from(i,r):this._isBufferList(i)?i=i.slice():Array.isArray(i.buffer)?i=o.from(i.buffer,i.byteOffset,i.byteLength):o.isBuffer(i)||(i=o.from(i)),e=Number(e||0),isNaN(e)&&(e=0),e<0&&(e=this.length+e),e<0&&(e=0),i.length===0)return e>this.length?this.length:e;let t=this._offset(e),n=t[0],l=t[1];for(;n<this._bufs.length;n++){let d=this._bufs[n];for(;l<d.length;)if(d.length-l>=i.length){let p=d.indexOf(i,l);if(p!==-1)return this._reverseOffset([n,p]);l=d.length-i.length+1}else{let p=this._reverseOffset([n,l]);if(this._match(p,i))return p;l++}l=0}return-1},c.prototype._match=function(i,e){if(this.length-i<e.length)return!1;for(let r=0;r<e.length;r++)if(this.get(i+r)!==e[r])return!1;return!0},function(){let i={readDoubleBE:8,readDoubleLE:8,readFloatBE:4,readFloatLE:4,readBigInt64BE:8,readBigInt64LE:8,readBigUInt64BE:8,readBigUInt64LE:8,readInt32BE:4,readInt32LE:4,readUInt32BE:4,readUInt32LE:4,readInt16BE:2,readInt16LE:2,readUInt16BE:2,readUInt16LE:2,readInt8:1,readUInt8:1,readIntBE:null,readIntLE:null,readUIntBE:null,readUIntLE:null};for(let e in i)(function(r){i[r]===null?c.prototype[r]=function(t,n){return this.slice(t,t+n)[r](0,n)}:c.prototype[r]=function(t=0){return this.slice(t,t+i[r])[r](0)}})(e)}(),c.prototype._isBufferList=function(i){return i instanceof c||c.isBufferList(i)},c.isBufferList=function(i){return i!=null&&i[u]},f.exports=c}),Fa=me((s,f)=>{fe(),pe(),de();var o=Xt().Duplex,u=Na(),c=Da();function i(e){if(!(this instanceof i))return new i(e);if(typeof e=="function"){this._callback=e;let r=(function(t){this._callback&&(this._callback(t),this._callback=null)}).bind(this);this.on("pipe",function(t){t.on("error",r)}),this.on("unpipe",function(t){t.removeListener("error",r)}),e=null}c._init.call(this,e),o.call(this)}u(i,o),Object.assign(i.prototype,c.prototype),i.prototype._new=function(e){return new i(e)},i.prototype._write=function(e,r,t){this._appendBuffer(e),typeof t=="function"&&t()},i.prototype._read=function(e){if(!this.length)return this.push(null);e=Math.min(e,this.length),this.push(this.slice(0,e)),this.consume(e)},i.prototype.end=function(e){o.prototype.end.call(this,e),this._callback&&(this._callback(null,this.slice()),this._callback=null)},i.prototype._destroy=function(e,r){this._bufs.length=0,this.length=0,r(e)},i.prototype._isBufferList=function(e){return e instanceof i||e instanceof c||i.isBufferList(e)},i.isBufferList=c.isBufferList,f.exports=i,f.exports.BufferListStream=i,f.exports.BufferList=c}),Wa=me((s,f)=>{fe(),pe(),de();var o=class{constructor(){this.cmd=null,this.retain=!1,this.qos=0,this.dup=!1,this.length=-1,this.topic=null,this.payload=null}};f.exports=o}),Go=me((s,f)=>{fe(),pe(),de();var o=f.exports,{Buffer:u}=(Je(),Ne(Ye));o.types={0:"reserved",1:"connect",2:"connack",3:"publish",4:"puback",5:"pubrec",6:"pubrel",7:"pubcomp",8:"subscribe",9:"suback",10:"unsubscribe",11:"unsuback",12:"pingreq",13:"pingresp",14:"disconnect",15:"auth"},o.requiredHeaderFlags={1:0,2:0,4:0,5:0,6:2,7:0,8:2,9:0,10:2,11:0,12:0,13:0,14:0,15:0},o.requiredHeaderFlagsErrors={};for(let i in o.requiredHeaderFlags){let e=o.requiredHeaderFlags[i];o.requiredHeaderFlagsErrors[i]="Invalid header flag bits, must be 0x"+e.toString(16)+" for "+o.types[i]+" packet"}o.codes={};for(let i in o.types){let e=o.types[i];o.codes[e]=i}o.CMD_SHIFT=4,o.CMD_MASK=240,o.DUP_MASK=8,o.QOS_MASK=3,o.QOS_SHIFT=1,o.RETAIN_MASK=1,o.VARBYTEINT_MASK=127,o.VARBYTEINT_FIN_MASK=128,o.VARBYTEINT_MAX=268435455,o.SESSIONPRESENT_MASK=1,o.SESSIONPRESENT_HEADER=u.from([o.SESSIONPRESENT_MASK]),o.CONNACK_HEADER=u.from([o.codes.connack<<o.CMD_SHIFT]),o.USERNAME_MASK=128,o.PASSWORD_MASK=64,o.WILL_RETAIN_MASK=32,o.WILL_QOS_MASK=24,o.WILL_QOS_SHIFT=3,o.WILL_FLAG_MASK=4,o.CLEAN_SESSION_MASK=2,o.CONNECT_HEADER=u.from([o.codes.connect<<o.CMD_SHIFT]),o.properties={sessionExpiryInterval:17,willDelayInterval:24,receiveMaximum:33,maximumPacketSize:39,topicAliasMaximum:34,requestResponseInformation:25,requestProblemInformation:23,userProperties:38,authenticationMethod:21,authenticationData:22,payloadFormatIndicator:1,messageExpiryInterval:2,contentType:3,responseTopic:8,correlationData:9,maximumQoS:36,retainAvailable:37,assignedClientIdentifier:18,reasonString:31,wildcardSubscriptionAvailable:40,subscriptionIdentifiersAvailable:41,sharedSubscriptionAvailable:42,serverKeepAlive:19,responseInformation:26,serverReference:28,topicAlias:35,subscriptionIdentifier:11},o.propertiesCodes={};for(let i in o.properties){let e=o.properties[i];o.propertiesCodes[e]=i}o.propertiesTypes={sessionExpiryInterval:"int32",willDelayInterval:"int32",receiveMaximum:"int16",maximumPacketSize:"int32",topicAliasMaximum:"int16",requestResponseInformation:"byte",requestProblemInformation:"byte",userProperties:"pair",authenticationMethod:"string",authenticationData:"binary",payloadFormatIndicator:"byte",messageExpiryInterval:"int32",contentType:"string",responseTopic:"string",correlationData:"binary",maximumQoS:"int8",retainAvailable:"byte",assignedClientIdentifier:"string",reasonString:"string",wildcardSubscriptionAvailable:"byte",subscriptionIdentifiersAvailable:"byte",sharedSubscriptionAvailable:"byte",serverKeepAlive:"int16",responseInformation:"string",serverReference:"string",topicAlias:"int16",subscriptionIdentifier:"var"};function c(i){return[0,1,2].map(e=>[0,1].map(r=>[0,1].map(t=>{let n=u.alloc(1);return n.writeUInt8(o.codes[i]<<o.CMD_SHIFT|(r?o.DUP_MASK:0)|e<<o.QOS_SHIFT|t,0,!0),n})))}o.PUBLISH_HEADER=c("publish"),o.SUBSCRIBE_HEADER=c("subscribe"),o.SUBSCRIBE_OPTIONS_QOS_MASK=3,o.SUBSCRIBE_OPTIONS_NL_MASK=1,o.SUBSCRIBE_OPTIONS_NL_SHIFT=2,o.SUBSCRIBE_OPTIONS_RAP_MASK=1,o.SUBSCRIBE_OPTIONS_RAP_SHIFT=3,o.SUBSCRIBE_OPTIONS_RH_MASK=3,o.SUBSCRIBE_OPTIONS_RH_SHIFT=4,o.SUBSCRIBE_OPTIONS_RH=[0,16,32],o.SUBSCRIBE_OPTIONS_NL=4,o.SUBSCRIBE_OPTIONS_RAP=8,o.SUBSCRIBE_OPTIONS_QOS=[0,1,2],o.UNSUBSCRIBE_HEADER=c("unsubscribe"),o.ACKS={unsuback:c("unsuback"),puback:c("puback"),pubcomp:c("pubcomp"),pubrel:c("pubrel"),pubrec:c("pubrec")},o.SUBACK_HEADER=u.from([o.codes.suback<<o.CMD_SHIFT]),o.VERSION3=u.from([3]),o.VERSION4=u.from([4]),o.VERSION5=u.from([5]),o.VERSION131=u.from([131]),o.VERSION132=u.from([132]),o.QOS=[0,1,2].map(i=>u.from([i])),o.EMPTY={pingreq:u.from([o.codes.pingreq<<4,0]),pingresp:u.from([o.codes.pingresp<<4,0]),disconnect:u.from([o.codes.disconnect<<4,0])},o.MQTT5_PUBACK_PUBREC_CODES={0:"Success",16:"No matching subscribers",128:"Unspecified error",131:"Implementation specific error",135:"Not authorized",144:"Topic Name invalid",145:"Packet identifier in use",151:"Quota exceeded",153:"Payload format invalid"},o.MQTT5_PUBREL_PUBCOMP_CODES={0:"Success",146:"Packet Identifier not found"},o.MQTT5_SUBACK_CODES={0:"Granted QoS 0",1:"Granted QoS 1",2:"Granted QoS 2",128:"Unspecified error",131:"Implementation specific error",135:"Not authorized",143:"Topic Filter invalid",145:"Packet Identifier in use",151:"Quota exceeded",158:"Shared Subscriptions not supported",161:"Subscription Identifiers not supported",162:"Wildcard Subscriptions not supported"},o.MQTT5_UNSUBACK_CODES={0:"Success",17:"No subscription existed",128:"Unspecified error",131:"Implementation specific error",135:"Not authorized",143:"Topic Filter invalid",145:"Packet Identifier in use"},o.MQTT5_DISCONNECT_CODES={0:"Normal disconnection",4:"Disconnect with Will Message",128:"Unspecified error",129:"Malformed Packet",130:"Protocol Error",131:"Implementation specific error",135:"Not authorized",137:"Server busy",139:"Server shutting down",141:"Keep Alive timeout",142:"Session taken over",143:"Topic Filter invalid",144:"Topic Name invalid",147:"Receive Maximum exceeded",148:"Topic Alias invalid",149:"Packet too large",150:"Message rate too high",151:"Quota exceeded",152:"Administrative action",153:"Payload format invalid",154:"Retain not supported",155:"QoS not supported",156:"Use another server",157:"Server moved",158:"Shared Subscriptions not supported",159:"Connection rate exceeded",160:"Maximum connect time",161:"Subscription Identifiers not supported",162:"Wildcard Subscriptions not supported"},o.MQTT5_AUTH_CODES={0:"Success",24:"Continue authentication",25:"Re-authenticate"}}),$a=me((s,f)=>{fe(),pe(),de();var o=1e3,u=o*60,c=u*60,i=c*24,e=i*7,r=i*365.25;f.exports=function(p,b){b=b||{};var m=typeof p;if(m==="string"&&p.length>0)return t(p);if(m==="number"&&isFinite(p))return b.long?l(p):n(p);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(p))};function t(p){if(p=String(p),!(p.length>100)){var b=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(p);if(b){var m=parseFloat(b[1]),w=(b[2]||"ms").toLowerCase();switch(w){case"years":case"year":case"yrs":case"yr":case"y":return m*r;case"weeks":case"week":case"w":return m*e;case"days":case"day":case"d":return m*i;case"hours":case"hour":case"hrs":case"hr":case"h":return m*c;case"minutes":case"minute":case"mins":case"min":case"m":return m*u;case"seconds":case"second":case"secs":case"sec":case"s":return m*o;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return m;default:return}}}}function n(p){var b=Math.abs(p);return b>=i?Math.round(p/i)+"d":b>=c?Math.round(p/c)+"h":b>=u?Math.round(p/u)+"m":b>=o?Math.round(p/o)+"s":p+"ms"}function l(p){var b=Math.abs(p);return b>=i?d(p,b,i,"day"):b>=c?d(p,b,c,"hour"):b>=u?d(p,b,u,"minute"):b>=o?d(p,b,o,"second"):p+" ms"}function d(p,b,m,w){var E=b>=m*1.5;return Math.round(p/m)+" "+w+(E?"s":"")}}),qa=me((s,f)=>{fe(),pe(),de();function o(u){i.debug=i,i.default=i,i.coerce=d,i.disable=n,i.enable=r,i.enabled=l,i.humanize=$a(),i.destroy=p,Object.keys(u).forEach(b=>{i[b]=u[b]}),i.names=[],i.skips=[],i.formatters={};function c(b){let m=0;for(let w=0;w<b.length;w++)m=(m<<5)-m+b.charCodeAt(w),m|=0;return i.colors[Math.abs(m)%i.colors.length]}i.selectColor=c;function i(b){let m,w=null,E,I;function y(..._){if(!y.enabled)return;let N=y,B=Number(new Date),A=B-(m||B);N.diff=A,N.prev=m,N.curr=B,m=B,_[0]=i.coerce(_[0]),typeof _[0]!="string"&&_.unshift("%O");let k=0;_[0]=_[0].replace(/%([a-zA-Z%])/g,(M,J)=>{if(M==="%%")return"%";k++;let X=i.formatters[J];if(typeof X=="function"){let ue=_[k];M=X.call(N,ue),_.splice(k,1),k--}return M}),i.formatArgs.call(N,_),(N.log||i.log).apply(N,_)}return y.namespace=b,y.useColors=i.useColors(),y.color=i.selectColor(b),y.extend=e,y.destroy=i.destroy,Object.defineProperty(y,"enabled",{enumerable:!0,configurable:!1,get:()=>w!==null?w:(E!==i.namespaces&&(E=i.namespaces,I=i.enabled(b)),I),set:_=>{w=_}}),typeof i.init=="function"&&i.init(y),y}function e(b,m){let w=i(this.namespace+(typeof m>"u"?":":m)+b);return w.log=this.log,w}function r(b){i.save(b),i.namespaces=b,i.names=[],i.skips=[];let m=(typeof b=="string"?b:"").trim().replace(" ",",").split(",").filter(Boolean);for(let w of m)w[0]==="-"?i.skips.push(w.slice(1)):i.names.push(w)}function t(b,m){let w=0,E=0,I=-1,y=0;for(;w<b.length;)if(E<m.length&&(m[E]===b[w]||m[E]==="*"))m[E]==="*"?(I=E,y=w,E++):(w++,E++);else if(I!==-1)E=I+1,y++,w=y;else return!1;for(;E<m.length&&m[E]==="*";)E++;return E===m.length}function n(){let b=[...i.names,...i.skips.map(m=>"-"+m)].join(",");return i.enable(""),b}function l(b){for(let m of i.skips)if(t(b,m))return!1;for(let m of i.names)if(t(b,m))return!0;return!1}function d(b){return b instanceof Error?b.stack||b.message:b}function p(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}return i.enable(i.load()),i}f.exports=o}),kt=me((s,f)=>{fe(),pe(),de(),s.formatArgs=u,s.save=c,s.load=i,s.useColors=o,s.storage=e(),s.destroy=(()=>{let t=!1;return()=>{t||(t=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),s.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function o(){if(typeof window<"u"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs))return!0;if(typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;let t;return typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&(t=navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/))&&parseInt(t[1],10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function u(t){if(t[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+t[0]+(this.useColors?"%c ":" ")+"+"+f.exports.humanize(this.diff),!this.useColors)return;let n="color: "+this.color;t.splice(1,0,n,"color: inherit");let l=0,d=0;t[0].replace(/%[a-zA-Z%]/g,p=>{p!=="%%"&&(l++,p==="%c"&&(d=l))}),t.splice(d,0,n)}s.log=console.debug||console.log||(()=>{});function c(t){try{t?s.storage.setItem("debug",t):s.storage.removeItem("debug")}catch{}}function i(){let t;try{t=s.storage.getItem("debug")}catch{}return!t&&typeof Me<"u"&&"env"in Me&&(t=Me.env.DEBUG),t}function e(){try{return localStorage}catch{}}f.exports=qa()(s);var{formatters:r}=f.exports;r.j=function(t){try{return JSON.stringify(t)}catch(n){return"[UnexpectedJSONParseError]: "+n.message}}}),Ha=me((s,f)=>{fe(),pe(),de();var o=Fa(),{EventEmitter:u}=(Yt(),Ne(Ut)),c=Wa(),i=Go(),e=kt()("mqtt-packet:parser"),r=class dn extends u{constructor(){super(),this.parser=this.constructor.parser}static parser(n){return this instanceof dn?(this.settings=n||{},this._states=["_parseHeader","_parseLength","_parsePayload","_newPacket"],this._resetState(),this):new dn().parser(n)}_resetState(){e("_resetState: resetting packet, error, _list, and _stateCounter"),this.packet=new c,this.error=null,this._list=o(),this._stateCounter=0}parse(n){for(this.error&&this._resetState(),this._list.append(n),e("parse: current state: %s",this._states[this._stateCounter]);(this.packet.length!==-1||this._list.length>0)&&this[this._states[this._stateCounter]]()&&!this.error;)this._stateCounter++,e("parse: state complete. _stateCounter is now: %d",this._stateCounter),e("parse: packet.length: %d, buffer list length: %d",this.packet.length,this._list.length),this._stateCounter>=this._states.length&&(this._stateCounter=0);return e("parse: exited while loop. packet: %d, buffer list length: %d",this.packet.length,this._list.length),this._list.length}_parseHeader(){let n=this._list.readUInt8(0),l=n>>i.CMD_SHIFT;this.packet.cmd=i.types[l];let d=n&15,p=i.requiredHeaderFlags[l];return p!=null&&d!==p?this._emitError(new Error(i.requiredHeaderFlagsErrors[l])):(this.packet.retain=(n&i.RETAIN_MASK)!==0,this.packet.qos=n>>i.QOS_SHIFT&i.QOS_MASK,this.packet.qos>2?this._emitError(new Error("Packet must not have both QoS bits set to 1")):(this.packet.dup=(n&i.DUP_MASK)!==0,e("_parseHeader: packet: %o",this.packet),this._list.consume(1),!0))}_parseLength(){let n=this._parseVarByteNum(!0);return n&&(this.packet.length=n.value,this._list.consume(n.bytes)),e("_parseLength %d",n.value),!!n}_parsePayload(){e("_parsePayload: payload %O",this._list);let n=!1;if(this.packet.length===0||this._list.length>=this.packet.length){switch(this._pos=0,this.packet.cmd){case"connect":this._parseConnect();break;case"connack":this._parseConnack();break;case"publish":this._parsePublish();break;case"puback":case"pubrec":case"pubrel":case"pubcomp":this._parseConfirmation();break;case"subscribe":this._parseSubscribe();break;case"suback":this._parseSuback();break;case"unsubscribe":this._parseUnsubscribe();break;case"unsuback":this._parseUnsuback();break;case"pingreq":case"pingresp":break;case"disconnect":this._parseDisconnect();break;case"auth":this._parseAuth();break;default:this._emitError(new Error("Not supported"))}n=!0}return e("_parsePayload complete result: %s",n),n}_parseConnect(){e("_parseConnect");let n,l,d,p,b={},m=this.packet,w=this._parseString();if(w===null)return this._emitError(new Error("Cannot parse protocolId"));if(w!=="MQTT"&&w!=="MQIsdp")return this._emitError(new Error("Invalid protocolId"));if(m.protocolId=w,this._pos>=this._list.length)return this._emitError(new Error("Packet too short"));if(m.protocolVersion=this._list.readUInt8(this._pos),m.protocolVersion>=128&&(m.bridgeMode=!0,m.protocolVersion=m.protocolVersion-128),m.protocolVersion!==3&&m.protocolVersion!==4&&m.protocolVersion!==5)return this._emitError(new Error("Invalid protocol version"));if(this._pos++,this._pos>=this._list.length)return this._emitError(new Error("Packet too short"));if(this._list.readUInt8(this._pos)&1)return this._emitError(new Error("Connect flag bit 0 must be 0, but got 1"));b.username=this._list.readUInt8(this._pos)&i.USERNAME_MASK,b.password=this._list.readUInt8(this._pos)&i.PASSWORD_MASK,b.will=this._list.readUInt8(this._pos)&i.WILL_FLAG_MASK;let E=!!(this._list.readUInt8(this._pos)&i.WILL_RETAIN_MASK),I=(this._list.readUInt8(this._pos)&i.WILL_QOS_MASK)>>i.WILL_QOS_SHIFT;if(b.will)m.will={},m.will.retain=E,m.will.qos=I;else{if(E)return this._emitError(new Error("Will Retain Flag must be set to zero when Will Flag is set to 0"));if(I)return this._emitError(new Error("Will QoS must be set to zero when Will Flag is set to 0"))}if(m.clean=(this._list.readUInt8(this._pos)&i.CLEAN_SESSION_MASK)!==0,this._pos++,m.keepalive=this._parseNum(),m.keepalive===-1)return this._emitError(new Error("Packet too short"));if(m.protocolVersion===5){let _=this._parseProperties();Object.getOwnPropertyNames(_).length&&(m.properties=_)}let y=this._parseString();if(y===null)return this._emitError(new Error("Packet too short"));if(m.clientId=y,e("_parseConnect: packet.clientId: %s",m.clientId),b.will){if(m.protocolVersion===5){let _=this._parseProperties();Object.getOwnPropertyNames(_).length&&(m.will.properties=_)}if(n=this._parseString(),n===null)return this._emitError(new Error("Cannot parse will topic"));if(m.will.topic=n,e("_parseConnect: packet.will.topic: %s",m.will.topic),l=this._parseBuffer(),l===null)return this._emitError(new Error("Cannot parse will payload"));m.will.payload=l,e("_parseConnect: packet.will.paylaod: %s",m.will.payload)}if(b.username){if(p=this._parseString(),p===null)return this._emitError(new Error("Cannot parse username"));m.username=p,e("_parseConnect: packet.username: %s",m.username)}if(b.password){if(d=this._parseBuffer(),d===null)return this._emitError(new Error("Cannot parse password"));m.password=d}return this.settings=m,e("_parseConnect: complete"),m}_parseConnack(){e("_parseConnack");let n=this.packet;if(this._list.length<1)return null;let l=this._list.readUInt8(this._pos++);if(l>1)return this._emitError(new Error("Invalid connack flags, bits 7-1 must be set to 0"));if(n.sessionPresent=!!(l&i.SESSIONPRESENT_MASK),this.settings.protocolVersion===5)this._list.length>=2?n.reasonCode=this._list.readUInt8(this._pos++):n.reasonCode=0;else{if(this._list.length<2)return null;n.returnCode=this._list.readUInt8(this._pos++)}if(n.returnCode===-1||n.reasonCode===-1)return this._emitError(new Error("Cannot parse return code"));if(this.settings.protocolVersion===5){let d=this._parseProperties();Object.getOwnPropertyNames(d).length&&(n.properties=d)}e("_parseConnack: complete")}_parsePublish(){e("_parsePublish");let n=this.packet;if(n.topic=this._parseString(),n.topic===null)return this._emitError(new Error("Cannot parse topic"));if(!(n.qos>0&&!this._parseMessageId())){if(this.settings.protocolVersion===5){let l=this._parseProperties();Object.getOwnPropertyNames(l).length&&(n.properties=l)}n.payload=this._list.slice(this._pos,n.length),e("_parsePublish: payload from buffer list: %o",n.payload)}}_parseSubscribe(){e("_parseSubscribe");let n=this.packet,l,d,p,b,m,w,E;if(n.subscriptions=[],!!this._parseMessageId()){if(this.settings.protocolVersion===5){let I=this._parseProperties();Object.getOwnPropertyNames(I).length&&(n.properties=I)}if(n.length<=0)return this._emitError(new Error("Malformed subscribe, no payload specified"));for(;this._pos<n.length;){if(l=this._parseString(),l===null)return this._emitError(new Error("Cannot parse topic"));if(this._pos>=n.length)return this._emitError(new Error("Malformed Subscribe Payload"));if(d=this._parseByte(),this.settings.protocolVersion===5){if(d&192)return this._emitError(new Error("Invalid subscribe topic flag bits, bits 7-6 must be 0"))}else if(d&252)return this._emitError(new Error("Invalid subscribe topic flag bits, bits 7-2 must be 0"));if(p=d&i.SUBSCRIBE_OPTIONS_QOS_MASK,p>2)return this._emitError(new Error("Invalid subscribe QoS, must be <= 2"));if(w=(d>>i.SUBSCRIBE_OPTIONS_NL_SHIFT&i.SUBSCRIBE_OPTIONS_NL_MASK)!==0,m=(d>>i.SUBSCRIBE_OPTIONS_RAP_SHIFT&i.SUBSCRIBE_OPTIONS_RAP_MASK)!==0,b=d>>i.SUBSCRIBE_OPTIONS_RH_SHIFT&i.SUBSCRIBE_OPTIONS_RH_MASK,b>2)return this._emitError(new Error("Invalid retain handling, must be <= 2"));E={topic:l,qos:p},this.settings.protocolVersion===5?(E.nl=w,E.rap=m,E.rh=b):this.settings.bridgeMode&&(E.rh=0,E.rap=!0,E.nl=!0),e("_parseSubscribe: push subscription `%s` to subscription",E),n.subscriptions.push(E)}}}_parseSuback(){e("_parseSuback");let n=this.packet;if(this.packet.granted=[],!!this._parseMessageId()){if(this.settings.protocolVersion===5){let l=this._parseProperties();Object.getOwnPropertyNames(l).length&&(n.properties=l)}if(n.length<=0)return this._emitError(new Error("Malformed suback, no payload specified"));for(;this._pos<this.packet.length;){let l=this._list.readUInt8(this._pos++);if(this.settings.protocolVersion===5){if(!i.MQTT5_SUBACK_CODES[l])return this._emitError(new Error("Invalid suback code"))}else if(l>2&&l!==128)return this._emitError(new Error("Invalid suback QoS, must be 0, 1, 2 or 128"));this.packet.granted.push(l)}}}_parseUnsubscribe(){e("_parseUnsubscribe");let n=this.packet;if(n.unsubscriptions=[],!!this._parseMessageId()){if(this.settings.protocolVersion===5){let l=this._parseProperties();Object.getOwnPropertyNames(l).length&&(n.properties=l)}if(n.length<=0)return this._emitError(new Error("Malformed unsubscribe, no payload specified"));for(;this._pos<n.length;){let l=this._parseString();if(l===null)return this._emitError(new Error("Cannot parse topic"));e("_parseUnsubscribe: push topic `%s` to unsubscriptions",l),n.unsubscriptions.push(l)}}}_parseUnsuback(){e("_parseUnsuback");let n=this.packet;if(!this._parseMessageId())return this._emitError(new Error("Cannot parse messageId"));if((this.settings.protocolVersion===3||this.settings.protocolVersion===4)&&n.length!==2)return this._emitError(new Error("Malformed unsuback, payload length must be 2"));if(n.length<=0)return this._emitError(new Error("Malformed unsuback, no payload specified"));if(this.settings.protocolVersion===5){let l=this._parseProperties();for(Object.getOwnPropertyNames(l).length&&(n.properties=l),n.granted=[];this._pos<this.packet.length;){let d=this._list.readUInt8(this._pos++);if(!i.MQTT5_UNSUBACK_CODES[d])return this._emitError(new Error("Invalid unsuback code"));this.packet.granted.push(d)}}}_parseConfirmation(){e("_parseConfirmation: packet.cmd: `%s`",this.packet.cmd);let n=this.packet;if(this._parseMessageId(),this.settings.protocolVersion===5){if(n.length>2){switch(n.reasonCode=this._parseByte(),this.packet.cmd){case"puback":case"pubrec":if(!i.MQTT5_PUBACK_PUBREC_CODES[n.reasonCode])return this._emitError(new Error("Invalid "+this.packet.cmd+" reason code"));break;case"pubrel":case"pubcomp":if(!i.MQTT5_PUBREL_PUBCOMP_CODES[n.reasonCode])return this._emitError(new Error("Invalid "+this.packet.cmd+" reason code"));break}e("_parseConfirmation: packet.reasonCode `%d`",n.reasonCode)}else n.reasonCode=0;if(n.length>3){let l=this._parseProperties();Object.getOwnPropertyNames(l).length&&(n.properties=l)}}return!0}_parseDisconnect(){let n=this.packet;if(e("_parseDisconnect"),this.settings.protocolVersion===5){this._list.length>0?(n.reasonCode=this._parseByte(),i.MQTT5_DISCONNECT_CODES[n.reasonCode]||this._emitError(new Error("Invalid disconnect reason code"))):n.reasonCode=0;let l=this._parseProperties();Object.getOwnPropertyNames(l).length&&(n.properties=l)}return e("_parseDisconnect result: true"),!0}_parseAuth(){e("_parseAuth");let n=this.packet;if(this.settings.protocolVersion!==5)return this._emitError(new Error("Not supported auth packet for this version MQTT"));if(n.reasonCode=this._parseByte(),!i.MQTT5_AUTH_CODES[n.reasonCode])return this._emitError(new Error("Invalid auth reason code"));let l=this._parseProperties();return Object.getOwnPropertyNames(l).length&&(n.properties=l),e("_parseAuth: result: true"),!0}_parseMessageId(){let n=this.packet;return n.messageId=this._parseNum(),n.messageId===null?(this._emitError(new Error("Cannot parse messageId")),!1):(e("_parseMessageId: packet.messageId %d",n.messageId),!0)}_parseString(n){let l=this._parseNum(),d=l+this._pos;if(l===-1||d>this._list.length||d>this.packet.length)return null;let p=this._list.toString("utf8",this._pos,d);return this._pos+=l,e("_parseString: result: %s",p),p}_parseStringPair(){return e("_parseStringPair"),{name:this._parseString(),value:this._parseString()}}_parseBuffer(){let n=this._parseNum(),l=n+this._pos;if(n===-1||l>this._list.length||l>this.packet.length)return null;let d=this._list.slice(this._pos,l);return this._pos+=n,e("_parseBuffer: result: %o",d),d}_parseNum(){if(this._list.length-this._pos<2)return-1;let n=this._list.readUInt16BE(this._pos);return this._pos+=2,e("_parseNum: result: %s",n),n}_parse4ByteNum(){if(this._list.length-this._pos<4)return-1;let n=this._list.readUInt32BE(this._pos);return this._pos+=4,e("_parse4ByteNum: result: %s",n),n}_parseVarByteNum(n){e("_parseVarByteNum");let l=4,d=0,p=1,b=0,m=!1,w,E=this._pos?this._pos:0;for(;d<l&&E+d<this._list.length;){if(w=this._list.readUInt8(E+d++),b+=p*(w&i.VARBYTEINT_MASK),p*=128,(w&i.VARBYTEINT_FIN_MASK)===0){m=!0;break}if(this._list.length<=d)break}return!m&&d===l&&this._list.length>=d&&this._emitError(new Error("Invalid variable byte integer")),E&&(this._pos+=d),m?n?m={bytes:d,value:b}:m=b:m=!1,e("_parseVarByteNum: result: %o",m),m}_parseByte(){let n;return this._pos<this._list.length&&(n=this._list.readUInt8(this._pos),this._pos++),e("_parseByte: result: %o",n),n}_parseByType(n){switch(e("_parseByType: type: %s",n),n){case"byte":return this._parseByte()!==0;case"int8":return this._parseByte();case"int16":return this._parseNum();case"int32":return this._parse4ByteNum();case"var":return this._parseVarByteNum();case"string":return this._parseString();case"pair":return this._parseStringPair();case"binary":return this._parseBuffer()}}_parseProperties(){e("_parseProperties");let n=this._parseVarByteNum(),l=this._pos+n,d={};for(;this._pos<l;){let p=this._parseByte();if(!p)return this._emitError(new Error("Cannot parse property code type")),!1;let b=i.propertiesCodes[p];if(!b)return this._emitError(new Error("Unknown property")),!1;if(b==="userProperties"){d[b]||(d[b]=Object.create(null));let m=this._parseByType(i.propertiesTypes[b]);if(d[b][m.name])if(Array.isArray(d[b][m.name]))d[b][m.name].push(m.value);else{let w=d[b][m.name];d[b][m.name]=[w],d[b][m.name].push(m.value)}else d[b][m.name]=m.value;continue}d[b]?Array.isArray(d[b])?d[b].push(this._parseByType(i.propertiesTypes[b])):(d[b]=[d[b]],d[b].push(this._parseByType(i.propertiesTypes[b]))):d[b]=this._parseByType(i.propertiesTypes[b])}return d}_newPacket(){return e("_newPacket"),this.packet&&(this._list.consume(this.packet.length),e("_newPacket: parser emit packet: packet.cmd: %s, packet.payload: %s, packet.length: %d",this.packet.cmd,this.packet.payload,this.packet.length),this.emit("packet",this.packet)),e("_newPacket: new packet"),this.packet=new c,this._pos=0,!0}_emitError(n){e("_emitError",n),this.error=n,this.emit("error",n)}};f.exports=r}),Va=me((s,f)=>{fe(),pe(),de();var{Buffer:o}=(Je(),Ne(Ye)),u=65536,c={},i=o.isBuffer(o.from([1,2]).subarray(0,1));function e(l){let d=o.allocUnsafe(2);return d.writeUInt8(l>>8,0),d.writeUInt8(l&255,1),d}function r(){for(let l=0;l<u;l++)c[l]=e(l)}function t(l){let d=0,p=0,b=o.allocUnsafe(4);do d=l%128|0,l=l/128|0,l>0&&(d=d|128),b.writeUInt8(d,p++);while(l>0&&p<4);return l>0&&(p=0),i?b.subarray(0,p):b.slice(0,p)}function n(l){let d=o.allocUnsafe(4);return d.writeUInt32BE(l,0),d}f.exports={cache:c,generateCache:r,generateNumber:e,genBufVariableByteInt:t,generate4ByteBuffer:n}}),za=me((s,f)=>{fe(),pe(),de(),typeof Me>"u"||!Me.version||Me.version.indexOf("v0.")===0||Me.version.indexOf("v1.")===0&&Me.version.indexOf("v1.8.")!==0?f.exports={nextTick:o}:f.exports=Me;function o(u,c,i,e){if(typeof u!="function")throw new TypeError('"callback" argument must be a function');var r=arguments.length,t,n;switch(r){case 0:case 1:return Me.nextTick(u);case 2:return Me.nextTick(function(){u.call(null,c)});case 3:return Me.nextTick(function(){u.call(null,c,i)});case 4:return Me.nextTick(function(){u.call(null,c,i,e)});default:for(t=new Array(r-1),n=0;n<t.length;)t[n++]=arguments[n];return Me.nextTick(function(){u.apply(null,t)})}}}),Yo=me((s,f)=>{fe(),pe(),de();var o=Go(),{Buffer:u}=(Je(),Ne(Ye)),c=u.allocUnsafe(0),i=u.from([0]),e=Va(),r=za().nextTick,t=kt()("mqtt-packet:writeToStream"),n=e.cache,l=e.generateNumber,d=e.generateCache,p=e.genBufVariableByteInt,b=e.generate4ByteBuffer,m=ae,w=!0;function E(Q,L,Z){switch(t("generate called"),L.cork&&(L.cork(),r(I,L)),w&&(w=!1,d()),t("generate: packet.cmd: %s",Q.cmd),Q.cmd){case"connect":return y(Q,L);case"connack":return _(Q,L,Z);case"publish":return N(Q,L,Z);case"puback":case"pubrec":case"pubrel":case"pubcomp":return B(Q,L,Z);case"subscribe":return A(Q,L,Z);case"suback":return k(Q,L,Z);case"unsubscribe":return M(Q,L,Z);case"unsuback":return J(Q,L,Z);case"pingreq":case"pingresp":return X(Q,L);case"disconnect":return ue(Q,L,Z);case"auth":return C(Q,L,Z);default:return L.destroy(new Error("Unknown command")),!1}}Object.defineProperty(E,"cacheNumbers",{get(){return m===ae},set(Q){Q?((!n||Object.keys(n).length===0)&&(w=!0),m=ae):(w=!1,m=ie)}});function I(Q){Q.uncork()}function y(Q,L,Z){let $=Q||{},H=$.protocolId||"MQTT",V=$.protocolVersion||4,he=$.will,oe=$.clean,x=$.keepalive||0,F=$.clientId||"",Y=$.username,se=$.password,re=$.properties;oe===void 0&&(oe=!0);let ce=0;if(typeof H!="string"&&!u.isBuffer(H))return L.destroy(new Error("Invalid protocolId")),!1;if(ce+=H.length+2,V!==3&&V!==4&&V!==5)return L.destroy(new Error("Invalid protocol version")),!1;if(ce+=1,(typeof F=="string"||u.isBuffer(F))&&(F||V>=4)&&(F||oe))ce+=u.byteLength(F)+2;else{if(V<4)return L.destroy(new Error("clientId must be supplied before 3.1.1")),!1;if(oe*1===0)return L.destroy(new Error("clientId must be given if cleanSession set to 0")),!1}if(typeof x!="number"||x<0||x>65535||x%1!==0)return L.destroy(new Error("Invalid keepalive")),!1;ce+=2,ce+=1;let W,le;if(V===5){if(W=ge(L,re),!W)return!1;ce+=W.length}if(he){if(typeof he!="object")return L.destroy(new Error("Invalid will")),!1;if(!he.topic||typeof he.topic!="string")return L.destroy(new Error("Invalid will topic")),!1;if(ce+=u.byteLength(he.topic)+2,ce+=2,he.payload)if(he.payload.length>=0)typeof he.payload=="string"?ce+=u.byteLength(he.payload):ce+=he.payload.length;else return L.destroy(new Error("Invalid will payload")),!1;if(le={},V===5){if(le=ge(L,he.properties),!le)return!1;ce+=le.length}}let ye=!1;if(Y!=null)if(Ae(Y))ye=!0,ce+=u.byteLength(Y)+2;else return L.destroy(new Error("Invalid username")),!1;if(se!=null){if(!ye)return L.destroy(new Error("Username is required to use password")),!1;if(Ae(se))ce+=D(se)+2;else return L.destroy(new Error("Invalid password")),!1}L.write(o.CONNECT_HEADER),K(L,ce),z(L,H),$.bridgeMode&&(V+=128),L.write(V===131?o.VERSION131:V===132?o.VERSION132:V===4?o.VERSION4:V===5?o.VERSION5:o.VERSION3);let ee=0;return ee|=Y!=null?o.USERNAME_MASK:0,ee|=se!=null?o.PASSWORD_MASK:0,ee|=he&&he.retain?o.WILL_RETAIN_MASK:0,ee|=he&&he.qos?he.qos<<o.WILL_QOS_SHIFT:0,ee|=he?o.WILL_FLAG_MASK:0,ee|=oe?o.CLEAN_SESSION_MASK:0,L.write(u.from([ee])),m(L,x),V===5&&W.write(),z(L,F),he&&(V===5&&le.write(),j(L,he.topic),z(L,he.payload)),Y!=null&&z(L,Y),se!=null&&z(L,se),!0}function _(Q,L,Z){let $=Z?Z.protocolVersion:4,H=Q||{},V=$===5?H.reasonCode:H.returnCode,he=H.properties,oe=2;if(typeof V!="number")return L.destroy(new Error("Invalid return code")),!1;let x=null;if($===5){if(x=ge(L,he),!x)return!1;oe+=x.length}return L.write(o.CONNACK_HEADER),K(L,oe),L.write(H.sessionPresent?o.SESSIONPRESENT_HEADER:i),L.write(u.from([V])),x==null||x.write(),!0}function N(Q,L,Z){t("publish: packet: %o",Q);let $=Z?Z.protocolVersion:4,H=Q||{},V=H.qos||0,he=H.retain?o.RETAIN_MASK:0,oe=H.topic,x=H.payload||c,F=H.messageId,Y=H.properties,se=0;if(typeof oe=="string")se+=u.byteLength(oe)+2;else if(u.isBuffer(oe))se+=oe.length+2;else return L.destroy(new Error("Invalid topic")),!1;if(u.isBuffer(x)?se+=x.length:se+=u.byteLength(x),V&&typeof F!="number")return L.destroy(new Error("Invalid messageId")),!1;V&&(se+=2);let re=null;if($===5){if(re=ge(L,Y),!re)return!1;se+=re.length}return L.write(o.PUBLISH_HEADER[V][H.dup?1:0][he?1:0]),K(L,se),m(L,D(oe)),L.write(oe),V>0&&m(L,F),re==null||re.write(),t("publish: payload: %o",x),L.write(x)}function B(Q,L,Z){let $=Z?Z.protocolVersion:4,H=Q||{},V=H.cmd||"puback",he=H.messageId,oe=H.dup&&V==="pubrel"?o.DUP_MASK:0,x=0,F=H.reasonCode,Y=H.properties,se=$===5?3:2;if(V==="pubrel"&&(x=1),typeof he!="number")return L.destroy(new Error("Invalid messageId")),!1;let re=null;if($===5&&typeof Y=="object"){if(re=R(L,Y,Z,se),!re)return!1;se+=re.length}return L.write(o.ACKS[V][x][oe][0]),se===3&&(se+=F!==0?1:-1),K(L,se),m(L,he),$===5&&se!==2&&L.write(u.from([F])),re!==null?re.write():se===4&&L.write(u.from([0])),!0}function A(Q,L,Z){t("subscribe: packet: ");let $=Z?Z.protocolVersion:4,H=Q||{},V=H.dup?o.DUP_MASK:0,he=H.messageId,oe=H.subscriptions,x=H.properties,F=0;if(typeof he!="number")return L.destroy(new Error("Invalid messageId")),!1;F+=2;let Y=null;if($===5){if(Y=ge(L,x),!Y)return!1;F+=Y.length}if(typeof oe=="object"&&oe.length)for(let re=0;re<oe.length;re+=1){let ce=oe[re].topic,W=oe[re].qos;if(typeof ce!="string")return L.destroy(new Error("Invalid subscriptions - invalid topic")),!1;if(typeof W!="number")return L.destroy(new Error("Invalid subscriptions - invalid qos")),!1;if($===5){if(typeof(oe[re].nl||!1)!="boolean")return L.destroy(new Error("Invalid subscriptions - invalid No Local")),!1;if(typeof(oe[re].rap||!1)!="boolean")return L.destroy(new Error("Invalid subscriptions - invalid Retain as Published")),!1;let le=oe[re].rh||0;if(typeof le!="number"||le>2)return L.destroy(new Error("Invalid subscriptions - invalid Retain Handling")),!1}F+=u.byteLength(ce)+2+1}else return L.destroy(new Error("Invalid subscriptions")),!1;t("subscribe: writing to stream: %o",o.SUBSCRIBE_HEADER),L.write(o.SUBSCRIBE_HEADER[1][V?1:0][0]),K(L,F),m(L,he),Y!==null&&Y.write();let se=!0;for(let re of oe){let ce=re.topic,W=re.qos,le=+re.nl,ye=+re.rap,ee=re.rh,Pe;j(L,ce),Pe=o.SUBSCRIBE_OPTIONS_QOS[W],$===5&&(Pe|=le?o.SUBSCRIBE_OPTIONS_NL:0,Pe|=ye?o.SUBSCRIBE_OPTIONS_RAP:0,Pe|=ee?o.SUBSCRIBE_OPTIONS_RH[ee]:0),se=L.write(u.from([Pe]))}return se}function k(Q,L,Z){let $=Z?Z.protocolVersion:4,H=Q||{},V=H.messageId,he=H.granted,oe=H.properties,x=0;if(typeof V!="number")return L.destroy(new Error("Invalid messageId")),!1;if(x+=2,typeof he=="object"&&he.length)for(let Y=0;Y<he.length;Y+=1){if(typeof he[Y]!="number")return L.destroy(new Error("Invalid qos vector")),!1;x+=1}else return L.destroy(new Error("Invalid qos vector")),!1;let F=null;if($===5){if(F=R(L,oe,Z,x),!F)return!1;x+=F.length}return L.write(o.SUBACK_HEADER),K(L,x),m(L,V),F!==null&&F.write(),L.write(u.from(he))}function M(Q,L,Z){let $=Z?Z.protocolVersion:4,H=Q||{},V=H.messageId,he=H.dup?o.DUP_MASK:0,oe=H.unsubscriptions,x=H.properties,F=0;if(typeof V!="number")return L.destroy(new Error("Invalid messageId")),!1;if(F+=2,typeof oe=="object"&&oe.length)for(let re=0;re<oe.length;re+=1){if(typeof oe[re]!="string")return L.destroy(new Error("Invalid unsubscriptions")),!1;F+=u.byteLength(oe[re])+2}else return L.destroy(new Error("Invalid unsubscriptions")),!1;let Y=null;if($===5){if(Y=ge(L,x),!Y)return!1;F+=Y.length}L.write(o.UNSUBSCRIBE_HEADER[1][he?1:0][0]),K(L,F),m(L,V),Y!==null&&Y.write();let se=!0;for(let re=0;re<oe.length;re++)se=j(L,oe[re]);return se}function J(Q,L,Z){let $=Z?Z.protocolVersion:4,H=Q||{},V=H.messageId,he=H.dup?o.DUP_MASK:0,oe=H.granted,x=H.properties,F=H.cmd,Y=0,se=2;if(typeof V!="number")return L.destroy(new Error("Invalid messageId")),!1;if($===5)if(typeof oe=="object"&&oe.length)for(let ce=0;ce<oe.length;ce+=1){if(typeof oe[ce]!="number")return L.destroy(new Error("Invalid qos vector")),!1;se+=1}else return L.destroy(new Error("Invalid qos vector")),!1;let re=null;if($===5){if(re=R(L,x,Z,se),!re)return!1;se+=re.length}return L.write(o.ACKS[F][Y][he][0]),K(L,se),m(L,V),re!==null&&re.write(),$===5&&L.write(u.from(oe)),!0}function X(Q,L,Z){return L.write(o.EMPTY[Q.cmd])}function ue(Q,L,Z){let $=Z?Z.protocolVersion:4,H=Q||{},V=H.reasonCode,he=H.properties,oe=$===5?1:0,x=null;if($===5){if(x=R(L,he,Z,oe),!x)return!1;oe+=x.length}return L.write(u.from([o.codes.disconnect<<4])),K(L,oe),$===5&&L.write(u.from([V])),x!==null&&x.write(),!0}function C(Q,L,Z){let $=Z?Z.protocolVersion:4,H=Q||{},V=H.reasonCode,he=H.properties,oe=$===5?1:0;$!==5&&L.destroy(new Error("Invalid mqtt version for auth packet"));let x=R(L,he,Z,oe);return x?(oe+=x.length,L.write(u.from([o.codes.auth<<4])),K(L,oe),L.write(u.from([V])),x!==null&&x.write(),!0):!1}var q={};function K(Q,L){if(L>o.VARBYTEINT_MAX)return Q.destroy(new Error(`Invalid variable byte integer: ${L}`)),!1;let Z=q[L];return Z||(Z=p(L),L<16384&&(q[L]=Z)),t("writeVarByteInt: writing to stream: %o",Z),Q.write(Z)}function j(Q,L){let Z=u.byteLength(L);return m(Q,Z),t("writeString: %s",L),Q.write(L,"utf8")}function te(Q,L,Z){j(Q,L),j(Q,Z)}function ae(Q,L){return t("writeNumberCached: number: %d",L),t("writeNumberCached: %o",n[L]),Q.write(n[L])}function ie(Q,L){let Z=l(L);return t("writeNumberGenerated: %o",Z),Q.write(Z)}function ve(Q,L){let Z=b(L);return t("write4ByteNumber: %o",Z),Q.write(Z)}function z(Q,L){typeof L=="string"?j(Q,L):L?(m(Q,L.length),Q.write(L)):m(Q,0)}function ge(Q,L){if(typeof L!="object"||L.length!=null)return{length:1,write(){be(Q,{},0)}};let Z=0;function $(H,V){let he=o.propertiesTypes[H],oe=0;switch(he){case"byte":{if(typeof V!="boolean")return Q.destroy(new Error(`Invalid ${H}: ${V}`)),!1;oe+=2;break}case"int8":{if(typeof V!="number"||V<0||V>255)return Q.destroy(new Error(`Invalid ${H}: ${V}`)),!1;oe+=2;break}case"binary":{if(V&&V===null)return Q.destroy(new Error(`Invalid ${H}: ${V}`)),!1;oe+=1+u.byteLength(V)+2;break}case"int16":{if(typeof V!="number"||V<0||V>65535)return Q.destroy(new Error(`Invalid ${H}: ${V}`)),!1;oe+=3;break}case"int32":{if(typeof V!="number"||V<0||V>4294967295)return Q.destroy(new Error(`Invalid ${H}: ${V}`)),!1;oe+=5;break}case"var":{if(typeof V!="number"||V<0||V>268435455)return Q.destroy(new Error(`Invalid ${H}: ${V}`)),!1;oe+=1+u.byteLength(p(V));break}case"string":{if(typeof V!="string")return Q.destroy(new Error(`Invalid ${H}: ${V}`)),!1;oe+=3+u.byteLength(V.toString());break}case"pair":{if(typeof V!="object")return Q.destroy(new Error(`Invalid ${H}: ${V}`)),!1;oe+=Object.getOwnPropertyNames(V).reduce((x,F)=>{let Y=V[F];return Array.isArray(Y)?x+=Y.reduce((se,re)=>(se+=3+u.byteLength(F.toString())+2+u.byteLength(re.toString()),se),0):x+=3+u.byteLength(F.toString())+2+u.byteLength(V[F].toString()),x},0);break}default:return Q.destroy(new Error(`Invalid property ${H}: ${V}`)),!1}return oe}if(L)for(let H in L){let V=0,he=0,oe=L[H];if(oe!==void 0){if(Array.isArray(oe))for(let x=0;x<oe.length;x++){if(he=$(H,oe[x]),!he)return!1;V+=he}else{if(he=$(H,oe),!he)return!1;V=he}if(!V)return!1;Z+=V}}return{length:u.byteLength(p(Z))+Z,write(){be(Q,L,Z)}}}function R(Q,L,Z,$){let H=["reasonString","userProperties"],V=Z&&Z.properties&&Z.properties.maximumPacketSize?Z.properties.maximumPacketSize:0,he=ge(Q,L);if(V)for(;$+he.length>V;){let oe=H.shift();if(oe&&L[oe])delete L[oe],he=ge(Q,L);else return!1}return he}function ne(Q,L,Z){switch(o.propertiesTypes[L]){case"byte":{Q.write(u.from([o.properties[L]])),Q.write(u.from([+Z]));break}case"int8":{Q.write(u.from([o.properties[L]])),Q.write(u.from([Z]));break}case"binary":{Q.write(u.from([o.properties[L]])),z(Q,Z);break}case"int16":{Q.write(u.from([o.properties[L]])),m(Q,Z);break}case"int32":{Q.write(u.from([o.properties[L]])),ve(Q,Z);break}case"var":{Q.write(u.from([o.properties[L]])),K(Q,Z);break}case"string":{Q.write(u.from([o.properties[L]])),j(Q,Z);break}case"pair":{Object.getOwnPropertyNames(Z).forEach($=>{let H=Z[$];Array.isArray(H)?H.forEach(V=>{Q.write(u.from([o.properties[L]])),te(Q,$.toString(),V.toString())}):(Q.write(u.from([o.properties[L]])),te(Q,$.toString(),H.toString()))});break}default:return Q.destroy(new Error(`Invalid property ${L} value: ${Z}`)),!1}}function be(Q,L,Z){K(Q,Z);for(let $ in L)if(Object.prototype.hasOwnProperty.call(L,$)&&L[$]!=null){let H=L[$];if(Array.isArray(H))for(let V=0;V<H.length;V++)ne(Q,$,H[V]);else ne(Q,$,H)}}function D(Q){return Q?Q instanceof u?Q.length:u.byteLength(Q):0}function Ae(Q){return typeof Q=="string"||Q instanceof u}f.exports=E}),Qa=me((s,f)=>{fe(),pe(),de();var o=Yo(),{EventEmitter:u}=(Yt(),Ne(Ut)),{Buffer:c}=(Je(),Ne(Ye));function i(r,t){let n=new e;return o(r,n,t),n.concat()}var e=class extends u{constructor(){super(),this._array=new Array(20),this._i=0}write(r){return this._array[this._i++]=r,!0}concat(){let r=0,t=new Array(this._array.length),n=this._array,l=0,d;for(d=0;d<n.length&&n[d]!==void 0;d++)typeof n[d]!="string"?t[d]=n[d].length:t[d]=c.byteLength(n[d]),r+=t[d];let p=c.allocUnsafe(r);for(d=0;d<n.length&&n[d]!==void 0;d++)typeof n[d]!="string"?(n[d].copy(p,l),l+=t[d]):(p.write(n[d],l),l+=t[d]);return p}destroy(r){r&&this.emit("error",r)}};f.exports=i}),Ka=me(s=>{fe(),pe(),de(),s.parser=Ha().parser,s.generate=Qa(),s.writeToStream=Yo()}),Jo=me(s=>{fe(),pe(),de(),Object.defineProperty(s,"__esModule",{value:!0});var f=class{constructor(){this.nextId=Math.max(1,Math.floor(Math.random()*65535))}allocate(){let o=this.nextId++;return this.nextId===65536&&(this.nextId=1),o}getLastAllocated(){return this.nextId===1?65535:this.nextId-1}register(o){return!0}deallocate(o){}clear(){}};s.default=f}),Ga=me((s,f)=>{fe(),pe(),de(),f.exports=u;function o(i){return i instanceof Br?Br.from(i):new i.constructor(i.buffer.slice(),i.byteOffset,i.length)}function u(i){if(i=i||{},i.circles)return c(i);let e=new Map;if(e.set(Date,d=>new Date(d)),e.set(Map,(d,p)=>new Map(t(Array.from(d),p))),e.set(Set,(d,p)=>new Set(t(Array.from(d),p))),i.constructorHandlers)for(let d of i.constructorHandlers)e.set(d[0],d[1]);let r=null;return i.proto?l:n;function t(d,p){let b=Object.keys(d),m=new Array(b.length);for(let w=0;w<b.length;w++){let E=b[w],I=d[E];typeof I!="object"||I===null?m[E]=I:I.constructor!==Object&&(r=e.get(I.constructor))?m[E]=r(I,p):ArrayBuffer.isView(I)?m[E]=o(I):m[E]=p(I)}return m}function n(d){if(typeof d!="object"||d===null)return d;if(Array.isArray(d))return t(d,n);if(d.constructor!==Object&&(r=e.get(d.constructor)))return r(d,n);let p={};for(let b in d){if(Object.hasOwnProperty.call(d,b)===!1)continue;let m=d[b];typeof m!="object"||m===null?p[b]=m:m.constructor!==Object&&(r=e.get(m.constructor))?p[b]=r(m,n):ArrayBuffer.isView(m)?p[b]=o(m):p[b]=n(m)}return p}function l(d){if(typeof d!="object"||d===null)return d;if(Array.isArray(d))return t(d,l);if(d.constructor!==Object&&(r=e.get(d.constructor)))return r(d,l);let p={};for(let b in d){let m=d[b];typeof m!="object"||m===null?p[b]=m:m.constructor!==Object&&(r=e.get(m.constructor))?p[b]=r(m,l):ArrayBuffer.isView(m)?p[b]=o(m):p[b]=l(m)}return p}}function c(i){let e=[],r=[],t=new Map;if(t.set(Date,b=>new Date(b)),t.set(Map,(b,m)=>new Map(l(Array.from(b),m))),t.set(Set,(b,m)=>new Set(l(Array.from(b),m))),i.constructorHandlers)for(let b of i.constructorHandlers)t.set(b[0],b[1]);let n=null;return i.proto?p:d;function l(b,m){let w=Object.keys(b),E=new Array(w.length);for(let I=0;I<w.length;I++){let y=w[I],_=b[y];if(typeof _!="object"||_===null)E[y]=_;else if(_.constructor!==Object&&(n=t.get(_.constructor)))E[y]=n(_,m);else if(ArrayBuffer.isView(_))E[y]=o(_);else{let N=e.indexOf(_);N!==-1?E[y]=r[N]:E[y]=m(_)}}return E}function d(b){if(typeof b!="object"||b===null)return b;if(Array.isArray(b))return l(b,d);if(b.constructor!==Object&&(n=t.get(b.constructor)))return n(b,d);let m={};e.push(b),r.push(m);for(let w in b){if(Object.hasOwnProperty.call(b,w)===!1)continue;let E=b[w];if(typeof E!="object"||E===null)m[w]=E;else if(E.constructor!==Object&&(n=t.get(E.constructor)))m[w]=n(E,d);else if(ArrayBuffer.isView(E))m[w]=o(E);else{let I=e.indexOf(E);I!==-1?m[w]=r[I]:m[w]=d(E)}}return e.pop(),r.pop(),m}function p(b){if(typeof b!="object"||b===null)return b;if(Array.isArray(b))return l(b,p);if(b.constructor!==Object&&(n=t.get(b.constructor)))return n(b,p);let m={};e.push(b),r.push(m);for(let w in b){let E=b[w];if(typeof E!="object"||E===null)m[w]=E;else if(E.constructor!==Object&&(n=t.get(E.constructor)))m[w]=n(E,p);else if(ArrayBuffer.isView(E))m[w]=o(E);else{let I=e.indexOf(E);I!==-1?m[w]=r[I]:m[w]=p(E)}}return e.pop(),r.pop(),m}}}),Ya=me((s,f)=>{fe(),pe(),de(),f.exports=Ga()()}),Ja=me(s=>{fe(),pe(),de(),Object.defineProperty(s,"__esModule",{value:!0}),s.validateTopic=f,s.validateTopics=o;function f(u){let c=u.split("/");for(let i=0;i<c.length;i++)if(c[i]!=="+"){if(c[i]==="#")return i===c.length-1;if(c[i].indexOf("+")!==-1||c[i].indexOf("#")!==-1)return!1}return!0}function o(u){if(u.length===0)return"empty_topic_list";for(let c=0;c<u.length;c++)if(!f(u[c]))return u[c];return null}}),Xo=me(s=>{fe(),pe(),de(),Object.defineProperty(s,"__esModule",{value:!0});var f=Xt(),o={objectMode:!0},u={clean:!0},c=class{constructor(i){this.options=i||{},this.options=Object.assign(Object.assign({},u),i),this._inflights=new Map}put(i,e){return this._inflights.set(i.messageId,i),e&&e(),this}createStream(){let i=new f.Readable(o),e=[],r=!1,t=0;return this._inflights.forEach((n,l)=>{e.push(n)}),i._read=()=>{!r&&t<e.length?i.push(e[t++]):i.push(null)},i.destroy=n=>{if(!r)return r=!0,setTimeout(()=>{i.emit("close")},0),i},i}del(i,e){let r=this._inflights.get(i.messageId);return r?(this._inflights.delete(i.messageId),e(null,r)):e&&e(new Error("missing packet")),this}get(i,e){let r=this._inflights.get(i.messageId);return r?e(null,r):e&&e(new Error("missing packet")),this}close(i){this.options.clean&&(this._inflights=null),i&&i()}};s.default=c}),Xa=me(s=>{fe(),pe(),de(),Object.defineProperty(s,"__esModule",{value:!0});var f=[0,16,128,131,135,144,145,151,153],o=(u,c,i)=>{u.log("handlePublish: packet %o",c),i=typeof i<"u"?i:u.noop;let e=c.topic.toString(),r=c.payload,{qos:t}=c,{messageId:n}=c,{options:l}=u;if(u.options.protocolVersion===5){let d;if(c.properties&&(d=c.properties.topicAlias),typeof d<"u")if(e.length===0)if(d>0&&d<=65535){let p=u.topicAliasRecv.getTopicByAlias(d);if(p)e=p,u.log("handlePublish :: topic complemented by alias. topic: %s - alias: %d",e,d);else{u.log("handlePublish :: unregistered topic alias. alias: %d",d),u.emit("error",new Error("Received unregistered Topic Alias"));return}}else{u.log("handlePublish :: topic alias out of range. alias: %d",d),u.emit("error",new Error("Received Topic Alias is out of range"));return}else if(u.topicAliasRecv.put(e,d))u.log("handlePublish :: registered topic: %s - alias: %d",e,d);else{u.log("handlePublish :: topic alias out of range. alias: %d",d),u.emit("error",new Error("Received Topic Alias is out of range"));return}}switch(u.log("handlePublish: qos %d",t),t){case 2:{l.customHandleAcks(e,r,c,(d,p)=>{if(typeof d=="number"&&(p=d,d=null),d)return u.emit("error",d);if(f.indexOf(p)===-1)return u.emit("error",new Error("Wrong reason code for pubrec"));p?u._sendPacket({cmd:"pubrec",messageId:n,reasonCode:p},i):u.incomingStore.put(c,()=>{u._sendPacket({cmd:"pubrec",messageId:n},i)})});break}case 1:{l.customHandleAcks(e,r,c,(d,p)=>{if(typeof d=="number"&&(p=d,d=null),d)return u.emit("error",d);if(f.indexOf(p)===-1)return u.emit("error",new Error("Wrong reason code for puback"));p||u.emit("message",e,r,c),u.handleMessage(c,b=>{if(b)return i&&i(b);u._sendPacket({cmd:"puback",messageId:n,reasonCode:p},i)})});break}case 0:u.emit("message",e,r,c),u.handleMessage(c,i);break;default:u.log("handlePublish: unknown QoS. Doing nothing.");break}};s.default=o}),Za=me((s,f)=>{f.exports={version:"5.13.2"}}),nr=me(s=>{fe(),pe(),de(),Object.defineProperty(s,"__esModule",{value:!0}),s.MQTTJS_VERSION=s.nextTick=s.ErrorWithSubackPacket=s.ErrorWithReasonCode=void 0,s.applyMixin=u;var f=class Zo extends Error{constructor(i,e){super(i),this.code=e,Object.setPrototypeOf(this,Zo.prototype),Object.getPrototypeOf(this).name="ErrorWithReasonCode"}};s.ErrorWithReasonCode=f;var o=class es extends Error{constructor(i,e){super(i),this.packet=e,Object.setPrototypeOf(this,es.prototype),Object.getPrototypeOf(this).name="ErrorWithSubackPacket"}};s.ErrorWithSubackPacket=o;function u(c,i,e=!1){var r;let t=[i];for(;;){let n=t[0],l=Object.getPrototypeOf(n);if(l!=null&&l.prototype)t.unshift(l);else break}for(let n of t)for(let l of Object.getOwnPropertyNames(n.prototype))(e||l!=="constructor")&&Object.defineProperty(c.prototype,l,(r=Object.getOwnPropertyDescriptor(n.prototype,l))!==null&&r!==void 0?r:Object.create(null))}s.nextTick=typeof(Me==null?void 0:Me.nextTick)=="function"?Me.nextTick:c=>{setTimeout(c,0)},s.MQTTJS_VERSION=Za().version}),Dr=me(s=>{fe(),pe(),de(),Object.defineProperty(s,"__esModule",{value:!0}),s.ReasonCodes=void 0;var f=nr();s.ReasonCodes={0:"",1:"Unacceptable protocol version",2:"Identifier rejected",3:"Server unavailable",4:"Bad username or password",5:"Not authorized",16:"No matching subscribers",17:"No subscription existed",128:"Unspecified error",129:"Malformed Packet",130:"Protocol Error",131:"Implementation specific error",132:"Unsupported Protocol Version",133:"Client Identifier not valid",134:"Bad User Name or Password",135:"Not authorized",136:"Server unavailable",137:"Server busy",138:"Banned",139:"Server shutting down",140:"Bad authentication method",141:"Keep Alive timeout",142:"Session taken over",143:"Topic Filter invalid",144:"Topic Name invalid",145:"Packet identifier in use",146:"Packet Identifier not found",147:"Receive Maximum exceeded",148:"Topic Alias invalid",149:"Packet too large",150:"Message rate too high",151:"Quota exceeded",152:"Administrative action",153:"Payload format invalid",154:"Retain not supported",155:"QoS not supported",156:"Use another server",157:"Server moved",158:"Shared Subscriptions not supported",159:"Connection rate exceeded",160:"Maximum connect time",161:"Subscription Identifiers not supported",162:"Wildcard Subscriptions not supported"};var o=(u,c)=>{let{messageId:i}=c,e=c.cmd,r=null,t=u.outgoing[i]?u.outgoing[i].cb:null,n=null;if(!t){u.log("_handleAck :: Server sent an ack in error. Ignoring.");return}switch(u.log("_handleAck :: packet type",e),e){case"pubcomp":case"puback":{let l=c.reasonCode;l&&l>0&&l!==16?(n=new f.ErrorWithReasonCode(`Publish error: ${s.ReasonCodes[l]}`,l),u._removeOutgoingAndStoreMessage(i,()=>{t(n,c)})):u._removeOutgoingAndStoreMessage(i,t);break}case"pubrec":{r={cmd:"pubrel",qos:2,messageId:i};let l=c.reasonCode;l&&l>0&&l!==16?(n=new f.ErrorWithReasonCode(`Publish error: ${s.ReasonCodes[l]}`,l),u._removeOutgoingAndStoreMessage(i,()=>{t(n,c)})):u._sendPacket(r);break}case"suback":{delete u.outgoing[i],u.messageIdProvider.deallocate(i);let l=c.granted;for(let d=0;d<l.length;d++){let p=l[d];if((p&128)!==0){n=new Error(`Subscribe error: ${s.ReasonCodes[p]}`),n.code=p;let b=u.messageIdToTopic[i];b&&b.forEach(m=>{delete u._resubscribeTopics[m]})}}delete u.messageIdToTopic[i],u._invokeStoreProcessingQueue(),t(n,c);break}case"unsuback":{delete u.outgoing[i],u.messageIdProvider.deallocate(i),u._invokeStoreProcessingQueue(),t(null,c);break}default:u.emit("error",new Error("unrecognized packet type"))}u.disconnecting&&Object.keys(u.outgoing).length===0&&u.emit("outgoingEmpty")};s.default=o}),el=me(s=>{fe(),pe(),de(),Object.defineProperty(s,"__esModule",{value:!0});var f=nr(),o=Dr(),u=(c,i)=>{let{options:e}=c,r=e.protocolVersion,t=r===5?i.reasonCode:i.returnCode;if(r!==5){let n=new f.ErrorWithReasonCode(`Protocol error: Auth packets are only supported in MQTT 5. Your version:${r}`,t);c.emit("error",n);return}c.handleAuth(i,(n,l)=>{if(n){c.emit("error",n);return}if(t===24)c.reconnecting=!1,c._sendPacket(l);else{let d=new f.ErrorWithReasonCode(`Connection refused: ${o.ReasonCodes[t]}`,t);c.emit("error",d)}})};s.default=u}),tl=me(s=>{var b,m,w,E,I,y,_,N,B,A,k,M,J,X,ue,C,q,K,j,te,ae,ie,ve,z,ge,R,ne,be,D,pn,Q,L,Z,$,ts,V,he,oe,Bt,xt,gn,Tr,Or,We,bn,hr,Mt,mn,Pe;fe(),pe(),de(),Object.defineProperty(s,"__esModule",{value:!0}),s.LRUCache=void 0;var f=typeof performance=="object"&&performance&&typeof performance.now=="function"?performance:Date,o=new Set,u=typeof Me=="object"&&Me?Me:{},c=(a,h,g,v)=>{typeof u.emitWarning=="function"?u.emitWarning(a,h,g,v):console.error(`[${g}] ${h}: ${a}`)},i=globalThis.AbortController,e=globalThis.AbortSignal;if(typeof i>"u"){e=class{constructor(){Le(this,"onabort");Le(this,"_onabort",[]);Le(this,"reason");Le(this,"aborted",!1)}addEventListener(g,v){this._onabort.push(v)}},i=class{constructor(){Le(this,"signal",new e);h()}abort(g){var v,T;if(!this.signal.aborted){this.signal.reason=g,this.signal.aborted=!0;for(let U of this.signal._onabort)U(g);(T=(v=this.signal).onabort)==null||T.call(v,g)}}};let a=((b=u.env)==null?void 0:b.LRU_CACHE_IGNORE_AC_WARNING)!=="1",h=()=>{a&&(a=!1,c("AbortController is not defined. If using lru-cache in node 14, load an AbortController polyfill from the `node-abort-controller` package. A minimal polyfill is provided for use by LRUCache.fetch(), but it should not be relied upon in other contexts (eg, passing it to other APIs that use AbortController/AbortSignal might have undesirable effects). You may disable this with LRU_CACHE_IGNORE_AC_WARNING=1 in the env.","NO_ABORT_CONTROLLER","ENOTSUP",h))}}var r=a=>!o.has(a),t=a=>a&&a===Math.floor(a)&&a>0&&isFinite(a),n=a=>t(a)?a<=Math.pow(2,8)?Uint8Array:a<=Math.pow(2,16)?Uint16Array:a<=Math.pow(2,32)?Uint32Array:a<=Number.MAX_SAFE_INTEGER?l:null:null,l=class extends Array{constructor(a){super(a),this.fill(0)}},d=(m=class{constructor(h,g){Le(this,"heap");Le(this,"length");if(!O(m,w))throw new TypeError("instantiate Stack using Stack.create(n)");this.heap=new g(h),this.length=0}static create(h){let g=n(h);if(!g)return[];Oe(m,w,!0);let v=new m(h,g);return Oe(m,w,!1),v}push(h){this.heap[this.length++]=h}pop(){return this.heap[--this.length]}},w=new WeakMap,xe(m,w,!1),m),p=(Pe=class{constructor(h){xe(this,D);xe(this,y);xe(this,_);xe(this,N);xe(this,B);xe(this,A);xe(this,k);Le(this,"ttl");Le(this,"ttlResolution");Le(this,"ttlAutopurge");Le(this,"updateAgeOnGet");Le(this,"updateAgeOnHas");Le(this,"allowStale");Le(this,"noDisposeOnSet");Le(this,"noUpdateTTL");Le(this,"maxEntrySize");Le(this,"sizeCalculation");Le(this,"noDeleteOnFetchRejection");Le(this,"noDeleteOnStaleGet");Le(this,"allowStaleOnFetchAbort");Le(this,"allowStaleOnFetchRejection");Le(this,"ignoreFetchAbort");xe(this,M);xe(this,J);xe(this,X);xe(this,ue);xe(this,C);xe(this,q);xe(this,K);xe(this,j);xe(this,te);xe(this,ae);xe(this,ie);xe(this,ve);xe(this,z);xe(this,ge);xe(this,R);xe(this,ne);xe(this,be);xe(this,Q,()=>{});xe(this,L,()=>{});xe(this,Z,()=>{});xe(this,$,()=>!1);xe(this,V,h=>{});xe(this,he,(h,g,v)=>{});xe(this,oe,(h,g,v,T)=>{if(v||T)throw new TypeError("cannot set size without setting maxSize or maxEntrySize on cache");return 0});Le(this,E,"LRUCache");let{max:g=0,ttl:v,ttlResolution:T=1,ttlAutopurge:U,updateAgeOnGet:G,updateAgeOnHas:_e,allowStale:Ee,dispose:Te,disposeAfter:Be,noDisposeOnSet:Ce,noUpdateTTL:dt,maxSize:ot=0,maxEntrySize:at=0,sizeCalculation:$e,fetchMethod:Ge,memoMethod:Re,noDeleteOnFetchRejection:Fe,noDeleteOnStaleGet:Ze,allowStaleOnFetchRejection:Ke,allowStaleOnFetchAbort:rt,ignoreFetchAbort:Ct}=h;if(g!==0&&!t(g))throw new TypeError("max option must be a nonnegative integer");let S=g?n(g):Array;if(!S)throw new Error("invalid max value: "+g);if(Oe(this,y,g),Oe(this,_,ot),this.maxEntrySize=at||O(this,_),this.sizeCalculation=$e,this.sizeCalculation){if(!O(this,_)&&!this.maxEntrySize)throw new TypeError("cannot set sizeCalculation without setting maxSize or maxEntrySize");if(typeof this.sizeCalculation!="function")throw new TypeError("sizeCalculation set to non-function")}if(Re!==void 0&&typeof Re!="function")throw new TypeError("memoMethod must be a function if defined");if(Oe(this,k,Re),Ge!==void 0&&typeof Ge!="function")throw new TypeError("fetchMethod must be a function if specified");if(Oe(this,A,Ge),Oe(this,ne,!!Ge),Oe(this,X,new Map),Oe(this,ue,new Array(g).fill(void 0)),Oe(this,C,new Array(g).fill(void 0)),Oe(this,q,new S(g)),Oe(this,K,new S(g)),Oe(this,j,0),Oe(this,te,0),Oe(this,ae,d.create(g)),Oe(this,M,0),Oe(this,J,0),typeof Te=="function"&&Oe(this,N,Te),typeof Be=="function"?(Oe(this,B,Be),Oe(this,ie,[])):(Oe(this,B,void 0),Oe(this,ie,void 0)),Oe(this,R,!!O(this,N)),Oe(this,be,!!O(this,B)),this.noDisposeOnSet=!!Ce,this.noUpdateTTL=!!dt,this.noDeleteOnFetchRejection=!!Fe,this.allowStaleOnFetchRejection=!!Ke,this.allowStaleOnFetchAbort=!!rt,this.ignoreFetchAbort=!!Ct,this.maxEntrySize!==0){if(O(this,_)!==0&&!t(O(this,_)))throw new TypeError("maxSize must be a positive integer if specified");if(!t(this.maxEntrySize))throw new TypeError("maxEntrySize must be a positive integer if specified");Ie(this,D,ts).call(this)}if(this.allowStale=!!Ee,this.noDeleteOnStaleGet=!!Ze,this.updateAgeOnGet=!!G,this.updateAgeOnHas=!!_e,this.ttlResolution=t(T)||T===0?T:1,this.ttlAutopurge=!!U,this.ttl=v||0,this.ttl){if(!t(this.ttl))throw new TypeError("ttl must be a positive integer if specified");Ie(this,D,pn).call(this)}if(O(this,y)===0&&this.ttl===0&&O(this,_)===0)throw new TypeError("At least one of max, maxSize, or ttl is required");if(!this.ttlAutopurge&&!O(this,y)&&!O(this,_)){let P="LRU_CACHE_UNBOUNDED";r(P)&&(o.add(P),c("TTL caching without ttlAutopurge, max, or maxSize can result in unbounded memory consumption.","UnboundedCacheWarning",P,Pe))}}static unsafeExposeInternals(h){return{starts:O(h,z),ttls:O(h,ge),sizes:O(h,ve),keyMap:O(h,X),keyList:O(h,ue),valList:O(h,C),next:O(h,q),prev:O(h,K),get head(){return O(h,j)},get tail(){return O(h,te)},free:O(h,ae),isBackgroundFetch:g=>{var v;return Ie(v=h,D,We).call(v,g)},backgroundFetch:(g,v,T,U)=>{var G;return Ie(G=h,D,Or).call(G,g,v,T,U)},moveToTail:g=>{var v;return Ie(v=h,D,hr).call(v,g)},indexes:g=>{var v;return Ie(v=h,D,Bt).call(v,g)},rindexes:g=>{var v;return Ie(v=h,D,xt).call(v,g)},isStale:g=>{var v;return O(v=h,$).call(v,g)}}}get max(){return O(this,y)}get maxSize(){return O(this,_)}get calculatedSize(){return O(this,J)}get size(){return O(this,M)}get fetchMethod(){return O(this,A)}get memoMethod(){return O(this,k)}get dispose(){return O(this,N)}get disposeAfter(){return O(this,B)}getRemainingTTL(h){return O(this,X).has(h)?1/0:0}*entries(){for(let h of Ie(this,D,Bt).call(this))O(this,C)[h]!==void 0&&O(this,ue)[h]!==void 0&&!Ie(this,D,We).call(this,O(this,C)[h])&&(yield[O(this,ue)[h],O(this,C)[h]])}*rentries(){for(let h of Ie(this,D,xt).call(this))O(this,C)[h]!==void 0&&O(this,ue)[h]!==void 0&&!Ie(this,D,We).call(this,O(this,C)[h])&&(yield[O(this,ue)[h],O(this,C)[h]])}*keys(){for(let h of Ie(this,D,Bt).call(this)){let g=O(this,ue)[h];g!==void 0&&!Ie(this,D,We).call(this,O(this,C)[h])&&(yield g)}}*rkeys(){for(let h of Ie(this,D,xt).call(this)){let g=O(this,ue)[h];g!==void 0&&!Ie(this,D,We).call(this,O(this,C)[h])&&(yield g)}}*values(){for(let h of Ie(this,D,Bt).call(this))O(this,C)[h]!==void 0&&!Ie(this,D,We).call(this,O(this,C)[h])&&(yield O(this,C)[h])}*rvalues(){for(let h of Ie(this,D,xt).call(this))O(this,C)[h]!==void 0&&!Ie(this,D,We).call(this,O(this,C)[h])&&(yield O(this,C)[h])}[(I=Symbol.iterator,E=Symbol.toStringTag,I)](){return this.entries()}find(h,g={}){for(let v of Ie(this,D,Bt).call(this)){let T=O(this,C)[v],U=Ie(this,D,We).call(this,T)?T.__staleWhileFetching:T;if(U!==void 0&&h(U,O(this,ue)[v],this))return this.get(O(this,ue)[v],g)}}forEach(h,g=this){for(let v of Ie(this,D,Bt).call(this)){let T=O(this,C)[v],U=Ie(this,D,We).call(this,T)?T.__staleWhileFetching:T;U!==void 0&&h.call(g,U,O(this,ue)[v],this)}}rforEach(h,g=this){for(let v of Ie(this,D,xt).call(this)){let T=O(this,C)[v],U=Ie(this,D,We).call(this,T)?T.__staleWhileFetching:T;U!==void 0&&h.call(g,U,O(this,ue)[v],this)}}purgeStale(){let h=!1;for(let g of Ie(this,D,xt).call(this,{allowStale:!0}))O(this,$).call(this,g)&&(Ie(this,D,Mt).call(this,O(this,ue)[g],"expire"),h=!0);return h}info(h){let g=O(this,X).get(h);if(g===void 0)return;let v=O(this,C)[g],T=Ie(this,D,We).call(this,v)?v.__staleWhileFetching:v;if(T===void 0)return;let U={value:T};if(O(this,ge)&&O(this,z)){let G=O(this,ge)[g],_e=O(this,z)[g];if(G&&_e){let Ee=G-(f.now()-_e);U.ttl=Ee,U.start=Date.now()}}return O(this,ve)&&(U.size=O(this,ve)[g]),U}dump(){let h=[];for(let g of Ie(this,D,Bt).call(this,{allowStale:!0})){let v=O(this,ue)[g],T=O(this,C)[g],U=Ie(this,D,We).call(this,T)?T.__staleWhileFetching:T;if(U===void 0||v===void 0)continue;let G={value:U};if(O(this,ge)&&O(this,z)){G.ttl=O(this,ge)[g];let _e=f.now()-O(this,z)[g];G.start=Math.floor(Date.now()-_e)}O(this,ve)&&(G.size=O(this,ve)[g]),h.unshift([v,G])}return h}load(h){this.clear();for(let[g,v]of h){if(v.start){let T=Date.now()-v.start;v.start=f.now()-T}this.set(g,v.value,v)}}set(h,g,v={}){var dt,ot,at,$e,Ge;if(g===void 0)return this.delete(h),this;let{ttl:T=this.ttl,start:U,noDisposeOnSet:G=this.noDisposeOnSet,sizeCalculation:_e=this.sizeCalculation,status:Ee}=v,{noUpdateTTL:Te=this.noUpdateTTL}=v,Be=O(this,oe).call(this,h,g,v.size||0,_e);if(this.maxEntrySize&&Be>this.maxEntrySize)return Ee&&(Ee.set="miss",Ee.maxEntrySizeExceeded=!0),Ie(this,D,Mt).call(this,h,"set"),this;let Ce=O(this,M)===0?void 0:O(this,X).get(h);if(Ce===void 0)Ce=O(this,M)===0?O(this,te):O(this,ae).length!==0?O(this,ae).pop():O(this,M)===O(this,y)?Ie(this,D,Tr).call(this,!1):O(this,M),O(this,ue)[Ce]=h,O(this,C)[Ce]=g,O(this,X).set(h,Ce),O(this,q)[O(this,te)]=Ce,O(this,K)[Ce]=O(this,te),Oe(this,te,Ce),gr(this,M)._++,O(this,he).call(this,Ce,Be,Ee),Ee&&(Ee.set="add"),Te=!1;else{Ie(this,D,hr).call(this,Ce);let Re=O(this,C)[Ce];if(g!==Re){if(O(this,ne)&&Ie(this,D,We).call(this,Re)){Re.__abortController.abort(new Error("replaced"));let{__staleWhileFetching:Fe}=Re;Fe!==void 0&&!G&&(O(this,R)&&((dt=O(this,N))==null||dt.call(this,Fe,h,"set")),O(this,be)&&((ot=O(this,ie))==null||ot.push([Fe,h,"set"])))}else G||(O(this,R)&&((at=O(this,N))==null||at.call(this,Re,h,"set")),O(this,be)&&(($e=O(this,ie))==null||$e.push([Re,h,"set"])));if(O(this,V).call(this,Ce),O(this,he).call(this,Ce,Be,Ee),O(this,C)[Ce]=g,Ee){Ee.set="replace";let Fe=Re&&Ie(this,D,We).call(this,Re)?Re.__staleWhileFetching:Re;Fe!==void 0&&(Ee.oldValue=Fe)}}else Ee&&(Ee.set="update")}if(T!==0&&!O(this,ge)&&Ie(this,D,pn).call(this),O(this,ge)&&(Te||O(this,Z).call(this,Ce,T,U),Ee&&O(this,L).call(this,Ee,Ce)),!G&&O(this,be)&&O(this,ie)){let Re=O(this,ie),Fe;for(;Fe=Re==null?void 0:Re.shift();)(Ge=O(this,B))==null||Ge.call(this,...Fe)}return this}pop(){var h;try{for(;O(this,M);){let g=O(this,C)[O(this,j)];if(Ie(this,D,Tr).call(this,!0),Ie(this,D,We).call(this,g)){if(g.__staleWhileFetching)return g.__staleWhileFetching}else if(g!==void 0)return g}}finally{if(O(this,be)&&O(this,ie)){let g=O(this,ie),v;for(;v=g==null?void 0:g.shift();)(h=O(this,B))==null||h.call(this,...v)}}}has(h,g={}){let{updateAgeOnHas:v=this.updateAgeOnHas,status:T}=g,U=O(this,X).get(h);if(U!==void 0){let G=O(this,C)[U];if(Ie(this,D,We).call(this,G)&&G.__staleWhileFetching===void 0)return!1;if(O(this,$).call(this,U))T&&(T.has="stale",O(this,L).call(this,T,U));else return v&&O(this,Q).call(this,U),T&&(T.has="hit",O(this,L).call(this,T,U)),!0}else T&&(T.has="miss");return!1}peek(h,g={}){let{allowStale:v=this.allowStale}=g,T=O(this,X).get(h);if(T===void 0||!v&&O(this,$).call(this,T))return;let U=O(this,C)[T];return Ie(this,D,We).call(this,U)?U.__staleWhileFetching:U}async fetch(h,g={}){let{allowStale:v=this.allowStale,updateAgeOnGet:T=this.updateAgeOnGet,noDeleteOnStaleGet:U=this.noDeleteOnStaleGet,ttl:G=this.ttl,noDisposeOnSet:_e=this.noDisposeOnSet,size:Ee=0,sizeCalculation:Te=this.sizeCalculation,noUpdateTTL:Be=this.noUpdateTTL,noDeleteOnFetchRejection:Ce=this.noDeleteOnFetchRejection,allowStaleOnFetchRejection:dt=this.allowStaleOnFetchRejection,ignoreFetchAbort:ot=this.ignoreFetchAbort,allowStaleOnFetchAbort:at=this.allowStaleOnFetchAbort,context:$e,forceRefresh:Ge=!1,status:Re,signal:Fe}=g;if(!O(this,ne))return Re&&(Re.fetch="get"),this.get(h,{allowStale:v,updateAgeOnGet:T,noDeleteOnStaleGet:U,status:Re});let Ze={allowStale:v,updateAgeOnGet:T,noDeleteOnStaleGet:U,ttl:G,noDisposeOnSet:_e,size:Ee,sizeCalculation:Te,noUpdateTTL:Be,noDeleteOnFetchRejection:Ce,allowStaleOnFetchRejection:dt,allowStaleOnFetchAbort:at,ignoreFetchAbort:ot,status:Re,signal:Fe},Ke=O(this,X).get(h);if(Ke===void 0){Re&&(Re.fetch="miss");let rt=Ie(this,D,Or).call(this,h,Ke,Ze,$e);return rt.__returned=rt}else{let rt=O(this,C)[Ke];if(Ie(this,D,We).call(this,rt)){let we=v&&rt.__staleWhileFetching!==void 0;return Re&&(Re.fetch="inflight",we&&(Re.returnedStale=!0)),we?rt.__staleWhileFetching:rt.__returned=rt}let Ct=O(this,$).call(this,Ke);if(!Ge&&!Ct)return Re&&(Re.fetch="hit"),Ie(this,D,hr).call(this,Ke),T&&O(this,Q).call(this,Ke),Re&&O(this,L).call(this,Re,Ke),rt;let S=Ie(this,D,Or).call(this,h,Ke,Ze,$e),P=S.__staleWhileFetching!==void 0&&v;return Re&&(Re.fetch=Ct?"stale":"refresh",P&&Ct&&(Re.returnedStale=!0)),P?S.__staleWhileFetching:S.__returned=S}}async forceFetch(h,g={}){let v=await this.fetch(h,g);if(v===void 0)throw new Error("fetch() returned undefined");return v}memo(h,g={}){let v=O(this,k);if(!v)throw new Error("no memoMethod provided to constructor");let{context:T,forceRefresh:U,...G}=g,_e=this.get(h,G);if(!U&&_e!==void 0)return _e;let Ee=v(h,_e,{options:G,context:T});return this.set(h,Ee,G),Ee}get(h,g={}){let{allowStale:v=this.allowStale,updateAgeOnGet:T=this.updateAgeOnGet,noDeleteOnStaleGet:U=this.noDeleteOnStaleGet,status:G}=g,_e=O(this,X).get(h);if(_e!==void 0){let Ee=O(this,C)[_e],Te=Ie(this,D,We).call(this,Ee);return G&&O(this,L).call(this,G,_e),O(this,$).call(this,_e)?(G&&(G.get="stale"),Te?(G&&v&&Ee.__staleWhileFetching!==void 0&&(G.returnedStale=!0),v?Ee.__staleWhileFetching:void 0):(U||Ie(this,D,Mt).call(this,h,"expire"),G&&v&&(G.returnedStale=!0),v?Ee:void 0)):(G&&(G.get="hit"),Te?Ee.__staleWhileFetching:(Ie(this,D,hr).call(this,_e),T&&O(this,Q).call(this,_e),Ee))}else G&&(G.get="miss")}delete(h){return Ie(this,D,Mt).call(this,h,"delete")}clear(){return Ie(this,D,mn).call(this,"delete")}},y=new WeakMap,_=new WeakMap,N=new WeakMap,B=new WeakMap,A=new WeakMap,k=new WeakMap,M=new WeakMap,J=new WeakMap,X=new WeakMap,ue=new WeakMap,C=new WeakMap,q=new WeakMap,K=new WeakMap,j=new WeakMap,te=new WeakMap,ae=new WeakMap,ie=new WeakMap,ve=new WeakMap,z=new WeakMap,ge=new WeakMap,R=new WeakMap,ne=new WeakMap,be=new WeakMap,D=new WeakSet,pn=function(){let h=new l(O(this,y)),g=new l(O(this,y));Oe(this,ge,h),Oe(this,z,g),Oe(this,Z,(U,G,_e=f.now())=>{if(g[U]=G!==0?_e:0,h[U]=G,G!==0&&this.ttlAutopurge){let Ee=setTimeout(()=>{O(this,$).call(this,U)&&Ie(this,D,Mt).call(this,O(this,ue)[U],"expire")},G+1);Ee.unref&&Ee.unref()}}),Oe(this,Q,U=>{g[U]=h[U]!==0?f.now():0}),Oe(this,L,(U,G)=>{if(h[G]){let _e=h[G],Ee=g[G];if(!_e||!Ee)return;U.ttl=_e,U.start=Ee,U.now=v||T();let Te=U.now-Ee;U.remainingTTL=_e-Te}});let v=0,T=()=>{let U=f.now();if(this.ttlResolution>0){v=U;let G=setTimeout(()=>v=0,this.ttlResolution);G.unref&&G.unref()}return U};this.getRemainingTTL=U=>{let G=O(this,X).get(U);if(G===void 0)return 0;let _e=h[G],Ee=g[G];if(!_e||!Ee)return 1/0;let Te=(v||T())-Ee;return _e-Te},Oe(this,$,U=>{let G=g[U],_e=h[U];return!!_e&&!!G&&(v||T())-G>_e})},Q=new WeakMap,L=new WeakMap,Z=new WeakMap,$=new WeakMap,ts=function(){let h=new l(O(this,y));Oe(this,J,0),Oe(this,ve,h),Oe(this,V,g=>{Oe(this,J,O(this,J)-h[g]),h[g]=0}),Oe(this,oe,(g,v,T,U)=>{if(Ie(this,D,We).call(this,v))return 0;if(!t(T))if(U){if(typeof U!="function")throw new TypeError("sizeCalculation must be a function");if(T=U(v,g),!t(T))throw new TypeError("sizeCalculation return invalid (expect positive integer)")}else throw new TypeError("invalid size value (must be positive integer). When maxSize or maxEntrySize is used, sizeCalculation or size must be set.");return T}),Oe(this,he,(g,v,T)=>{if(h[g]=v,O(this,_)){let U=O(this,_)-h[g];for(;O(this,J)>U;)Ie(this,D,Tr).call(this,!0)}Oe(this,J,O(this,J)+h[g]),T&&(T.entrySize=v,T.totalCalculatedSize=O(this,J))})},V=new WeakMap,he=new WeakMap,oe=new WeakMap,Bt=function*({allowStale:h=this.allowStale}={}){if(O(this,M))for(let g=O(this,te);!(!Ie(this,D,gn).call(this,g)||((h||!O(this,$).call(this,g))&&(yield g),g===O(this,j)));)g=O(this,K)[g]},xt=function*({allowStale:h=this.allowStale}={}){if(O(this,M))for(let g=O(this,j);!(!Ie(this,D,gn).call(this,g)||((h||!O(this,$).call(this,g))&&(yield g),g===O(this,te)));)g=O(this,q)[g]},gn=function(h){return h!==void 0&&O(this,X).get(O(this,ue)[h])===h},Tr=function(h){var U,G;let g=O(this,j),v=O(this,ue)[g],T=O(this,C)[g];return O(this,ne)&&Ie(this,D,We).call(this,T)?T.__abortController.abort(new Error("evicted")):(O(this,R)||O(this,be))&&(O(this,R)&&((U=O(this,N))==null||U.call(this,T,v,"evict")),O(this,be)&&((G=O(this,ie))==null||G.push([T,v,"evict"]))),O(this,V).call(this,g),h&&(O(this,ue)[g]=void 0,O(this,C)[g]=void 0,O(this,ae).push(g)),O(this,M)===1?(Oe(this,j,Oe(this,te,0)),O(this,ae).length=0):Oe(this,j,O(this,q)[g]),O(this,X).delete(v),gr(this,M)._--,g},Or=function(h,g,v,T){let U=g===void 0?void 0:O(this,C)[g];if(Ie(this,D,We).call(this,U))return U;let G=new i,{signal:_e}=v;_e==null||_e.addEventListener("abort",()=>G.abort(_e.reason),{signal:G.signal});let Ee={signal:G.signal,options:v,context:T},Te=($e,Ge=!1)=>{let{aborted:Re}=G.signal,Fe=v.ignoreFetchAbort&&$e!==void 0;if(v.status&&(Re&&!Ge?(v.status.fetchAborted=!0,v.status.fetchError=G.signal.reason,Fe&&(v.status.fetchAbortIgnored=!0)):v.status.fetchResolved=!0),Re&&!Fe&&!Ge)return Ce(G.signal.reason);let Ze=ot;return O(this,C)[g]===ot&&($e===void 0?Ze.__staleWhileFetching?O(this,C)[g]=Ze.__staleWhileFetching:Ie(this,D,Mt).call(this,h,"fetch"):(v.status&&(v.status.fetchUpdated=!0),this.set(h,$e,Ee.options))),$e},Be=$e=>(v.status&&(v.status.fetchRejected=!0,v.status.fetchError=$e),Ce($e)),Ce=$e=>{let{aborted:Ge}=G.signal,Re=Ge&&v.allowStaleOnFetchAbort,Fe=Re||v.allowStaleOnFetchRejection,Ze=Fe||v.noDeleteOnFetchRejection,Ke=ot;if(O(this,C)[g]===ot&&(!Ze||Ke.__staleWhileFetching===void 0?Ie(this,D,Mt).call(this,h,"fetch"):Re||(O(this,C)[g]=Ke.__staleWhileFetching)),Fe)return v.status&&Ke.__staleWhileFetching!==void 0&&(v.status.returnedStale=!0),Ke.__staleWhileFetching;if(Ke.__returned===Ke)throw $e},dt=($e,Ge)=>{var Fe;let Re=(Fe=O(this,A))==null?void 0:Fe.call(this,h,U,Ee);Re&&Re instanceof Promise&&Re.then(Ze=>$e(Ze===void 0?void 0:Ze),Ge),G.signal.addEventListener("abort",()=>{(!v.ignoreFetchAbort||v.allowStaleOnFetchAbort)&&($e(void 0),v.allowStaleOnFetchAbort&&($e=Ze=>Te(Ze,!0)))})};v.status&&(v.status.fetchDispatched=!0);let ot=new Promise(dt).then(Te,Be),at=Object.assign(ot,{__abortController:G,__staleWhileFetching:U,__returned:void 0});return g===void 0?(this.set(h,at,{...Ee.options,status:void 0}),g=O(this,X).get(h)):O(this,C)[g]=at,at},We=function(h){if(!O(this,ne))return!1;let g=h;return!!g&&g instanceof Promise&&g.hasOwnProperty("__staleWhileFetching")&&g.__abortController instanceof i},bn=function(h,g){O(this,K)[g]=h,O(this,q)[h]=g},hr=function(h){h!==O(this,te)&&(h===O(this,j)?Oe(this,j,O(this,q)[h]):Ie(this,D,bn).call(this,O(this,K)[h],O(this,q)[h]),Ie(this,D,bn).call(this,O(this,te),h),Oe(this,te,h))},Mt=function(h,g){var T,U,G,_e;let v=!1;if(O(this,M)!==0){let Ee=O(this,X).get(h);if(Ee!==void 0)if(v=!0,O(this,M)===1)Ie(this,D,mn).call(this,g);else{O(this,V).call(this,Ee);let Te=O(this,C)[Ee];if(Ie(this,D,We).call(this,Te)?Te.__abortController.abort(new Error("deleted")):(O(this,R)||O(this,be))&&(O(this,R)&&((T=O(this,N))==null||T.call(this,Te,h,g)),O(this,be)&&((U=O(this,ie))==null||U.push([Te,h,g]))),O(this,X).delete(h),O(this,ue)[Ee]=void 0,O(this,C)[Ee]=void 0,Ee===O(this,te))Oe(this,te,O(this,K)[Ee]);else if(Ee===O(this,j))Oe(this,j,O(this,q)[Ee]);else{let Be=O(this,K)[Ee];O(this,q)[Be]=O(this,q)[Ee];let Ce=O(this,q)[Ee];O(this,K)[Ce]=O(this,K)[Ee]}gr(this,M)._--,O(this,ae).push(Ee)}}if(O(this,be)&&((G=O(this,ie))!=null&&G.length)){let Ee=O(this,ie),Te;for(;Te=Ee==null?void 0:Ee.shift();)(_e=O(this,B))==null||_e.call(this,...Te)}return v},mn=function(h){var g,v,T;for(let U of Ie(this,D,xt).call(this,{allowStale:!0})){let G=O(this,C)[U];if(Ie(this,D,We).call(this,G))G.__abortController.abort(new Error("deleted"));else{let _e=O(this,ue)[U];O(this,R)&&((g=O(this,N))==null||g.call(this,G,_e,h)),O(this,be)&&((v=O(this,ie))==null||v.push([G,_e,h]))}}if(O(this,X).clear(),O(this,C).fill(void 0),O(this,ue).fill(void 0),O(this,ge)&&O(this,z)&&(O(this,ge).fill(0),O(this,z).fill(0)),O(this,ve)&&O(this,ve).fill(0),Oe(this,j,0),Oe(this,te,0),O(this,ae).length=0,Oe(this,J,0),Oe(this,M,0),O(this,be)&&O(this,ie)){let U=O(this,ie),G;for(;G=U==null?void 0:U.shift();)(T=O(this,B))==null||T.call(this,...G)}},Pe);s.LRUCache=p}),Ot=me(s=>{fe(),pe(),de(),Object.defineProperty(s,"t",{value:!0}),s.ContainerIterator=s.Container=s.Base=void 0;var f=class{constructor(c=0){this.iteratorType=c}equals(c){return this.o===c.o}};s.ContainerIterator=f;var o=class{constructor(){this.i=0}get length(){return this.i}size(){return this.i}empty(){return this.i===0}};s.Base=o;var u=class extends o{};s.Container=u}),rl=me(s=>{fe(),pe(),de(),Object.defineProperty(s,"t",{value:!0}),s.default=void 0;var f=Ot(),o=class extends f.Base{constructor(c=[]){super(),this.S=[];let i=this;c.forEach(function(e){i.push(e)})}clear(){this.i=0,this.S=[]}push(c){return this.S.push(c),this.i+=1,this.i}pop(){if(this.i!==0)return this.i-=1,this.S.pop()}top(){return this.S[this.i-1]}},u=o;s.default=u}),il=me(s=>{fe(),pe(),de(),Object.defineProperty(s,"t",{value:!0}),s.default=void 0;var f=Ot(),o=class extends f.Base{constructor(c=[]){super(),this.j=0,this.q=[];let i=this;c.forEach(function(e){i.push(e)})}clear(){this.q=[],this.i=this.j=0}push(c){let i=this.q.length;if(this.j/i>.5&&this.j+this.i>=i&&i>4096){let e=this.i;for(let r=0;r<e;++r)this.q[r]=this.q[this.j+r];this.j=0,this.q[this.i]=c}else this.q[this.j+this.i]=c;return++this.i}pop(){if(this.i===0)return;let c=this.q[this.j++];return this.i-=1,c}front(){if(this.i!==0)return this.q[this.j]}},u=o;s.default=u}),nl=me(s=>{fe(),pe(),de(),Object.defineProperty(s,"t",{value:!0}),s.default=void 0;var f=Ot(),o=class extends f.Base{constructor(c=[],i=function(r,t){return r>t?-1:r<t?1:0},e=!0){if(super(),this.v=i,Array.isArray(c))this.C=e?[...c]:c;else{this.C=[];let t=this;c.forEach(function(n){t.C.push(n)})}this.i=this.C.length;let r=this.i>>1;for(let t=this.i-1>>1;t>=0;--t)this.k(t,r)}m(c){let i=this.C[c];for(;c>0;){let e=c-1>>1,r=this.C[e];if(this.v(r,i)<=0)break;this.C[c]=r,c=e}this.C[c]=i}k(c,i){let e=this.C[c];for(;c<i;){let r=c<<1|1,t=r+1,n=this.C[r];if(t<this.i&&this.v(n,this.C[t])>0&&(r=t,n=this.C[t]),this.v(n,e)>=0)break;this.C[c]=n,c=r}this.C[c]=e}clear(){this.i=0,this.C.length=0}push(c){this.C.push(c),this.m(this.i),this.i+=1}pop(){if(this.i===0)return;let c=this.C[0],i=this.C.pop();return this.i-=1,this.i&&(this.C[0]=i,this.k(0,this.i>>1)),c}top(){return this.C[0]}find(c){return this.C.indexOf(c)>=0}remove(c){let i=this.C.indexOf(c);return i<0?!1:(i===0?this.pop():i===this.i-1?(this.C.pop(),this.i-=1):(this.C.splice(i,1,this.C.pop()),this.i-=1,this.m(i),this.k(i,this.i>>1)),!0)}updateItem(c){let i=this.C.indexOf(c);return i<0?!1:(this.m(i),this.k(i,this.i>>1),!0)}toArray(){return[...this.C]}},u=o;s.default=u}),xn=me(s=>{fe(),pe(),de(),Object.defineProperty(s,"t",{value:!0}),s.default=void 0;var f=Ot(),o=class extends f.Container{},u=o;s.default=u}),Pt=me(s=>{fe(),pe(),de(),Object.defineProperty(s,"t",{value:!0}),s.throwIteratorAccessError=f;function f(){throw new RangeError("Iterator access denied!")}}),rs=me(s=>{fe(),pe(),de(),Object.defineProperty(s,"t",{value:!0}),s.RandomIterator=void 0;var f=Ot(),o=Pt(),u=class extends f.ContainerIterator{constructor(c,i){super(i),this.o=c,this.iteratorType===0?(this.pre=function(){return this.o===0&&(0,o.throwIteratorAccessError)(),this.o-=1,this},this.next=function(){return this.o===this.container.size()&&(0,o.throwIteratorAccessError)(),this.o+=1,this}):(this.pre=function(){return this.o===this.container.size()-1&&(0,o.throwIteratorAccessError)(),this.o+=1,this},this.next=function(){return this.o===-1&&(0,o.throwIteratorAccessError)(),this.o-=1,this})}get pointer(){return this.container.getElementByPos(this.o)}set pointer(c){this.container.setElementByPos(this.o,c)}};s.RandomIterator=u}),ol=me(s=>{fe(),pe(),de(),Object.defineProperty(s,"t",{value:!0}),s.default=void 0;var f=u(xn()),o=rs();function u(r){return r&&r.t?r:{default:r}}var c=class is extends o.RandomIterator{constructor(t,n,l){super(t,l),this.container=n}copy(){return new is(this.o,this.container,this.iteratorType)}},i=class extends f.default{constructor(r=[],t=!0){if(super(),Array.isArray(r))this.J=t?[...r]:r,this.i=r.length;else{this.J=[];let n=this;r.forEach(function(l){n.pushBack(l)})}}clear(){this.i=0,this.J.length=0}begin(){return new c(0,this)}end(){return new c(this.i,this)}rBegin(){return new c(this.i-1,this,1)}rEnd(){return new c(-1,this,1)}front(){return this.J[0]}back(){return this.J[this.i-1]}getElementByPos(r){if(r<0||r>this.i-1)throw new RangeError;return this.J[r]}eraseElementByPos(r){if(r<0||r>this.i-1)throw new RangeError;return this.J.splice(r,1),this.i-=1,this.i}eraseElementByValue(r){let t=0;for(let n=0;n<this.i;++n)this.J[n]!==r&&(this.J[t++]=this.J[n]);return this.i=this.J.length=t,this.i}eraseElementByIterator(r){let t=r.o;return r=r.next(),this.eraseElementByPos(t),r}pushBack(r){return this.J.push(r),this.i+=1,this.i}popBack(){if(this.i!==0)return this.i-=1,this.J.pop()}setElementByPos(r,t){if(r<0||r>this.i-1)throw new RangeError;this.J[r]=t}insert(r,t,n=1){if(r<0||r>this.i)throw new RangeError;return this.J.splice(r,0,...new Array(n).fill(t)),this.i+=n,this.i}find(r){for(let t=0;t<this.i;++t)if(this.J[t]===r)return new c(t,this);return this.end()}reverse(){this.J.reverse()}unique(){let r=1;for(let t=1;t<this.i;++t)this.J[t]!==this.J[t-1]&&(this.J[r++]=this.J[t]);return this.i=this.J.length=r,this.i}sort(r){this.J.sort(r)}forEach(r){for(let t=0;t<this.i;++t)r(this.J[t],t,this)}[Symbol.iterator](){return(function*(){yield*this.J}).bind(this)()}},e=i;s.default=e}),sl=me(s=>{fe(),pe(),de(),Object.defineProperty(s,"t",{value:!0}),s.default=void 0;var f=c(xn()),o=Ot(),u=Pt();function c(t){return t&&t.t?t:{default:t}}var i=class ns extends o.ContainerIterator{constructor(n,l,d,p){super(p),this.o=n,this.h=l,this.container=d,this.iteratorType===0?(this.pre=function(){return this.o.L===this.h&&(0,u.throwIteratorAccessError)(),this.o=this.o.L,this},this.next=function(){return this.o===this.h&&(0,u.throwIteratorAccessError)(),this.o=this.o.B,this}):(this.pre=function(){return this.o.B===this.h&&(0,u.throwIteratorAccessError)(),this.o=this.o.B,this},this.next=function(){return this.o===this.h&&(0,u.throwIteratorAccessError)(),this.o=this.o.L,this})}get pointer(){return this.o===this.h&&(0,u.throwIteratorAccessError)(),this.o.l}set pointer(n){this.o===this.h&&(0,u.throwIteratorAccessError)(),this.o.l=n}copy(){return new ns(this.o,this.h,this.container,this.iteratorType)}},e=class extends f.default{constructor(t=[]){super(),this.h={},this.p=this._=this.h.L=this.h.B=this.h;let n=this;t.forEach(function(l){n.pushBack(l)})}V(t){let{L:n,B:l}=t;n.B=l,l.L=n,t===this.p&&(this.p=l),t===this._&&(this._=n),this.i-=1}G(t,n){let l=n.B,d={l:t,L:n,B:l};n.B=d,l.L=d,n===this.h&&(this.p=d),l===this.h&&(this._=d),this.i+=1}clear(){this.i=0,this.p=this._=this.h.L=this.h.B=this.h}begin(){return new i(this.p,this.h,this)}end(){return new i(this.h,this.h,this)}rBegin(){return new i(this._,this.h,this,1)}rEnd(){return new i(this.h,this.h,this,1)}front(){return this.p.l}back(){return this._.l}getElementByPos(t){if(t<0||t>this.i-1)throw new RangeError;let n=this.p;for(;t--;)n=n.B;return n.l}eraseElementByPos(t){if(t<0||t>this.i-1)throw new RangeError;let n=this.p;for(;t--;)n=n.B;return this.V(n),this.i}eraseElementByValue(t){let n=this.p;for(;n!==this.h;)n.l===t&&this.V(n),n=n.B;return this.i}eraseElementByIterator(t){let n=t.o;return n===this.h&&(0,u.throwIteratorAccessError)(),t=t.next(),this.V(n),t}pushBack(t){return this.G(t,this._),this.i}popBack(){if(this.i===0)return;let t=this._.l;return this.V(this._),t}pushFront(t){return this.G(t,this.h),this.i}popFront(){if(this.i===0)return;let t=this.p.l;return this.V(this.p),t}setElementByPos(t,n){if(t<0||t>this.i-1)throw new RangeError;let l=this.p;for(;t--;)l=l.B;l.l=n}insert(t,n,l=1){if(t<0||t>this.i)throw new RangeError;if(l<=0)return this.i;if(t===0)for(;l--;)this.pushFront(n);else if(t===this.i)for(;l--;)this.pushBack(n);else{let d=this.p;for(let b=1;b<t;++b)d=d.B;let p=d.B;for(this.i+=l;l--;)d.B={l:n,L:d},d.B.L=d,d=d.B;d.B=p,p.L=d}return this.i}find(t){let n=this.p;for(;n!==this.h;){if(n.l===t)return new i(n,this.h,this);n=n.B}return this.end()}reverse(){if(this.i<=1)return;let t=this.p,n=this._,l=0;for(;l<<1<this.i;){let d=t.l;t.l=n.l,n.l=d,t=t.B,n=n.L,l+=1}}unique(){if(this.i<=1)return this.i;let t=this.p;for(;t!==this.h;){let n=t;for(;n.B!==this.h&&n.l===n.B.l;)n=n.B,this.i-=1;t.B=n.B,t.B.L=t,t=t.B}return this.i}sort(t){if(this.i<=1)return;let n=[];this.forEach(function(d){n.push(d)}),n.sort(t);let l=this.p;n.forEach(function(d){l.l=d,l=l.B})}merge(t){let n=this;if(this.i===0)t.forEach(function(l){n.pushBack(l)});else{let l=this.p;t.forEach(function(d){for(;l!==n.h&&l.l<=d;)l=l.B;n.G(d,l.L)})}return this.i}forEach(t){let n=this.p,l=0;for(;n!==this.h;)t(n.l,l++,this),n=n.B}[Symbol.iterator](){return(function*(){if(this.i===0)return;let t=this.p;for(;t!==this.h;)yield t.l,t=t.B}).bind(this)()}},r=e;s.default=r}),al=me(s=>{fe(),pe(),de(),Object.defineProperty(s,"t",{value:!0}),s.default=void 0;var f=u(xn()),o=rs();function u(r){return r&&r.t?r:{default:r}}var c=class os extends o.RandomIterator{constructor(t,n,l){super(t,l),this.container=n}copy(){return new os(this.o,this.container,this.iteratorType)}},i=class extends f.default{constructor(r=[],t=4096){super(),this.j=0,this.D=0,this.R=0,this.N=0,this.P=0,this.A=[];let n=(()=>{if(typeof r.length=="number")return r.length;if(typeof r.size=="number")return r.size;if(typeof r.size=="function")return r.size();throw new TypeError("Cannot get the length or size of the container")})();this.F=t,this.P=Math.max(Math.ceil(n/this.F),1);for(let p=0;p<this.P;++p)this.A.push(new Array(this.F));let l=Math.ceil(n/this.F);this.j=this.R=(this.P>>1)-(l>>1),this.D=this.N=this.F-n%this.F>>1;let d=this;r.forEach(function(p){d.pushBack(p)})}T(){let r=[],t=Math.max(this.P>>1,1);for(let n=0;n<t;++n)r[n]=new Array(this.F);for(let n=this.j;n<this.P;++n)r[r.length]=this.A[n];for(let n=0;n<this.R;++n)r[r.length]=this.A[n];r[r.length]=[...this.A[this.R]],this.j=t,this.R=r.length-1;for(let n=0;n<t;++n)r[r.length]=new Array(this.F);this.A=r,this.P=r.length}O(r){let t=this.D+r+1,n=t%this.F,l=n-1,d=this.j+(t-n)/this.F;return n===0&&(d-=1),d%=this.P,l<0&&(l+=this.F),{curNodeBucketIndex:d,curNodePointerIndex:l}}clear(){this.A=[new Array(this.F)],this.P=1,this.j=this.R=this.i=0,this.D=this.N=this.F>>1}begin(){return new c(0,this)}end(){return new c(this.i,this)}rBegin(){return new c(this.i-1,this,1)}rEnd(){return new c(-1,this,1)}front(){if(this.i!==0)return this.A[this.j][this.D]}back(){if(this.i!==0)return this.A[this.R][this.N]}pushBack(r){return this.i&&(this.N<this.F-1?this.N+=1:this.R<this.P-1?(this.R+=1,this.N=0):(this.R=0,this.N=0),this.R===this.j&&this.N===this.D&&this.T()),this.i+=1,this.A[this.R][this.N]=r,this.i}popBack(){if(this.i===0)return;let r=this.A[this.R][this.N];return this.i!==1&&(this.N>0?this.N-=1:this.R>0?(this.R-=1,this.N=this.F-1):(this.R=this.P-1,this.N=this.F-1)),this.i-=1,r}pushFront(r){return this.i&&(this.D>0?this.D-=1:this.j>0?(this.j-=1,this.D=this.F-1):(this.j=this.P-1,this.D=this.F-1),this.j===this.R&&this.D===this.N&&this.T()),this.i+=1,this.A[this.j][this.D]=r,this.i}popFront(){if(this.i===0)return;let r=this.A[this.j][this.D];return this.i!==1&&(this.D<this.F-1?this.D+=1:this.j<this.P-1?(this.j+=1,this.D=0):(this.j=0,this.D=0)),this.i-=1,r}getElementByPos(r){if(r<0||r>this.i-1)throw new RangeError;let{curNodeBucketIndex:t,curNodePointerIndex:n}=this.O(r);return this.A[t][n]}setElementByPos(r,t){if(r<0||r>this.i-1)throw new RangeError;let{curNodeBucketIndex:n,curNodePointerIndex:l}=this.O(r);this.A[n][l]=t}insert(r,t,n=1){if(r<0||r>this.i)throw new RangeError;if(r===0)for(;n--;)this.pushFront(t);else if(r===this.i)for(;n--;)this.pushBack(t);else{let l=[];for(let d=r;d<this.i;++d)l.push(this.getElementByPos(d));this.cut(r-1);for(let d=0;d<n;++d)this.pushBack(t);for(let d=0;d<l.length;++d)this.pushBack(l[d])}return this.i}cut(r){if(r<0)return this.clear(),0;let{curNodeBucketIndex:t,curNodePointerIndex:n}=this.O(r);return this.R=t,this.N=n,this.i=r+1,this.i}eraseElementByPos(r){if(r<0||r>this.i-1)throw new RangeError;if(r===0)this.popFront();else if(r===this.i-1)this.popBack();else{let t=[];for(let l=r+1;l<this.i;++l)t.push(this.getElementByPos(l));this.cut(r),this.popBack();let n=this;t.forEach(function(l){n.pushBack(l)})}return this.i}eraseElementByValue(r){if(this.i===0)return 0;let t=[];for(let l=0;l<this.i;++l){let d=this.getElementByPos(l);d!==r&&t.push(d)}let n=t.length;for(let l=0;l<n;++l)this.setElementByPos(l,t[l]);return this.cut(n-1)}eraseElementByIterator(r){let t=r.o;return this.eraseElementByPos(t),r=r.next(),r}find(r){for(let t=0;t<this.i;++t)if(this.getElementByPos(t)===r)return new c(t,this);return this.end()}reverse(){let r=0,t=this.i-1;for(;r<t;){let n=this.getElementByPos(r);this.setElementByPos(r,this.getElementByPos(t)),this.setElementByPos(t,n),r+=1,t-=1}}unique(){if(this.i<=1)return this.i;let r=1,t=this.getElementByPos(0);for(let n=1;n<this.i;++n){let l=this.getElementByPos(n);l!==t&&(t=l,this.setElementByPos(r++,l))}for(;this.i>r;)this.popBack();return this.i}sort(r){let t=[];for(let n=0;n<this.i;++n)t.push(this.getElementByPos(n));t.sort(r);for(let n=0;n<this.i;++n)this.setElementByPos(n,t[n])}shrinkToFit(){if(this.i===0)return;let r=[];this.forEach(function(t){r.push(t)}),this.P=Math.max(Math.ceil(this.i/this.F),1),this.i=this.j=this.R=this.D=this.N=0,this.A=[];for(let t=0;t<this.P;++t)this.A.push(new Array(this.F));for(let t=0;t<r.length;++t)this.pushBack(r[t])}forEach(r){for(let t=0;t<this.i;++t)r(this.getElementByPos(t),t,this)}[Symbol.iterator](){return(function*(){for(let r=0;r<this.i;++r)yield this.getElementByPos(r)}).bind(this)()}},e=i;s.default=e}),ll=me(s=>{fe(),pe(),de(),Object.defineProperty(s,"t",{value:!0}),s.TreeNodeEnableIndex=s.TreeNode=void 0;var f=class{constructor(u,c){this.ee=1,this.u=void 0,this.l=void 0,this.U=void 0,this.W=void 0,this.tt=void 0,this.u=u,this.l=c}L(){let u=this;if(u.ee===1&&u.tt.tt===u)u=u.W;else if(u.U)for(u=u.U;u.W;)u=u.W;else{let c=u.tt;for(;c.U===u;)u=c,c=u.tt;u=c}return u}B(){let u=this;if(u.W){for(u=u.W;u.U;)u=u.U;return u}else{let c=u.tt;for(;c.W===u;)u=c,c=u.tt;return u.W!==c?c:u}}te(){let u=this.tt,c=this.W,i=c.U;return u.tt===this?u.tt=c:u.U===this?u.U=c:u.W=c,c.tt=u,c.U=this,this.tt=c,this.W=i,i&&(i.tt=this),c}se(){let u=this.tt,c=this.U,i=c.W;return u.tt===this?u.tt=c:u.U===this?u.U=c:u.W=c,c.tt=u,c.W=this,this.tt=c,this.U=i,i&&(i.tt=this),c}};s.TreeNode=f;var o=class extends f{constructor(){super(...arguments),this.rt=1}te(){let u=super.te();return this.ie(),u.ie(),u}se(){let u=super.se();return this.ie(),u.ie(),u}ie(){this.rt=1,this.U&&(this.rt+=this.U.rt),this.W&&(this.rt+=this.W.rt)}};s.TreeNodeEnableIndex=o}),ss=me(s=>{fe(),pe(),de(),Object.defineProperty(s,"t",{value:!0}),s.default=void 0;var f=ll(),o=Ot(),u=Pt(),c=class extends o.Container{constructor(e=function(t,n){return t<n?-1:t>n?1:0},r=!1){super(),this.Y=void 0,this.v=e,r?(this.re=f.TreeNodeEnableIndex,this.M=function(t,n,l){let d=this.ne(t,n,l);if(d){let p=d.tt;for(;p!==this.h;)p.rt+=1,p=p.tt;let b=this.he(d);if(b){let{parentNode:m,grandParent:w,curNode:E}=b;m.ie(),w.ie(),E.ie()}}return this.i},this.V=function(t){let n=this.fe(t);for(;n!==this.h;)n.rt-=1,n=n.tt}):(this.re=f.TreeNode,this.M=function(t,n,l){let d=this.ne(t,n,l);return d&&this.he(d),this.i},this.V=this.fe),this.h=new this.re}X(e,r){let t=this.h;for(;e;){let n=this.v(e.u,r);if(n<0)e=e.W;else if(n>0)t=e,e=e.U;else return e}return t}Z(e,r){let t=this.h;for(;e;)this.v(e.u,r)<=0?e=e.W:(t=e,e=e.U);return t}$(e,r){let t=this.h;for(;e;){let n=this.v(e.u,r);if(n<0)t=e,e=e.W;else if(n>0)e=e.U;else return e}return t}rr(e,r){let t=this.h;for(;e;)this.v(e.u,r)<0?(t=e,e=e.W):e=e.U;return t}ue(e){for(;;){let r=e.tt;if(r===this.h)return;if(e.ee===1){e.ee=0;return}if(e===r.U){let t=r.W;if(t.ee===1)t.ee=0,r.ee=1,r===this.Y?this.Y=r.te():r.te();else if(t.W&&t.W.ee===1){t.ee=r.ee,r.ee=0,t.W.ee=0,r===this.Y?this.Y=r.te():r.te();return}else t.U&&t.U.ee===1?(t.ee=1,t.U.ee=0,t.se()):(t.ee=1,e=r)}else{let t=r.U;if(t.ee===1)t.ee=0,r.ee=1,r===this.Y?this.Y=r.se():r.se();else if(t.U&&t.U.ee===1){t.ee=r.ee,r.ee=0,t.U.ee=0,r===this.Y?this.Y=r.se():r.se();return}else t.W&&t.W.ee===1?(t.ee=1,t.W.ee=0,t.te()):(t.ee=1,e=r)}}}fe(e){if(this.i===1)return this.clear(),this.h;let r=e;for(;r.U||r.W;){if(r.W)for(r=r.W;r.U;)r=r.U;else r=r.U;[e.u,r.u]=[r.u,e.u],[e.l,r.l]=[r.l,e.l],e=r}this.h.U===r?this.h.U=r.tt:this.h.W===r&&(this.h.W=r.tt),this.ue(r);let t=r.tt;return r===t.U?t.U=void 0:t.W=void 0,this.i-=1,this.Y.ee=0,t}oe(e,r){return e===void 0?!1:this.oe(e.U,r)||r(e)?!0:this.oe(e.W,r)}he(e){for(;;){let r=e.tt;if(r.ee===0)return;let t=r.tt;if(r===t.U){let n=t.W;if(n&&n.ee===1){if(n.ee=r.ee=0,t===this.Y)return;t.ee=1,e=t;continue}else if(e===r.W){if(e.ee=0,e.U&&(e.U.tt=r),e.W&&(e.W.tt=t),r.W=e.U,t.U=e.W,e.U=r,e.W=t,t===this.Y)this.Y=e,this.h.tt=e;else{let l=t.tt;l.U===t?l.U=e:l.W=e}return e.tt=t.tt,r.tt=e,t.tt=e,t.ee=1,{parentNode:r,grandParent:t,curNode:e}}else r.ee=0,t===this.Y?this.Y=t.se():t.se(),t.ee=1}else{let n=t.U;if(n&&n.ee===1){if(n.ee=r.ee=0,t===this.Y)return;t.ee=1,e=t;continue}else if(e===r.U){if(e.ee=0,e.U&&(e.U.tt=t),e.W&&(e.W.tt=r),t.W=e.U,r.U=e.W,e.U=t,e.W=r,t===this.Y)this.Y=e,this.h.tt=e;else{let l=t.tt;l.U===t?l.U=e:l.W=e}return e.tt=t.tt,r.tt=e,t.tt=e,t.ee=1,{parentNode:r,grandParent:t,curNode:e}}else r.ee=0,t===this.Y?this.Y=t.te():t.te(),t.ee=1}return}}ne(e,r,t){if(this.Y===void 0){this.i+=1,this.Y=new this.re(e,r),this.Y.ee=0,this.Y.tt=this.h,this.h.tt=this.Y,this.h.U=this.Y,this.h.W=this.Y;return}let n,l=this.h.U,d=this.v(l.u,e);if(d===0){l.l=r;return}else if(d>0)l.U=new this.re(e,r),l.U.tt=l,n=l.U,this.h.U=n;else{let p=this.h.W,b=this.v(p.u,e);if(b===0){p.l=r;return}else if(b<0)p.W=new this.re(e,r),p.W.tt=p,n=p.W,this.h.W=n;else{if(t!==void 0){let m=t.o;if(m!==this.h){let w=this.v(m.u,e);if(w===0){m.l=r;return}else if(w>0){let E=m.L(),I=this.v(E.u,e);if(I===0){E.l=r;return}else I<0&&(n=new this.re(e,r),E.W===void 0?(E.W=n,n.tt=E):(m.U=n,n.tt=m))}}}if(n===void 0)for(n=this.Y;;){let m=this.v(n.u,e);if(m>0){if(n.U===void 0){n.U=new this.re(e,r),n.U.tt=n,n=n.U;break}n=n.U}else if(m<0){if(n.W===void 0){n.W=new this.re(e,r),n.W.tt=n,n=n.W;break}n=n.W}else{n.l=r;return}}}}return this.i+=1,n}I(e,r){for(;e;){let t=this.v(e.u,r);if(t<0)e=e.W;else if(t>0)e=e.U;else return e}return e||this.h}clear(){this.i=0,this.Y=void 0,this.h.tt=void 0,this.h.U=this.h.W=void 0}updateKeyByIterator(e,r){let t=e.o;if(t===this.h&&(0,u.throwIteratorAccessError)(),this.i===1)return t.u=r,!0;if(t===this.h.U)return this.v(t.B().u,r)>0?(t.u=r,!0):!1;if(t===this.h.W)return this.v(t.L().u,r)<0?(t.u=r,!0):!1;let n=t.L().u;if(this.v(n,r)>=0)return!1;let l=t.B().u;return this.v(l,r)<=0?!1:(t.u=r,!0)}eraseElementByPos(e){if(e<0||e>this.i-1)throw new RangeError;let r=0,t=this;return this.oe(this.Y,function(n){return e===r?(t.V(n),!0):(r+=1,!1)}),this.i}eraseElementByKey(e){if(this.i===0)return!1;let r=this.I(this.Y,e);return r===this.h?!1:(this.V(r),!0)}eraseElementByIterator(e){let r=e.o;r===this.h&&(0,u.throwIteratorAccessError)();let t=r.W===void 0;return e.iteratorType===0?t&&e.next():(!t||r.U===void 0)&&e.next(),this.V(r),e}forEach(e){let r=0;for(let t of this)e(t,r++,this)}getElementByPos(e){if(e<0||e>this.i-1)throw new RangeError;let r,t=0;for(let n of this){if(t===e){r=n;break}t+=1}return r}getHeight(){if(this.i===0)return 0;let e=function(r){return r?Math.max(e(r.U),e(r.W))+1:0};return e(this.Y)}},i=c;s.default=i}),as=me(s=>{fe(),pe(),de(),Object.defineProperty(s,"t",{value:!0}),s.default=void 0;var f=Ot(),o=Pt(),u=class extends f.ContainerIterator{constructor(i,e,r){super(r),this.o=i,this.h=e,this.iteratorType===0?(this.pre=function(){return this.o===this.h.U&&(0,o.throwIteratorAccessError)(),this.o=this.o.L(),this},this.next=function(){return this.o===this.h&&(0,o.throwIteratorAccessError)(),this.o=this.o.B(),this}):(this.pre=function(){return this.o===this.h.W&&(0,o.throwIteratorAccessError)(),this.o=this.o.B(),this},this.next=function(){return this.o===this.h&&(0,o.throwIteratorAccessError)(),this.o=this.o.L(),this})}get index(){let i=this.o,e=this.h.tt;if(i===this.h)return e?e.rt-1:0;let r=0;for(i.U&&(r+=i.U.rt);i!==e;){let t=i.tt;i===t.W&&(r+=1,t.U&&(r+=t.U.rt)),i=t}return r}},c=u;s.default=c}),ul=me(s=>{fe(),pe(),de(),Object.defineProperty(s,"t",{value:!0}),s.default=void 0;var f=c(ss()),o=c(as()),u=Pt();function c(t){return t&&t.t?t:{default:t}}var i=class ls extends o.default{constructor(n,l,d,p){super(n,l,p),this.container=d}get pointer(){return this.o===this.h&&(0,u.throwIteratorAccessError)(),this.o.u}copy(){return new ls(this.o,this.h,this.container,this.iteratorType)}},e=class extends f.default{constructor(t=[],n,l){super(n,l);let d=this;t.forEach(function(p){d.insert(p)})}*K(t){t!==void 0&&(yield*this.K(t.U),yield t.u,yield*this.K(t.W))}begin(){return new i(this.h.U||this.h,this.h,this)}end(){return new i(this.h,this.h,this)}rBegin(){return new i(this.h.W||this.h,this.h,this,1)}rEnd(){return new i(this.h,this.h,this,1)}front(){return this.h.U?this.h.U.u:void 0}back(){return this.h.W?this.h.W.u:void 0}insert(t,n){return this.M(t,void 0,n)}find(t){let n=this.I(this.Y,t);return new i(n,this.h,this)}lowerBound(t){let n=this.X(this.Y,t);return new i(n,this.h,this)}upperBound(t){let n=this.Z(this.Y,t);return new i(n,this.h,this)}reverseLowerBound(t){let n=this.$(this.Y,t);return new i(n,this.h,this)}reverseUpperBound(t){let n=this.rr(this.Y,t);return new i(n,this.h,this)}union(t){let n=this;return t.forEach(function(l){n.insert(l)}),this.i}[Symbol.iterator](){return this.K(this.Y)}},r=e;s.default=r}),hl=me(s=>{fe(),pe(),de(),Object.defineProperty(s,"t",{value:!0}),s.default=void 0;var f=c(ss()),o=c(as()),u=Pt();function c(t){return t&&t.t?t:{default:t}}var i=class us extends o.default{constructor(n,l,d,p){super(n,l,p),this.container=d}get pointer(){this.o===this.h&&(0,u.throwIteratorAccessError)();let n=this;return new Proxy([],{get(l,d){if(d==="0")return n.o.u;if(d==="1")return n.o.l},set(l,d,p){if(d!=="1")throw new TypeError("props must be 1");return n.o.l=p,!0}})}copy(){return new us(this.o,this.h,this.container,this.iteratorType)}},e=class extends f.default{constructor(t=[],n,l){super(n,l);let d=this;t.forEach(function(p){d.setElement(p[0],p[1])})}*K(t){t!==void 0&&(yield*this.K(t.U),yield[t.u,t.l],yield*this.K(t.W))}begin(){return new i(this.h.U||this.h,this.h,this)}end(){return new i(this.h,this.h,this)}rBegin(){return new i(this.h.W||this.h,this.h,this,1)}rEnd(){return new i(this.h,this.h,this,1)}front(){if(this.i===0)return;let t=this.h.U;return[t.u,t.l]}back(){if(this.i===0)return;let t=this.h.W;return[t.u,t.l]}lowerBound(t){let n=this.X(this.Y,t);return new i(n,this.h,this)}upperBound(t){let n=this.Z(this.Y,t);return new i(n,this.h,this)}reverseLowerBound(t){let n=this.$(this.Y,t);return new i(n,this.h,this)}reverseUpperBound(t){let n=this.rr(this.Y,t);return new i(n,this.h,this)}setElement(t,n,l){return this.M(t,n,l)}find(t){let n=this.I(this.Y,t);return new i(n,this.h,this)}getElementByKey(t){return this.I(this.Y,t).l}union(t){let n=this;return t.forEach(function(l){n.setElement(l[0],l[1])}),this.i}[Symbol.iterator](){return this.K(this.Y)}},r=e;s.default=r}),hs=me(s=>{fe(),pe(),de(),Object.defineProperty(s,"t",{value:!0}),s.default=f;function f(o){let u=typeof o;return u==="object"&&o!==null||u==="function"}}),cs=me(s=>{fe(),pe(),de(),Object.defineProperty(s,"t",{value:!0}),s.HashContainerIterator=s.HashContainer=void 0;var f=Ot(),o=c(hs()),u=Pt();function c(r){return r&&r.t?r:{default:r}}var i=class extends f.ContainerIterator{constructor(r,t,n){super(n),this.o=r,this.h=t,this.iteratorType===0?(this.pre=function(){return this.o.L===this.h&&(0,u.throwIteratorAccessError)(),this.o=this.o.L,this},this.next=function(){return this.o===this.h&&(0,u.throwIteratorAccessError)(),this.o=this.o.B,this}):(this.pre=function(){return this.o.B===this.h&&(0,u.throwIteratorAccessError)(),this.o=this.o.B,this},this.next=function(){return this.o===this.h&&(0,u.throwIteratorAccessError)(),this.o=this.o.L,this})}};s.HashContainerIterator=i;var e=class extends f.Container{constructor(){super(),this.H=[],this.g={},this.HASH_TAG=Symbol("@@HASH_TAG"),Object.setPrototypeOf(this.g,null),this.h={},this.h.L=this.h.B=this.p=this._=this.h}V(r){let{L:t,B:n}=r;t.B=n,n.L=t,r===this.p&&(this.p=n),r===this._&&(this._=t),this.i-=1}M(r,t,n){n===void 0&&(n=(0,o.default)(r));let l;if(n){let d=r[this.HASH_TAG];if(d!==void 0)return this.H[d].l=t,this.i;Object.defineProperty(r,this.HASH_TAG,{value:this.H.length,configurable:!0}),l={u:r,l:t,L:this._,B:this.h},this.H.push(l)}else{let d=this.g[r];if(d)return d.l=t,this.i;l={u:r,l:t,L:this._,B:this.h},this.g[r]=l}return this.i===0?(this.p=l,this.h.B=l):this._.B=l,this._=l,this.h.L=l,++this.i}I(r,t){if(t===void 0&&(t=(0,o.default)(r)),t){let n=r[this.HASH_TAG];return n===void 0?this.h:this.H[n]}else return this.g[r]||this.h}clear(){let r=this.HASH_TAG;this.H.forEach(function(t){delete t.u[r]}),this.H=[],this.g={},Object.setPrototypeOf(this.g,null),this.i=0,this.p=this._=this.h.L=this.h.B=this.h}eraseElementByKey(r,t){let n;if(t===void 0&&(t=(0,o.default)(r)),t){let l=r[this.HASH_TAG];if(l===void 0)return!1;delete r[this.HASH_TAG],n=this.H[l],delete this.H[l]}else{if(n=this.g[r],n===void 0)return!1;delete this.g[r]}return this.V(n),!0}eraseElementByIterator(r){let t=r.o;return t===this.h&&(0,u.throwIteratorAccessError)(),this.V(t),r.next()}eraseElementByPos(r){if(r<0||r>this.i-1)throw new RangeError;let t=this.p;for(;r--;)t=t.B;return this.V(t),this.i}};s.HashContainer=e}),cl=me(s=>{fe(),pe(),de(),Object.defineProperty(s,"t",{value:!0}),s.default=void 0;var f=cs(),o=Pt(),u=class fs extends f.HashContainerIterator{constructor(r,t,n,l){super(r,t,l),this.container=n}get pointer(){return this.o===this.h&&(0,o.throwIteratorAccessError)(),this.o.u}copy(){return new fs(this.o,this.h,this.container,this.iteratorType)}},c=class extends f.HashContainer{constructor(e=[]){super();let r=this;e.forEach(function(t){r.insert(t)})}begin(){return new u(this.p,this.h,this)}end(){return new u(this.h,this.h,this)}rBegin(){return new u(this._,this.h,this,1)}rEnd(){return new u(this.h,this.h,this,1)}front(){return this.p.u}back(){return this._.u}insert(e,r){return this.M(e,void 0,r)}getElementByPos(e){if(e<0||e>this.i-1)throw new RangeError;let r=this.p;for(;e--;)r=r.B;return r.u}find(e,r){let t=this.I(e,r);return new u(t,this.h,this)}forEach(e){let r=0,t=this.p;for(;t!==this.h;)e(t.u,r++,this),t=t.B}[Symbol.iterator](){return(function*(){let e=this.p;for(;e!==this.h;)yield e.u,e=e.B}).bind(this)()}},i=c;s.default=i}),fl=me(s=>{fe(),pe(),de(),Object.defineProperty(s,"t",{value:!0}),s.default=void 0;var f=cs(),o=c(hs()),u=Pt();function c(t){return t&&t.t?t:{default:t}}var i=class ds extends f.HashContainerIterator{constructor(n,l,d,p){super(n,l,p),this.container=d}get pointer(){this.o===this.h&&(0,u.throwIteratorAccessError)();let n=this;return new Proxy([],{get(l,d){if(d==="0")return n.o.u;if(d==="1")return n.o.l},set(l,d,p){if(d!=="1")throw new TypeError("props must be 1");return n.o.l=p,!0}})}copy(){return new ds(this.o,this.h,this.container,this.iteratorType)}},e=class extends f.HashContainer{constructor(t=[]){super();let n=this;t.forEach(function(l){n.setElement(l[0],l[1])})}begin(){return new i(this.p,this.h,this)}end(){return new i(this.h,this.h,this)}rBegin(){return new i(this._,this.h,this,1)}rEnd(){return new i(this.h,this.h,this,1)}front(){if(this.i!==0)return[this.p.u,this.p.l]}back(){if(this.i!==0)return[this._.u,this._.l]}setElement(t,n,l){return this.M(t,n,l)}getElementByKey(t,n){if(n===void 0&&(n=(0,o.default)(t)),n){let d=t[this.HASH_TAG];return d!==void 0?this.H[d].l:void 0}let l=this.g[t];return l?l.l:void 0}getElementByPos(t){if(t<0||t>this.i-1)throw new RangeError;let n=this.p;for(;t--;)n=n.B;return[n.u,n.l]}find(t,n){let l=this.I(t,n);return new i(l,this.h,this)}forEach(t){let n=0,l=this.p;for(;l!==this.h;)t([l.u,l.l],n++,this),l=l.B}[Symbol.iterator](){return(function*(){let t=this.p;for(;t!==this.h;)yield[t.u,t.l],t=t.B}).bind(this)()}},r=e;s.default=r}),dl=me(s=>{fe(),pe(),de(),Object.defineProperty(s,"t",{value:!0}),Object.defineProperty(s,"Deque",{enumerable:!0,get:function(){return e.default}}),Object.defineProperty(s,"HashMap",{enumerable:!0,get:function(){return l.default}}),Object.defineProperty(s,"HashSet",{enumerable:!0,get:function(){return n.default}}),Object.defineProperty(s,"LinkList",{enumerable:!0,get:function(){return i.default}}),Object.defineProperty(s,"OrderedMap",{enumerable:!0,get:function(){return t.default}}),Object.defineProperty(s,"OrderedSet",{enumerable:!0,get:function(){return r.default}}),Object.defineProperty(s,"PriorityQueue",{enumerable:!0,get:function(){return u.default}}),Object.defineProperty(s,"Queue",{enumerable:!0,get:function(){return o.default}}),Object.defineProperty(s,"Stack",{enumerable:!0,get:function(){return f.default}}),Object.defineProperty(s,"Vector",{enumerable:!0,get:function(){return c.default}});var f=d(rl()),o=d(il()),u=d(nl()),c=d(ol()),i=d(sl()),e=d(al()),r=d(ul()),t=d(hl()),n=d(cl()),l=d(fl());function d(p){return p&&p.t?p:{default:p}}}),pl=me((s,f)=>{fe(),pe(),de();var o=dl().OrderedSet,u=kt()("number-allocator:trace"),c=kt()("number-allocator:error");function i(r,t){this.low=r,this.high=t}i.prototype.equals=function(r){return this.low===r.low&&this.high===r.high},i.prototype.compare=function(r){return this.low<r.low&&this.high<r.low?-1:r.low<this.low&&r.high<this.low?1:0};function e(r,t){if(!(this instanceof e))return new e(r,t);this.min=r,this.max=t,this.ss=new o([],(n,l)=>n.compare(l)),u("Create"),this.clear()}e.prototype.firstVacant=function(){return this.ss.size()===0?null:this.ss.front().low},e.prototype.alloc=function(){if(this.ss.size()===0)return u("alloc():empty"),null;let r=this.ss.begin(),t=r.pointer.low,n=r.pointer.high,l=t;return l+1<=n?this.ss.updateKeyByIterator(r,new i(t+1,n)):this.ss.eraseElementByPos(0),u("alloc():"+l),l},e.prototype.use=function(r){let t=new i(r,r),n=this.ss.lowerBound(t);if(!n.equals(this.ss.end())){let l=n.pointer.low,d=n.pointer.high;return n.pointer.equals(t)?(this.ss.eraseElementByIterator(n),u("use():"+r),!0):l>r?!1:l===r?(this.ss.updateKeyByIterator(n,new i(l+1,d)),u("use():"+r),!0):d===r?(this.ss.updateKeyByIterator(n,new i(l,d-1)),u("use():"+r),!0):(this.ss.updateKeyByIterator(n,new i(r+1,d)),this.ss.insert(new i(l,r-1)),u("use():"+r),!0)}return u("use():failed"),!1},e.prototype.free=function(r){if(r<this.min||r>this.max){c("free():"+r+" is out of range");return}let t=new i(r,r),n=this.ss.upperBound(t);if(n.equals(this.ss.end())){if(n.equals(this.ss.begin())){this.ss.insert(t);return}n.pre();let l=n.pointer.high;n.pointer.high+1===r?this.ss.updateKeyByIterator(n,new i(l,r)):this.ss.insert(t)}else if(n.equals(this.ss.begin()))if(r+1===n.pointer.low){let l=n.pointer.high;this.ss.updateKeyByIterator(n,new i(r,l))}else this.ss.insert(t);else{let l=n.pointer.low,d=n.pointer.high;n.pre();let p=n.pointer.low;n.pointer.high+1===r?r+1===l?(this.ss.eraseElementByIterator(n),this.ss.updateKeyByIterator(n,new i(p,d))):this.ss.updateKeyByIterator(n,new i(p,r)):r+1===l?(this.ss.eraseElementByIterator(n.next()),this.ss.insert(new i(r,d))):this.ss.insert(t)}u("free():"+r)},e.prototype.clear=function(){u("clear()"),this.ss.clear(),this.ss.insert(new i(this.min,this.max))},e.prototype.intervalCount=function(){return this.ss.size()},e.prototype.dump=function(){console.log("length:"+this.ss.size());for(let r of this.ss)console.log(r)},f.exports=e}),ps=me((s,f)=>{fe(),pe(),de();var o=pl();f.exports.NumberAllocator=o}),gl=me(s=>{fe(),pe(),de(),Object.defineProperty(s,"__esModule",{value:!0});var f=tl(),o=ps(),u=class{constructor(c){c>0&&(this.aliasToTopic=new f.LRUCache({max:c}),this.topicToAlias={},this.numberAllocator=new o.NumberAllocator(1,c),this.max=c,this.length=0)}put(c,i){if(i===0||i>this.max)return!1;let e=this.aliasToTopic.get(i);return e&&delete this.topicToAlias[e],this.aliasToTopic.set(i,c),this.topicToAlias[c]=i,this.numberAllocator.use(i),this.length=this.aliasToTopic.size,!0}getTopicByAlias(c){return this.aliasToTopic.get(c)}getAliasByTopic(c){let i=this.topicToAlias[c];return typeof i<"u"&&this.aliasToTopic.get(i),i}clear(){this.aliasToTopic.clear(),this.topicToAlias={},this.numberAllocator.clear(),this.length=0}getLruAlias(){return this.numberAllocator.firstVacant()||[...this.aliasToTopic.keys()][this.aliasToTopic.size-1]}};s.default=u}),bl=me(s=>{fe(),pe(),de();var f=s&&s.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(s,"__esModule",{value:!0});var o=Dr(),u=f(gl()),c=nr(),i=(e,r)=>{e.log("_handleConnack");let{options:t}=e,n=t.protocolVersion===5?r.reasonCode:r.returnCode;if(clearTimeout(e.connackTimer),delete e.topicAliasSend,r.properties){if(r.properties.topicAliasMaximum){if(r.properties.topicAliasMaximum>65535){e.emit("error",new Error("topicAliasMaximum from broker is out of range"));return}r.properties.topicAliasMaximum>0&&(e.topicAliasSend=new u.default(r.properties.topicAliasMaximum))}r.properties.serverKeepAlive&&t.keepalive&&(t.keepalive=r.properties.serverKeepAlive),r.properties.maximumPacketSize&&(t.properties||(t.properties={}),t.properties.maximumPacketSize=r.properties.maximumPacketSize)}if(n===0)e.reconnecting=!1,e._onConnect(r);else if(n>0){let l=new c.ErrorWithReasonCode(`Connection refused: ${o.ReasonCodes[n]}`,n);e.emit("error",l),e.options.reconnectOnConnackError&&e._cleanUp(!0)}};s.default=i}),ml=me(s=>{fe(),pe(),de(),Object.defineProperty(s,"__esModule",{value:!0});var f=(o,u,c)=>{o.log("handling pubrel packet");let i=typeof c<"u"?c:o.noop,{messageId:e}=u,r={cmd:"pubcomp",messageId:e};o.incomingStore.get(u,(t,n)=>{t?o._sendPacket(r,i):(o.emit("message",n.topic,n.payload,n),o.handleMessage(n,l=>{if(l)return i(l);o.incomingStore.del(n,o.noop),o._sendPacket(r,i)}))})};s.default=f}),yl=me(s=>{fe(),pe(),de();var f=s&&s.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(s,"__esModule",{value:!0});var o=f(Xa()),u=f(el()),c=f(bl()),i=f(Dr()),e=f(ml()),r=(t,n,l)=>{let{options:d}=t;if(d.protocolVersion===5&&d.properties&&d.properties.maximumPacketSize&&d.properties.maximumPacketSize<n.length)return t.emit("error",new Error(`exceeding packets size ${n.cmd}`)),t.end({reasonCode:149,properties:{reasonString:"Maximum packet size was exceeded"}}),t;switch(t.log("_handlePacket :: emitting packetreceive"),t.emit("packetreceive",n),n.cmd){case"publish":(0,o.default)(t,n,l);break;case"puback":case"pubrec":case"pubcomp":case"suback":case"unsuback":t.reschedulePing(),(0,i.default)(t,n),l();break;case"pubrel":t.reschedulePing(),(0,e.default)(t,n,l);break;case"connack":(0,c.default)(t,n),l();break;case"auth":t.reschedulePing(),(0,u.default)(t,n),l();break;case"pingresp":t.log("_handlePacket :: received pingresp"),t.reschedulePing(!0),l();break;case"disconnect":t.emit("disconnect",n),l();break;default:t.log("_handlePacket :: unknown command"),l();break}};s.default=r}),wl=me(s=>{fe(),pe(),de();var f=s&&s.__importDefault||function(i){return i&&i.__esModule?i:{default:i}};Object.defineProperty(s,"__esModule",{value:!0}),s.TypedEventEmitter=void 0;var o=f((Yt(),Ne(Ut))),u=nr(),c=class{};s.TypedEventEmitter=c,(0,u.applyMixin)(c,o.default)}),Fr=me(s=>{fe(),pe(),de(),Object.defineProperty(s,"__esModule",{value:!0}),s.isReactNativeBrowser=s.isWebWorker=void 0;var f=()=>{var i;return typeof window<"u"?typeof navigator<"u"&&((i=navigator.userAgent)===null||i===void 0?void 0:i.toLowerCase().indexOf(" electron/"))>-1&&Me!=null&&Me.versions?!Object.prototype.hasOwnProperty.call(Me.versions,"electron"):typeof window.document<"u":!1},o=()=>{var i,e;return!!(typeof self=="object"&&!((e=(i=self==null?void 0:self.constructor)===null||i===void 0?void 0:i.name)===null||e===void 0)&&e.includes("WorkerGlobalScope"))},u=()=>typeof navigator<"u"&&navigator.product==="ReactNative",c=f()||o()||u();s.isWebWorker=o(),s.isReactNativeBrowser=u(),s.default=c}),vl=me((s,f)=>{fe(),pe(),de(),function(o,u){typeof s=="object"&&typeof f<"u"?u(s):typeof define=="function"&&define.amd?define(["exports"],u):(o=typeof globalThis<"u"?globalThis:o||self,u(o.fastUniqueNumbers={}))}(s,function(o){var u=function(b){return function(m){var w=b(m);return m.add(w),w}},c=function(b){return function(m,w){return b.set(m,w),w}},i=Number.MAX_SAFE_INTEGER===void 0?9007199254740991:Number.MAX_SAFE_INTEGER,e=536870912,r=e*2,t=function(b,m){return function(w){var E=m.get(w),I=E===void 0?w.size:E<r?E+1:0;if(!w.has(I))return b(w,I);if(w.size<e){for(;w.has(I);)I=Math.floor(Math.random()*r);return b(w,I)}if(w.size>i)throw new Error("Congratulations, you created a collection of unique numbers which uses all available integers!");for(;w.has(I);)I=Math.floor(Math.random()*i);return b(w,I)}},n=new WeakMap,l=c(n),d=t(l,n),p=u(d);o.addUniqueNumber=p,o.generateUniqueNumber=d})}),_l=me((s,f)=>{fe(),pe(),de(),function(o,u){typeof s=="object"&&typeof f<"u"?u(s,vl()):typeof define=="function"&&define.amd?define(["exports","fast-unique-numbers"],u):(o=typeof globalThis<"u"?globalThis:o||self,u(o.workerTimersBroker={},o.fastUniqueNumbers))}(s,function(o,u){var c=function(r){return r.method!==void 0&&r.method==="call"},i=function(r){return r.error===null&&typeof r.id=="number"},e=function(r){var t=new Map([[0,function(){}]]),n=new Map([[0,function(){}]]),l=new Map,d=new Worker(r);d.addEventListener("message",function(E){var I=E.data;if(c(I)){var y=I.params,_=y.timerId,N=y.timerType;if(N==="interval"){var B=t.get(_);if(typeof B=="number"){var A=l.get(B);if(A===void 0||A.timerId!==_||A.timerType!==N)throw new Error("The timer is in an undefined state.")}else if(typeof B<"u")B();else throw new Error("The timer is in an undefined state.")}else if(N==="timeout"){var k=n.get(_);if(typeof k=="number"){var M=l.get(k);if(M===void 0||M.timerId!==_||M.timerType!==N)throw new Error("The timer is in an undefined state.")}else if(typeof k<"u")k(),n.delete(_);else throw new Error("The timer is in an undefined state.")}}else if(i(I)){var J=I.id,X=l.get(J);if(X===void 0)throw new Error("The timer is in an undefined state.");var ue=X.timerId,C=X.timerType;l.delete(J),C==="interval"?t.delete(ue):n.delete(ue)}else{var q=I.error.message;throw new Error(q)}});var p=function(E){var I=u.generateUniqueNumber(l);l.set(I,{timerId:E,timerType:"interval"}),t.set(E,I),d.postMessage({id:I,method:"clear",params:{timerId:E,timerType:"interval"}})},b=function(E){var I=u.generateUniqueNumber(l);l.set(I,{timerId:E,timerType:"timeout"}),n.set(E,I),d.postMessage({id:I,method:"clear",params:{timerId:E,timerType:"timeout"}})},m=function(E){var I=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,y=u.generateUniqueNumber(t);return t.set(y,function(){E(),typeof t.get(y)=="function"&&d.postMessage({id:null,method:"set",params:{delay:I,now:performance.now(),timerId:y,timerType:"interval"}})}),d.postMessage({id:null,method:"set",params:{delay:I,now:performance.now(),timerId:y,timerType:"interval"}}),y},w=function(E){var I=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,y=u.generateUniqueNumber(n);return n.set(y,E),d.postMessage({id:null,method:"set",params:{delay:I,now:performance.now(),timerId:y,timerType:"timeout"}}),y};return{clearInterval:p,clearTimeout:b,setInterval:m,setTimeout:w}};o.load=e})}),El=me((s,f)=>{fe(),pe(),de(),function(o,u){typeof s=="object"&&typeof f<"u"?u(s,_l()):typeof define=="function"&&define.amd?define(["exports","worker-timers-broker"],u):(o=typeof globalThis<"u"?globalThis:o||self,u(o.workerTimers={},o.workerTimersBroker))}(s,function(o,u){var c=function(d,p){var b=null;return function(){if(b!==null)return b;var m=new Blob([p],{type:"application/javascript; charset=utf-8"}),w=URL.createObjectURL(m);return b=d(w),setTimeout(function(){return URL.revokeObjectURL(w)}),b}},i=`(()=>{var e={472:(e,t,r)=>{var o,i;void 0===(i="function"==typeof(o=function(){"use strict";var e=new Map,t=new Map,r=function(t){var r=e.get(t);if(void 0===r)throw new Error('There is no interval scheduled with the given id "'.concat(t,'".'));clearTimeout(r),e.delete(t)},o=function(e){var r=t.get(e);if(void 0===r)throw new Error('There is no timeout scheduled with the given id "'.concat(e,'".'));clearTimeout(r),t.delete(e)},i=function(e,t){var r,o=performance.now();return{expected:o+(r=e-Math.max(0,o-t)),remainingDelay:r}},n=function e(t,r,o,i){var n=performance.now();n>o?postMessage({id:null,method:"call",params:{timerId:r,timerType:i}}):t.set(r,setTimeout(e,o-n,t,r,o,i))},a=function(t,r,o){var a=i(t,o),s=a.expected,d=a.remainingDelay;e.set(r,setTimeout(n,d,e,r,s,"interval"))},s=function(e,r,o){var a=i(e,o),s=a.expected,d=a.remainingDelay;t.set(r,setTimeout(n,d,t,r,s,"timeout"))};addEventListener("message",(function(e){var t=e.data;try{if("clear"===t.method){var i=t.id,n=t.params,d=n.timerId,c=n.timerType;if("interval"===c)r(d),postMessage({error:null,id:i});else{if("timeout"!==c)throw new Error('The given type "'.concat(c,'" is not supported'));o(d),postMessage({error:null,id:i})}}else{if("set"!==t.method)throw new Error('The given method "'.concat(t.method,'" is not supported'));var u=t.params,l=u.delay,p=u.now,m=u.timerId,v=u.timerType;if("interval"===v)a(l,m,p);else{if("timeout"!==v)throw new Error('The given type "'.concat(v,'" is not supported'));s(l,m,p)}}}catch(e){postMessage({error:{message:e.message},id:t.id,result:null})}}))})?o.call(t,r,t,e):o)||(e.exports=i)}},t={};function r(o){var i=t[o];if(void 0!==i)return i.exports;var n=t[o]={exports:{}};return e[o](n,n.exports,r),n.exports}r.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return r.d(t,{a:t}),t},r.d=(e,t)=>{for(var o in t)r.o(t,o)&&!r.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{"use strict";r(472)})()})();`,e=c(u.load,i),r=function(d){return e().clearInterval(d)},t=function(d){return e().clearTimeout(d)},n=function(){var d;return(d=e()).setInterval.apply(d,arguments)},l=function(){var d;return(d=e()).setTimeout.apply(d,arguments)};o.clearInterval=r,o.clearTimeout=t,o.setInterval=n,o.setTimeout=l})}),Sl=me(s=>{fe(),pe(),de();var f=s&&s.__createBinding||(Object.create?function(n,l,d,p){p===void 0&&(p=d);var b=Object.getOwnPropertyDescriptor(l,d);(!b||("get"in b?!l.__esModule:b.writable||b.configurable))&&(b={enumerable:!0,get:function(){return l[d]}}),Object.defineProperty(n,p,b)}:function(n,l,d,p){p===void 0&&(p=d),n[p]=l[d]}),o=s&&s.__setModuleDefault||(Object.create?function(n,l){Object.defineProperty(n,"default",{enumerable:!0,value:l})}:function(n,l){n.default=l}),u=s&&s.__importStar||function(){var n=function(l){return n=Object.getOwnPropertyNames||function(d){var p=[];for(var b in d)Object.prototype.hasOwnProperty.call(d,b)&&(p[p.length]=b);return p},n(l)};return function(l){if(l&&l.__esModule)return l;var d={};if(l!=null)for(var p=n(l),b=0;b<p.length;b++)p[b]!=="default"&&f(d,l,p[b]);return o(d,l),d}}();Object.defineProperty(s,"__esModule",{value:!0});var c=u(Fr()),i=El(),e={set:i.setInterval,clear:i.clearInterval},r={set:(n,l)=>setInterval(n,l),clear:n=>clearInterval(n)},t=n=>{switch(n){case"native":return r;case"worker":return e;case"auto":default:return c.default&&!c.isWebWorker&&!c.isReactNativeBrowser?e:r}};s.default=t}),gs=me(s=>{fe(),pe(),de();var f=s&&s.__importDefault||function(c){return c&&c.__esModule?c:{default:c}};Object.defineProperty(s,"__esModule",{value:!0});var o=f(Sl()),u=class{get keepaliveTimeoutTimestamp(){return this._keepaliveTimeoutTimestamp}get intervalEvery(){return this._intervalEvery}get keepalive(){return this._keepalive}constructor(c,i){this.destroyed=!1,this.client=c,this.timer=typeof i=="object"&&"set"in i&&"clear"in i?i:(0,o.default)(i),this.setKeepalive(c.options.keepalive)}clear(){this.timerId&&(this.timer.clear(this.timerId),this.timerId=null)}setKeepalive(c){if(c*=1e3,isNaN(c)||c<=0||c>2147483647)throw new Error(`Keepalive value must be an integer between 0 and 2147483647. Provided value is ${c}`);this._keepalive=c,this.reschedule(),this.client.log(`KeepaliveManager: set keepalive to ${c}ms`)}destroy(){this.clear(),this.destroyed=!0}reschedule(){if(this.destroyed)return;this.clear(),this.counter=0;let c=Math.ceil(this._keepalive*1.5);this._keepaliveTimeoutTimestamp=Date.now()+c,this._intervalEvery=Math.ceil(this._keepalive/2),this.timerId=this.timer.set(()=>{this.destroyed||(this.counter+=1,this.counter===2?this.client.sendPing():this.counter>2&&this.client.onKeepaliveTimeout())},this._intervalEvery)}};s.default=u}),yn=me(s=>{fe(),pe(),de();var f=s&&s.__createBinding||(Object.create?function(B,A,k,M){M===void 0&&(M=k);var J=Object.getOwnPropertyDescriptor(A,k);(!J||("get"in J?!A.__esModule:J.writable||J.configurable))&&(J={enumerable:!0,get:function(){return A[k]}}),Object.defineProperty(B,M,J)}:function(B,A,k,M){M===void 0&&(M=k),B[M]=A[k]}),o=s&&s.__setModuleDefault||(Object.create?function(B,A){Object.defineProperty(B,"default",{enumerable:!0,value:A})}:function(B,A){B.default=A}),u=s&&s.__importStar||function(){var B=function(A){return B=Object.getOwnPropertyNames||function(k){var M=[];for(var J in k)Object.prototype.hasOwnProperty.call(k,J)&&(M[M.length]=J);return M},B(A)};return function(A){if(A&&A.__esModule)return A;var k={};if(A!=null)for(var M=B(A),J=0;J<M.length;J++)M[J]!=="default"&&f(k,A,M[J]);return o(k,A),k}}(),c=s&&s.__importDefault||function(B){return B&&B.__esModule?B:{default:B}};Object.defineProperty(s,"__esModule",{value:!0});var i=c(Ra()),e=c(Ka()),r=c(Jo()),t=Xt(),n=c(Ya()),l=u(Ja()),d=c(kt()),p=c(Xo()),b=c(yl()),m=nr(),w=wl(),E=c(gs()),I=u(Fr()),y=globalThis.setImmediate||((...B)=>{let A=B.shift();(0,m.nextTick)(()=>{A(...B)})}),_={keepalive:60,reschedulePings:!0,protocolId:"MQTT",protocolVersion:4,reconnectPeriod:1e3,connectTimeout:30*1e3,clean:!0,resubscribe:!0,subscribeBatchSize:null,writeCache:!0,timerVariant:"auto"},N=class wn extends w.TypedEventEmitter{static defaultId(){return`mqttjs_${Math.random().toString(16).substr(2,8)}`}constructor(A,k){super(),this.options=k||{};for(let M in _)typeof this.options[M]>"u"?this.options[M]=_[M]:this.options[M]=k[M];this.log=this.options.log||(0,d.default)("mqttjs:client"),this.noop=this._noop.bind(this),this.log("MqttClient :: version:",wn.VERSION),I.isWebWorker?this.log("MqttClient :: environment","webworker"):this.log("MqttClient :: environment",I.default?"browser":"node"),this.log("MqttClient :: options.protocol",k.protocol),this.log("MqttClient :: options.protocolVersion",k.protocolVersion),this.log("MqttClient :: options.username",k.username),this.log("MqttClient :: options.keepalive",k.keepalive),this.log("MqttClient :: options.reconnectPeriod",k.reconnectPeriod),this.log("MqttClient :: options.rejectUnauthorized",k.rejectUnauthorized),this.log("MqttClient :: options.properties.topicAliasMaximum",k.properties?k.properties.topicAliasMaximum:void 0),this.options.clientId=typeof k.clientId=="string"?k.clientId:wn.defaultId(),this.log("MqttClient :: clientId",this.options.clientId),this.options.customHandleAcks=k.protocolVersion===5&&k.customHandleAcks?k.customHandleAcks:(...M)=>{M[3](null,0)},this.options.writeCache||(e.default.writeToStream.cacheNumbers=!1),this.streamBuilder=A,this.messageIdProvider=typeof this.options.messageIdProvider>"u"?new r.default:this.options.messageIdProvider,this.outgoingStore=k.outgoingStore||new p.default,this.incomingStore=k.incomingStore||new p.default,this.queueQoSZero=k.queueQoSZero===void 0?!0:k.queueQoSZero,this._resubscribeTopics={},this.messageIdToTopic={},this.keepaliveManager=null,this.connected=!1,this.disconnecting=!1,this.reconnecting=!1,this.queue=[],this.connackTimer=null,this.reconnectTimer=null,this._storeProcessing=!1,this._packetIdsDuringStoreProcessing={},this._storeProcessingQueue=[],this.outgoing={},this._firstConnection=!0,k.properties&&k.properties.topicAliasMaximum>0&&(k.properties.topicAliasMaximum>65535?this.log("MqttClient :: options.properties.topicAliasMaximum is out of range"):this.topicAliasRecv=new i.default(k.properties.topicAliasMaximum)),this.on("connect",()=>{let{queue:M}=this,J=()=>{let X=M.shift();this.log("deliver :: entry %o",X);let ue=null;if(!X){this._resubscribe();return}ue=X.packet,this.log("deliver :: call _sendPacket for %o",ue);let C=!0;ue.messageId&&ue.messageId!==0&&(this.messageIdProvider.register(ue.messageId)||(C=!1)),C?this._sendPacket(ue,q=>{X.cb&&X.cb(q),J()}):(this.log("messageId: %d has already used. The message is skipped and removed.",ue.messageId),J())};this.log("connect :: sending queued packets"),J()}),this.on("close",()=>{this.log("close :: connected set to `false`"),this.connected=!1,this.log("close :: clearing connackTimer"),clearTimeout(this.connackTimer),this._destroyKeepaliveManager(),this.topicAliasRecv&&this.topicAliasRecv.clear(),this.log("close :: calling _setupReconnect"),this._setupReconnect()}),this.options.manualConnect||(this.log("MqttClient :: setting up stream"),this.connect())}handleAuth(A,k){k()}handleMessage(A,k){k()}_nextId(){return this.messageIdProvider.allocate()}getLastMessageId(){return this.messageIdProvider.getLastAllocated()}connect(){var A;let k=new t.Writable,M=e.default.parser(this.options),J=null,X=[];this.log("connect :: calling method to clear reconnect"),this._clearReconnect(),this.disconnected&&!this.reconnecting&&(this.incomingStore=this.options.incomingStore||new p.default,this.outgoingStore=this.options.outgoingStore||new p.default,this.disconnecting=!1,this.disconnected=!1),this.log("connect :: using streamBuilder provided to client to create stream"),this.stream=this.streamBuilder(this),M.on("packet",j=>{this.log("parser :: on packet push to packets array."),X.push(j)});let ue=()=>{this.log("work :: getting next packet in queue");let j=X.shift();if(j)this.log("work :: packet pulled from queue"),(0,b.default)(this,j,C);else{this.log("work :: no packets in queue");let te=J;J=null,this.log("work :: done flag is %s",!!te),te&&te()}},C=()=>{if(X.length)(0,m.nextTick)(ue);else{let j=J;J=null,j()}};k._write=(j,te,ae)=>{J=ae,this.log("writable stream :: parsing buffer"),M.parse(j),ue()};let q=j=>{this.log("streamErrorHandler :: error",j.message),j.code?(this.log("streamErrorHandler :: emitting error"),this.emit("error",j)):this.noop(j)};this.log("connect :: pipe stream to writable stream"),this.stream.pipe(k),this.stream.on("error",q),this.stream.on("close",()=>{this.log("(%s)stream :: on close",this.options.clientId),this._flushVolatile(),this.log("stream: emit close to MqttClient"),this.emit("close")}),this.log("connect: sending packet `connect`");let K={cmd:"connect",protocolId:this.options.protocolId,protocolVersion:this.options.protocolVersion,clean:this.options.clean,clientId:this.options.clientId,keepalive:this.options.keepalive,username:this.options.username,password:this.options.password,properties:this.options.properties};if(this.options.will&&(K.will=Object.assign(Object.assign({},this.options.will),{payload:(A=this.options.will)===null||A===void 0?void 0:A.payload})),this.topicAliasRecv&&(K.properties||(K.properties={}),this.topicAliasRecv&&(K.properties.topicAliasMaximum=this.topicAliasRecv.max)),this._writePacket(K),M.on("error",this.emit.bind(this,"error")),this.options.properties){if(!this.options.properties.authenticationMethod&&this.options.properties.authenticationData)return this.end(()=>this.emit("error",new Error("Packet has no Authentication Method"))),this;if(this.options.properties.authenticationMethod&&this.options.authPacket&&typeof this.options.authPacket=="object"){let j=Object.assign({cmd:"auth",reasonCode:0},this.options.authPacket);this._writePacket(j)}}return this.stream.setMaxListeners(1e3),clearTimeout(this.connackTimer),this.connackTimer=setTimeout(()=>{this.log("!!connectTimeout hit!! Calling _cleanUp with force `true`"),this.emit("error",new Error("connack timeout")),this._cleanUp(!0)},this.options.connectTimeout),this}publish(A,k,M,J){this.log("publish :: message `%s` to topic `%s`",k,A);let{options:X}=this;typeof M=="function"&&(J=M,M=null),M=M||{},M=Object.assign(Object.assign({},{qos:0,retain:!1,dup:!1}),M);let{qos:ue,retain:C,dup:q,properties:K,cbStorePut:j}=M;if(this._checkDisconnecting(J))return this;let te=()=>{let ae=0;if((ue===1||ue===2)&&(ae=this._nextId(),ae===null))return this.log("No messageId left"),!1;let ie={cmd:"publish",topic:A,payload:k,qos:ue,retain:C,messageId:ae,dup:q};switch(X.protocolVersion===5&&(ie.properties=K),this.log("publish :: qos",ue),ue){case 1:case 2:this.outgoing[ie.messageId]={volatile:!1,cb:J||this.noop},this.log("MqttClient:publish: packet cmd: %s",ie.cmd),this._sendPacket(ie,void 0,j);break;default:this.log("MqttClient:publish: packet cmd: %s",ie.cmd),this._sendPacket(ie,J,j);break}return!0};return(this._storeProcessing||this._storeProcessingQueue.length>0||!te())&&this._storeProcessingQueue.push({invoke:te,cbStorePut:M.cbStorePut,callback:J}),this}publishAsync(A,k,M){return new Promise((J,X)=>{this.publish(A,k,M,(ue,C)=>{ue?X(ue):J(C)})})}subscribe(A,k,M){let J=this.options.protocolVersion;typeof k=="function"&&(M=k),M=M||this.noop;let X=!1,ue=[];typeof A=="string"?(A=[A],ue=A):Array.isArray(A)?ue=A:typeof A=="object"&&(X=A.resubscribe,delete A.resubscribe,ue=Object.keys(A));let C=l.validateTopics(ue);if(C!==null)return y(M,new Error(`Invalid topic ${C}`)),this;if(this._checkDisconnecting(M))return this.log("subscribe: discconecting true"),this;let q={qos:0};J===5&&(q.nl=!1,q.rap=!1,q.rh=0),k=Object.assign(Object.assign({},q),k);let K=k.properties,j=[],te=(ve,z)=>{if(z=z||k,!Object.prototype.hasOwnProperty.call(this._resubscribeTopics,ve)||this._resubscribeTopics[ve].qos<z.qos||X){let ge={topic:ve,qos:z.qos};J===5&&(ge.nl=z.nl,ge.rap=z.rap,ge.rh=z.rh,ge.properties=K),this.log("subscribe: pushing topic `%s` and qos `%s` to subs list",ge.topic,ge.qos),j.push(ge)}};if(Array.isArray(A)?A.forEach(ve=>{this.log("subscribe: array topic %s",ve),te(ve)}):Object.keys(A).forEach(ve=>{this.log("subscribe: object topic %s, %o",ve,A[ve]),te(ve,A[ve])}),!j.length)return M(null,[]),this;let ae=(ve,z)=>{let ge={cmd:"subscribe",subscriptions:ve,messageId:z};if(K&&(ge.properties=K),this.options.resubscribe){this.log("subscribe :: resubscribe true");let ne=[];ve.forEach(be=>{if(this.options.reconnectPeriod>0){let D={qos:be.qos};J===5&&(D.nl=be.nl||!1,D.rap=be.rap||!1,D.rh=be.rh||0,D.properties=be.properties),this._resubscribeTopics[be.topic]=D,ne.push(be.topic)}}),this.messageIdToTopic[ge.messageId]=ne}let R=new Promise((ne,be)=>{this.outgoing[ge.messageId]={volatile:!0,cb(D,Ae){if(!D){let{granted:Q}=Ae;for(let L=0;L<Q.length;L+=1)ve[L].qos=Q[L]}D?be(new m.ErrorWithSubackPacket(D.message,Ae)):ne(Ae)}}});return this.log("subscribe :: call _sendPacket"),this._sendPacket(ge),R},ie=()=>{var ve;let z=(ve=this.options.subscribeBatchSize)!==null&&ve!==void 0?ve:j.length,ge=[];for(let R=0;R<j.length;R+=z){let ne=j.slice(R,R+z),be=this._nextId();if(be===null)return this.log("No messageId left"),!1;ge.push(ae(ne,be))}return Promise.all(ge).then(R=>{M(null,j,R.at(-1))}).catch(R=>{M(R,j,R.packet)}),!0};return(this._storeProcessing||this._storeProcessingQueue.length>0||!ie())&&this._storeProcessingQueue.push({invoke:ie,callback:M}),this}subscribeAsync(A,k){return new Promise((M,J)=>{this.subscribe(A,k,(X,ue)=>{X?J(X):M(ue)})})}unsubscribe(A,k,M){typeof A=="string"&&(A=[A]),typeof k=="function"&&(M=k),M=M||this.noop;let J=l.validateTopics(A);if(J!==null)return y(M,new Error(`Invalid topic ${J}`)),this;if(this._checkDisconnecting(M))return this;let X=()=>{let ue=this._nextId();if(ue===null)return this.log("No messageId left"),!1;let C={cmd:"unsubscribe",messageId:ue,unsubscriptions:[]};return typeof A=="string"?C.unsubscriptions=[A]:Array.isArray(A)&&(C.unsubscriptions=A),this.options.resubscribe&&C.unsubscriptions.forEach(q=>{delete this._resubscribeTopics[q]}),typeof k=="object"&&k.properties&&(C.properties=k.properties),this.outgoing[C.messageId]={volatile:!0,cb:M},this.log("unsubscribe: call _sendPacket"),this._sendPacket(C),!0};return(this._storeProcessing||this._storeProcessingQueue.length>0||!X())&&this._storeProcessingQueue.push({invoke:X,callback:M}),this}unsubscribeAsync(A,k){return new Promise((M,J)=>{this.unsubscribe(A,k,(X,ue)=>{X?J(X):M(ue)})})}end(A,k,M){this.log("end :: (%s)",this.options.clientId),(A==null||typeof A!="boolean")&&(M=M||k,k=A,A=!1),typeof k!="object"&&(M=M||k,k=null),this.log("end :: cb? %s",!!M),(!M||typeof M!="function")&&(M=this.noop);let J=()=>{this.log("end :: closeStores: closing incoming and outgoing stores"),this.disconnected=!0,this.incomingStore.close(ue=>{this.outgoingStore.close(C=>{if(this.log("end :: closeStores: emitting end"),this.emit("end"),M){let q=ue||C;this.log("end :: closeStores: invoking callback with args"),M(q)}})}),this._deferredReconnect?this._deferredReconnect():(this.options.reconnectPeriod===0||this.options.manualConnect)&&(this.disconnecting=!1)},X=()=>{this.log("end :: (%s) :: finish :: calling _cleanUp with force %s",this.options.clientId,A),this._cleanUp(A,()=>{this.log("end :: finish :: calling process.nextTick on closeStores"),(0,m.nextTick)(J)},k)};return this.disconnecting?(M(),this):(this._clearReconnect(),this.disconnecting=!0,!A&&Object.keys(this.outgoing).length>0?(this.log("end :: (%s) :: calling finish in 10ms once outgoing is empty",this.options.clientId),this.once("outgoingEmpty",setTimeout.bind(null,X,10))):(this.log("end :: (%s) :: immediately calling finish",this.options.clientId),X()),this)}endAsync(A,k){return new Promise((M,J)=>{this.end(A,k,X=>{X?J(X):M()})})}removeOutgoingMessage(A){if(this.outgoing[A]){let{cb:k}=this.outgoing[A];this._removeOutgoingAndStoreMessage(A,()=>{k(new Error("Message removed"))})}return this}reconnect(A){this.log("client reconnect");let k=()=>{A?(this.options.incomingStore=A.incomingStore,this.options.outgoingStore=A.outgoingStore):(this.options.incomingStore=null,this.options.outgoingStore=null),this.incomingStore=this.options.incomingStore||new p.default,this.outgoingStore=this.options.outgoingStore||new p.default,this.disconnecting=!1,this.disconnected=!1,this._deferredReconnect=null,this._reconnect()};return this.disconnecting&&!this.disconnected?this._deferredReconnect=k:k(),this}_flushVolatile(){this.outgoing&&(this.log("_flushVolatile :: deleting volatile messages from the queue and setting their callbacks as error function"),Object.keys(this.outgoing).forEach(A=>{this.outgoing[A].volatile&&typeof this.outgoing[A].cb=="function"&&(this.outgoing[A].cb(new Error("Connection closed")),delete this.outgoing[A])}))}_flush(){this.outgoing&&(this.log("_flush: queue exists? %b",!!this.outgoing),Object.keys(this.outgoing).forEach(A=>{typeof this.outgoing[A].cb=="function"&&(this.outgoing[A].cb(new Error("Connection closed")),delete this.outgoing[A])}))}_removeTopicAliasAndRecoverTopicName(A){let k;A.properties&&(k=A.properties.topicAlias);let M=A.topic.toString();if(this.log("_removeTopicAliasAndRecoverTopicName :: alias %d, topic %o",k,M),M.length===0){if(typeof k>"u")return new Error("Unregistered Topic Alias");if(M=this.topicAliasSend.getTopicByAlias(k),typeof M>"u")return new Error("Unregistered Topic Alias");A.topic=M}k&&delete A.properties.topicAlias}_checkDisconnecting(A){return this.disconnecting&&(A&&A!==this.noop?A(new Error("client disconnecting")):this.emit("error",new Error("client disconnecting"))),this.disconnecting}_reconnect(){this.log("_reconnect: emitting reconnect to client"),this.emit("reconnect"),this.connected?(this.end(()=>{this.connect()}),this.log("client already connected. disconnecting first.")):(this.log("_reconnect: calling connect"),this.connect())}_setupReconnect(){!this.disconnecting&&!this.reconnectTimer&&this.options.reconnectPeriod>0?(this.reconnecting||(this.log("_setupReconnect :: emit `offline` state"),this.emit("offline"),this.log("_setupReconnect :: set `reconnecting` to `true`"),this.reconnecting=!0),this.log("_setupReconnect :: setting reconnectTimer for %d ms",this.options.reconnectPeriod),this.reconnectTimer=setInterval(()=>{this.log("reconnectTimer :: reconnect triggered!"),this._reconnect()},this.options.reconnectPeriod)):this.log("_setupReconnect :: doing nothing...")}_clearReconnect(){this.log("_clearReconnect : clearing reconnect timer"),this.reconnectTimer&&(clearInterval(this.reconnectTimer),this.reconnectTimer=null)}_cleanUp(A,k,M={}){if(k&&(this.log("_cleanUp :: done callback provided for on stream close"),this.stream.on("close",k)),this.log("_cleanUp :: forced? %s",A),A)this.options.reconnectPeriod===0&&this.options.clean&&this._flush(),this.log("_cleanUp :: (%s) :: destroying stream",this.options.clientId),this.stream.destroy();else{let J=Object.assign({cmd:"disconnect"},M);this.log("_cleanUp :: (%s) :: call _sendPacket with disconnect packet",this.options.clientId),this._sendPacket(J,()=>{this.log("_cleanUp :: (%s) :: destroying stream",this.options.clientId),y(()=>{this.stream.end(()=>{this.log("_cleanUp :: (%s) :: stream destroyed",this.options.clientId)})})})}!this.disconnecting&&!this.reconnecting&&(this.log("_cleanUp :: client not disconnecting/reconnecting. Clearing and resetting reconnect."),this._clearReconnect(),this._setupReconnect()),this._destroyKeepaliveManager(),k&&!this.connected&&(this.log("_cleanUp :: (%s) :: removing stream `done` callback `close` listener",this.options.clientId),this.stream.removeListener("close",k),k())}_storeAndSend(A,k,M){this.log("storeAndSend :: store packet with cmd %s to outgoingStore",A.cmd);let J=A,X;if(J.cmd==="publish"&&(J=(0,n.default)(A),X=this._removeTopicAliasAndRecoverTopicName(J),X))return k&&k(X);this.outgoingStore.put(J,ue=>{if(ue)return k&&k(ue);M(),this._writePacket(A,k)})}_applyTopicAlias(A){if(this.options.protocolVersion===5&&A.cmd==="publish"){let k;A.properties&&(k=A.properties.topicAlias);let M=A.topic.toString();if(this.topicAliasSend)if(k){if(M.length!==0&&(this.log("applyTopicAlias :: register topic: %s - alias: %d",M,k),!this.topicAliasSend.put(M,k)))return this.log("applyTopicAlias :: error out of range. topic: %s - alias: %d",M,k),new Error("Sending Topic Alias out of range")}else M.length!==0&&(this.options.autoAssignTopicAlias?(k=this.topicAliasSend.getAliasByTopic(M),k?(A.topic="",A.properties=Object.assign(Object.assign({},A.properties),{topicAlias:k}),this.log("applyTopicAlias :: auto assign(use) topic: %s - alias: %d",M,k)):(k=this.topicAliasSend.getLruAlias(),this.topicAliasSend.put(M,k),A.properties=Object.assign(Object.assign({},A.properties),{topicAlias:k}),this.log("applyTopicAlias :: auto assign topic: %s - alias: %d",M,k))):this.options.autoUseTopicAlias&&(k=this.topicAliasSend.getAliasByTopic(M),k&&(A.topic="",A.properties=Object.assign(Object.assign({},A.properties),{topicAlias:k}),this.log("applyTopicAlias :: auto use topic: %s - alias: %d",M,k))));else if(k)return this.log("applyTopicAlias :: error out of range. topic: %s - alias: %d",M,k),new Error("Sending Topic Alias out of range")}}_noop(A){this.log("noop ::",A)}_writePacket(A,k){this.log("_writePacket :: packet: %O",A),this.log("_writePacket :: emitting `packetsend`"),this.emit("packetsend",A),this.log("_writePacket :: writing to stream");let M=e.default.writeToStream(A,this.stream,this.options);this.log("_writePacket :: writeToStream result %s",M),!M&&k&&k!==this.noop?(this.log("_writePacket :: handle events on `drain` once through callback."),this.stream.once("drain",k)):k&&(this.log("_writePacket :: invoking cb"),k())}_sendPacket(A,k,M,J){this.log("_sendPacket :: (%s) ::  start",this.options.clientId),M=M||this.noop,k=k||this.noop;let X=this._applyTopicAlias(A);if(X){k(X);return}if(!this.connected){if(A.cmd==="auth"){this._writePacket(A,k);return}this.log("_sendPacket :: client not connected. Storing packet offline."),this._storePacket(A,k,M);return}if(J){this._writePacket(A,k);return}switch(A.cmd){case"publish":break;case"pubrel":this._storeAndSend(A,k,M);return;default:this._writePacket(A,k);return}switch(A.qos){case 2:case 1:this._storeAndSend(A,k,M);break;case 0:default:this._writePacket(A,k);break}this.log("_sendPacket :: (%s) ::  end",this.options.clientId)}_storePacket(A,k,M){this.log("_storePacket :: packet: %o",A),this.log("_storePacket :: cb? %s",!!k),M=M||this.noop;let J=A;if(J.cmd==="publish"){J=(0,n.default)(A);let ue=this._removeTopicAliasAndRecoverTopicName(J);if(ue)return k&&k(ue)}let X=J.qos||0;X===0&&this.queueQoSZero||J.cmd!=="publish"?this.queue.push({packet:J,cb:k}):X>0?(k=this.outgoing[J.messageId]?this.outgoing[J.messageId].cb:null,this.outgoingStore.put(J,ue=>{if(ue)return k&&k(ue);M()})):k&&k(new Error("No connection to broker"))}_setupKeepaliveManager(){this.log("_setupKeepaliveManager :: keepalive %d (seconds)",this.options.keepalive),!this.keepaliveManager&&this.options.keepalive&&(this.keepaliveManager=new E.default(this,this.options.timerVariant))}_destroyKeepaliveManager(){this.keepaliveManager&&(this.log("_destroyKeepaliveManager :: destroying keepalive manager"),this.keepaliveManager.destroy(),this.keepaliveManager=null)}reschedulePing(A=!1){this.keepaliveManager&&this.options.keepalive&&(A||this.options.reschedulePings)&&this._reschedulePing()}_reschedulePing(){this.log("_reschedulePing :: rescheduling ping"),this.keepaliveManager.reschedule()}sendPing(){this.log("_sendPing :: sending pingreq"),this._sendPacket({cmd:"pingreq"})}onKeepaliveTimeout(){this.emit("error",new Error("Keepalive timeout")),this.log("onKeepaliveTimeout :: calling _cleanUp with force true"),this._cleanUp(!0)}_resubscribe(){this.log("_resubscribe");let A=Object.keys(this._resubscribeTopics);if(!this._firstConnection&&(this.options.clean||this.options.protocolVersion>=4&&!this.connackPacket.sessionPresent)&&A.length>0)if(this.options.resubscribe)if(this.options.protocolVersion===5){this.log("_resubscribe: protocolVersion 5");for(let k=0;k<A.length;k++){let M={};M[A[k]]=this._resubscribeTopics[A[k]],M.resubscribe=!0,this.subscribe(M,{properties:M[A[k]].properties})}}else this._resubscribeTopics.resubscribe=!0,this.subscribe(this._resubscribeTopics);else this._resubscribeTopics={};this._firstConnection=!1}_onConnect(A){if(this.disconnected){this.emit("connect",A);return}this.connackPacket=A,this.messageIdProvider.clear(),this._setupKeepaliveManager(),this.connected=!0;let k=()=>{let M=this.outgoingStore.createStream(),J=()=>{M.destroy(),M=null,this._flushStoreProcessingQueue(),X()},X=()=>{this._storeProcessing=!1,this._packetIdsDuringStoreProcessing={}};this.once("close",J),M.on("error",C=>{X(),this._flushStoreProcessingQueue(),this.removeListener("close",J),this.emit("error",C)});let ue=()=>{if(!M)return;let C=M.read(1),q;if(!C){M.once("readable",ue);return}if(this._storeProcessing=!0,this._packetIdsDuringStoreProcessing[C.messageId]){ue();return}!this.disconnecting&&!this.reconnectTimer?(q=this.outgoing[C.messageId]?this.outgoing[C.messageId].cb:null,this.outgoing[C.messageId]={volatile:!1,cb(K,j){q&&q(K,j),ue()}},this._packetIdsDuringStoreProcessing[C.messageId]=!0,this.messageIdProvider.register(C.messageId)?this._sendPacket(C,void 0,void 0,!0):this.log("messageId: %d has already used.",C.messageId)):M.destroy&&M.destroy()};M.on("end",()=>{let C=!0;for(let q in this._packetIdsDuringStoreProcessing)if(!this._packetIdsDuringStoreProcessing[q]){C=!1;break}this.removeListener("close",J),C?(X(),this._invokeAllStoreProcessingQueue(),this.emit("connect",A)):k()}),ue()};k()}_invokeStoreProcessingQueue(){if(!this._storeProcessing&&this._storeProcessingQueue.length>0){let A=this._storeProcessingQueue[0];if(A&&A.invoke())return this._storeProcessingQueue.shift(),!0}return!1}_invokeAllStoreProcessingQueue(){for(;this._invokeStoreProcessingQueue(););}_flushStoreProcessingQueue(){for(let A of this._storeProcessingQueue)A.cbStorePut&&A.cbStorePut(new Error("Connection closed")),A.callback&&A.callback(new Error("Connection closed"));this._storeProcessingQueue.splice(0)}_removeOutgoingAndStoreMessage(A,k){delete this.outgoing[A],this.outgoingStore.del({messageId:A},(M,J)=>{k(M,J),this.messageIdProvider.deallocate(A),this._invokeStoreProcessingQueue()})}};N.VERSION=m.MQTTJS_VERSION,s.default=N}),Al=me(s=>{fe(),pe(),de(),Object.defineProperty(s,"__esModule",{value:!0});var f=ps(),o=class{constructor(){this.numberAllocator=new f.NumberAllocator(1,65535)}allocate(){return this.lastId=this.numberAllocator.alloc(),this.lastId}getLastAllocated(){return this.lastId}register(u){return this.numberAllocator.use(u)}deallocate(u){this.numberAllocator.free(u)}clear(){this.numberAllocator.clear()}};s.default=o});function $t(s){throw new RangeError(ms[s])}function Yn(s,f){let o=s.split("@"),u="";o.length>1&&(u=o[0]+"@",s=o[1]);let c=function(i,e){let r=[],t=i.length;for(;t--;)r[t]=e(i[t]);return r}((s=s.replace(bs,".")).split("."),f).join(".");return u+c}function Jn(s){let f=[],o=0,u=s.length;for(;o<u;){let c=s.charCodeAt(o++);if(c>=55296&&c<=56319&&o<u){let i=s.charCodeAt(o++);(64512&i)==56320?f.push(((1023&c)<<10)+(1023&i)+65536):(f.push(c),o--)}else f.push(c)}return f}var Xn,Zn,bs,ms,ct,wr,Zr,ei,ti,ri,Lt,Il=it(()=>{fe(),pe(),de(),Xn=/^xn--/,Zn=/[^\0-\x7E]/,bs=/[\x2E\u3002\uFF0E\uFF61]/g,ms={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},ct=Math.floor,wr=String.fromCharCode,Zr=function(s,f){return s+22+75*(s<26)-((f!=0)<<5)},ei=function(s,f,o){let u=0;for(s=o?ct(s/700):s>>1,s+=ct(s/f);s>455;u+=36)s=ct(s/35);return ct(u+36*s/(s+38))},ti=function(s){let f=[],o=s.length,u=0,c=128,i=72,e=s.lastIndexOf("-");e<0&&(e=0);for(let t=0;t<e;++t)s.charCodeAt(t)>=128&&$t("not-basic"),f.push(s.charCodeAt(t));for(let t=e>0?e+1:0;t<o;){let n=u;for(let d=1,p=36;;p+=36){t>=o&&$t("invalid-input");let b=(r=s.charCodeAt(t++))-48<10?r-22:r-65<26?r-65:r-97<26?r-97:36;(b>=36||b>ct((2147483647-u)/d))&&$t("overflow"),u+=b*d;let m=p<=i?1:p>=i+26?26:p-i;if(b<m)break;let w=36-m;d>ct(2147483647/w)&&$t("overflow"),d*=w}let l=f.length+1;i=ei(u-n,l,n==0),ct(u/l)>2147483647-c&&$t("overflow"),c+=ct(u/l),u%=l,f.splice(u++,0,c)}var r;return String.fromCodePoint(...f)},ri=function(s){let f=[],o=(s=Jn(s)).length,u=128,c=0,i=72;for(let t of s)t<128&&f.push(wr(t));let e=f.length,r=e;for(e&&f.push("-");r<o;){let t=2147483647;for(let l of s)l>=u&&l<t&&(t=l);let n=r+1;t-u>ct((2147483647-c)/n)&&$t("overflow"),c+=(t-u)*n,u=t;for(let l of s)if(l<u&&++c>2147483647&&$t("overflow"),l==u){let d=c;for(let p=36;;p+=36){let b=p<=i?1:p>=i+26?26:p-i;if(d<b)break;let m=d-b,w=36-b;f.push(wr(Zr(b+m%w,0))),d=ct(m/w)}f.push(wr(Zr(d,0))),i=ei(c,n,r==e),c=0,++r}++c,++u}return f.join("")},Lt={version:"2.1.0",ucs2:{decode:Jn,encode:s=>String.fromCodePoint(...s)},decode:ti,encode:ri,toASCII:function(s){return Yn(s,function(f){return Zn.test(f)?"xn--"+ri(f):f})},toUnicode:function(s){return Yn(s,function(f){return Xn.test(f)?ti(f.slice(4).toLowerCase()):f})}},Lt.decode,Lt.encode,Lt.toASCII,Lt.toUnicode,Lt.ucs2,Lt.version});function kl(s,f){return Object.prototype.hasOwnProperty.call(s,f)}var eo,er,to,pt,Tl=it(()=>{fe(),pe(),de(),eo=function(s,f,o,u){f=f||"&",o=o||"=";var c={};if(typeof s!="string"||s.length===0)return c;var i=/\+/g;s=s.split(f);var e=1e3;u&&typeof u.maxKeys=="number"&&(e=u.maxKeys);var r=s.length;e>0&&r>e&&(r=e);for(var t=0;t<r;++t){var n,l,d,p,b=s[t].replace(i,"%20"),m=b.indexOf(o);m>=0?(n=b.substr(0,m),l=b.substr(m+1)):(n=b,l=""),d=decodeURIComponent(n),p=decodeURIComponent(l),kl(c,d)?Array.isArray(c[d])?c[d].push(p):c[d]=[c[d],p]:c[d]=p}return c},er=function(s){switch(typeof s){case"string":return s;case"boolean":return s?"true":"false";case"number":return isFinite(s)?s:"";default:return""}},to=function(s,f,o,u){return f=f||"&",o=o||"=",s===null&&(s=void 0),typeof s=="object"?Object.keys(s).map(function(c){var i=encodeURIComponent(er(c))+o;return Array.isArray(s[c])?s[c].map(function(e){return i+encodeURIComponent(er(e))}).join(f):i+encodeURIComponent(er(s[c]))}).join(f):u?encodeURIComponent(er(u))+o+encodeURIComponent(er(s)):""},pt={},pt.decode=pt.parse=eo,pt.encode=pt.stringify=to,pt.decode,pt.encode,pt.parse,pt.stringify});function vn(){throw new Error("setTimeout has not been defined")}function _n(){throw new Error("clearTimeout has not been defined")}function ys(s){if(_t===setTimeout)return setTimeout(s,0);if((_t===vn||!_t)&&setTimeout)return _t=setTimeout,setTimeout(s,0);try{return _t(s,0)}catch{try{return _t.call(null,s,0)}catch{return _t.call(this||Kt,s,0)}}}function Ol(){Gt&&zt&&(Gt=!1,zt.length?bt=zt.concat(bt):fr=-1,bt.length&&ws())}function ws(){if(!Gt){var s=ys(Ol);Gt=!0;for(var f=bt.length;f;){for(zt=bt,bt=[];++fr<f;)zt&&zt[fr].run();fr=-1,f=bt.length}zt=null,Gt=!1,function(o){if(Et===clearTimeout)return clearTimeout(o);if((Et===_n||!Et)&&clearTimeout)return Et=clearTimeout,clearTimeout(o);try{Et(o)}catch{try{return Et.call(null,o)}catch{return Et.call(this||Kt,o)}}}(s)}}function ro(s,f){(this||Kt).fun=s,(this||Kt).array=f}function yt(){}var io,_t,Et,Kt,Qe,zt,bt,Gt,fr,Ve,Pl=it(()=>{fe(),pe(),de(),Kt=typeof globalThis<"u"?globalThis:typeof self<"u"?self:global,Qe=io={},function(){try{_t=typeof setTimeout=="function"?setTimeout:vn}catch{_t=vn}try{Et=typeof clearTimeout=="function"?clearTimeout:_n}catch{Et=_n}}(),bt=[],Gt=!1,fr=-1,Qe.nextTick=function(s){var f=new Array(arguments.length-1);if(arguments.length>1)for(var o=1;o<arguments.length;o++)f[o-1]=arguments[o];bt.push(new ro(s,f)),bt.length!==1||Gt||ys(ws)},ro.prototype.run=function(){(this||Kt).fun.apply(null,(this||Kt).array)},Qe.title="browser",Qe.browser=!0,Qe.env={},Qe.argv=[],Qe.version="",Qe.versions={},Qe.on=yt,Qe.addListener=yt,Qe.once=yt,Qe.off=yt,Qe.removeListener=yt,Qe.removeAllListeners=yt,Qe.emit=yt,Qe.prependListener=yt,Qe.prependOnceListener=yt,Qe.listeners=function(s){return[]},Qe.binding=function(s){throw new Error("process.binding is not supported")},Qe.cwd=function(){return"/"},Qe.chdir=function(s){throw new Error("process.chdir is not supported")},Qe.umask=function(){return 0},Ve=io,Ve.addListener,Ve.argv,Ve.binding,Ve.browser,Ve.chdir,Ve.cwd,Ve.emit,Ve.env,Ve.listeners,Ve.nextTick,Ve.off,Ve.on,Ve.once,Ve.prependListener,Ve.prependOnceListener,Ve.removeAllListeners,Ve.removeListener,Ve.title,Ve.umask,Ve.version,Ve.versions});function Cl(){if(En)return Pr;En=!0;var s=Pr={},f,o;function u(){throw new Error("setTimeout has not been defined")}function c(){throw new Error("clearTimeout has not been defined")}(function(){try{typeof setTimeout=="function"?f=setTimeout:f=u}catch{f=u}try{typeof clearTimeout=="function"?o=clearTimeout:o=c}catch{o=c}})();function i(w){if(f===setTimeout)return setTimeout(w,0);if((f===u||!f)&&setTimeout)return f=setTimeout,setTimeout(w,0);try{return f(w,0)}catch{try{return f.call(null,w,0)}catch{return f.call(this||Ht,w,0)}}}function e(w){if(o===clearTimeout)return clearTimeout(w);if((o===c||!o)&&clearTimeout)return o=clearTimeout,clearTimeout(w);try{return o(w)}catch{try{return o.call(null,w)}catch{return o.call(this||Ht,w)}}}var r=[],t=!1,n,l=-1;function d(){!t||!n||(t=!1,n.length?r=n.concat(r):l=-1,r.length&&p())}function p(){if(!t){var w=i(d);t=!0;for(var E=r.length;E;){for(n=r,r=[];++l<E;)n&&n[l].run();l=-1,E=r.length}n=null,t=!1,e(w)}}s.nextTick=function(w){var E=new Array(arguments.length-1);if(arguments.length>1)for(var I=1;I<arguments.length;I++)E[I-1]=arguments[I];r.push(new b(w,E)),r.length===1&&!t&&i(p)};function b(w,E){(this||Ht).fun=w,(this||Ht).array=E}b.prototype.run=function(){(this||Ht).fun.apply(null,(this||Ht).array)},s.title="browser",s.browser=!0,s.env={},s.argv=[],s.version="",s.versions={};function m(){}return s.on=m,s.addListener=m,s.once=m,s.off=m,s.removeListener=m,s.removeAllListeners=m,s.emit=m,s.prependListener=m,s.prependOnceListener=m,s.listeners=function(w){return[]},s.binding=function(w){throw new Error("process.binding is not supported")},s.cwd=function(){return"/"},s.chdir=function(w){throw new Error("process.chdir is not supported")},s.umask=function(){return 0},Pr}var Pr,En,Ht,qe,vs=it(()=>{fe(),pe(),de(),Pr={},En=!1,Ht=typeof globalThis<"u"?globalThis:typeof self<"u"?self:global,qe=Cl(),qe.platform="browser",qe.addListener,qe.argv,qe.binding,qe.browser,qe.chdir,qe.cwd,qe.emit,qe.env,qe.listeners,qe.nextTick,qe.off,qe.on,qe.once,qe.prependListener,qe.prependOnceListener,qe.removeAllListeners,qe.removeListener,qe.title,qe.umask,qe.version,qe.versions});function Rl(){if(Sn)return Cr;Sn=!0;var s=qe;function f(i){if(typeof i!="string")throw new TypeError("Path must be a string. Received "+JSON.stringify(i))}function o(i,e){for(var r="",t=0,n=-1,l=0,d,p=0;p<=i.length;++p){if(p<i.length)d=i.charCodeAt(p);else{if(d===47)break;d=47}if(d===47){if(!(n===p-1||l===1))if(n!==p-1&&l===2){if(r.length<2||t!==2||r.charCodeAt(r.length-1)!==46||r.charCodeAt(r.length-2)!==46){if(r.length>2){var b=r.lastIndexOf("/");if(b!==r.length-1){b===-1?(r="",t=0):(r=r.slice(0,b),t=r.length-1-r.lastIndexOf("/")),n=p,l=0;continue}}else if(r.length===2||r.length===1){r="",t=0,n=p,l=0;continue}}e&&(r.length>0?r+="/..":r="..",t=2)}else r.length>0?r+="/"+i.slice(n+1,p):r=i.slice(n+1,p),t=p-n-1;n=p,l=0}else d===46&&l!==-1?++l:l=-1}return r}function u(i,e){var r=e.dir||e.root,t=e.base||(e.name||"")+(e.ext||"");return r?r===e.root?r+t:r+i+t:t}var c={resolve:function(){for(var i="",e=!1,r,t=arguments.length-1;t>=-1&&!e;t--){var n;t>=0?n=arguments[t]:(r===void 0&&(r=s.cwd()),n=r),f(n),n.length!==0&&(i=n+"/"+i,e=n.charCodeAt(0)===47)}return i=o(i,!e),e?i.length>0?"/"+i:"/":i.length>0?i:"."},normalize:function(i){if(f(i),i.length===0)return".";var e=i.charCodeAt(0)===47,r=i.charCodeAt(i.length-1)===47;return i=o(i,!e),i.length===0&&!e&&(i="."),i.length>0&&r&&(i+="/"),e?"/"+i:i},isAbsolute:function(i){return f(i),i.length>0&&i.charCodeAt(0)===47},join:function(){if(arguments.length===0)return".";for(var i,e=0;e<arguments.length;++e){var r=arguments[e];f(r),r.length>0&&(i===void 0?i=r:i+="/"+r)}return i===void 0?".":c.normalize(i)},relative:function(i,e){if(f(i),f(e),i===e||(i=c.resolve(i),e=c.resolve(e),i===e))return"";for(var r=1;r<i.length&&i.charCodeAt(r)===47;++r);for(var t=i.length,n=t-r,l=1;l<e.length&&e.charCodeAt(l)===47;++l);for(var d=e.length,p=d-l,b=n<p?n:p,m=-1,w=0;w<=b;++w){if(w===b){if(p>b){if(e.charCodeAt(l+w)===47)return e.slice(l+w+1);if(w===0)return e.slice(l+w)}else n>b&&(i.charCodeAt(r+w)===47?m=w:w===0&&(m=0));break}var E=i.charCodeAt(r+w),I=e.charCodeAt(l+w);if(E!==I)break;E===47&&(m=w)}var y="";for(w=r+m+1;w<=t;++w)(w===t||i.charCodeAt(w)===47)&&(y.length===0?y+="..":y+="/..");return y.length>0?y+e.slice(l+m):(l+=m,e.charCodeAt(l)===47&&++l,e.slice(l))},_makeLong:function(i){return i},dirname:function(i){if(f(i),i.length===0)return".";for(var e=i.charCodeAt(0),r=e===47,t=-1,n=!0,l=i.length-1;l>=1;--l)if(e=i.charCodeAt(l),e===47){if(!n){t=l;break}}else n=!1;return t===-1?r?"/":".":r&&t===1?"//":i.slice(0,t)},basename:function(i,e){if(e!==void 0&&typeof e!="string")throw new TypeError('"ext" argument must be a string');f(i);var r=0,t=-1,n=!0,l;if(e!==void 0&&e.length>0&&e.length<=i.length){if(e.length===i.length&&e===i)return"";var d=e.length-1,p=-1;for(l=i.length-1;l>=0;--l){var b=i.charCodeAt(l);if(b===47){if(!n){r=l+1;break}}else p===-1&&(n=!1,p=l+1),d>=0&&(b===e.charCodeAt(d)?--d===-1&&(t=l):(d=-1,t=p))}return r===t?t=p:t===-1&&(t=i.length),i.slice(r,t)}else{for(l=i.length-1;l>=0;--l)if(i.charCodeAt(l)===47){if(!n){r=l+1;break}}else t===-1&&(n=!1,t=l+1);return t===-1?"":i.slice(r,t)}},extname:function(i){f(i);for(var e=-1,r=0,t=-1,n=!0,l=0,d=i.length-1;d>=0;--d){var p=i.charCodeAt(d);if(p===47){if(!n){r=d+1;break}continue}t===-1&&(n=!1,t=d+1),p===46?e===-1?e=d:l!==1&&(l=1):e!==-1&&(l=-1)}return e===-1||t===-1||l===0||l===1&&e===t-1&&e===r+1?"":i.slice(e,t)},format:function(i){if(i===null||typeof i!="object")throw new TypeError('The "pathObject" argument must be of type Object. Received type '+typeof i);return u("/",i)},parse:function(i){f(i);var e={root:"",dir:"",base:"",ext:"",name:""};if(i.length===0)return e;var r=i.charCodeAt(0),t=r===47,n;t?(e.root="/",n=1):n=0;for(var l=-1,d=0,p=-1,b=!0,m=i.length-1,w=0;m>=n;--m){if(r=i.charCodeAt(m),r===47){if(!b){d=m+1;break}continue}p===-1&&(b=!1,p=m+1),r===46?l===-1?l=m:w!==1&&(w=1):l!==-1&&(w=-1)}return l===-1||p===-1||w===0||w===1&&l===p-1&&l===d+1?p!==-1&&(d===0&&t?e.base=e.name=i.slice(1,p):e.base=e.name=i.slice(d,p)):(d===0&&t?(e.name=i.slice(1,l),e.base=i.slice(1,p)):(e.name=i.slice(d,l),e.base=i.slice(d,p)),e.ext=i.slice(l,p)),d>0?e.dir=i.slice(0,d-1):t&&(e.dir="/"),e},sep:"/",delimiter:":",win32:null,posix:null};return c.posix=c,Cr=c,Cr}var Cr,Sn,An,Bl=it(()=>{fe(),pe(),de(),vs(),Cr={},Sn=!1,An=Rl()}),_s={};rr(_s,{URL:()=>Ds,Url:()=>Ms,default:()=>Ue,fileURLToPath:()=>Es,format:()=>Ls,parse:()=>Ns,pathToFileURL:()=>Ss,resolve:()=>Us,resolveObject:()=>js});function ht(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}function ar(s,f,o){if(s&&ft.isObject(s)&&s instanceof ht)return s;var u=new ht;return u.parse(s,f,o),u}function xl(){if(In)return Rr;In=!0;var s=Ve;function f(i){if(typeof i!="string")throw new TypeError("Path must be a string. Received "+JSON.stringify(i))}function o(i,e){for(var r="",t=0,n=-1,l=0,d,p=0;p<=i.length;++p){if(p<i.length)d=i.charCodeAt(p);else{if(d===47)break;d=47}if(d===47){if(!(n===p-1||l===1))if(n!==p-1&&l===2){if(r.length<2||t!==2||r.charCodeAt(r.length-1)!==46||r.charCodeAt(r.length-2)!==46){if(r.length>2){var b=r.lastIndexOf("/");if(b!==r.length-1){b===-1?(r="",t=0):(r=r.slice(0,b),t=r.length-1-r.lastIndexOf("/")),n=p,l=0;continue}}else if(r.length===2||r.length===1){r="",t=0,n=p,l=0;continue}}e&&(r.length>0?r+="/..":r="..",t=2)}else r.length>0?r+="/"+i.slice(n+1,p):r=i.slice(n+1,p),t=p-n-1;n=p,l=0}else d===46&&l!==-1?++l:l=-1}return r}function u(i,e){var r=e.dir||e.root,t=e.base||(e.name||"")+(e.ext||"");return r?r===e.root?r+t:r+i+t:t}var c={resolve:function(){for(var i="",e=!1,r,t=arguments.length-1;t>=-1&&!e;t--){var n;t>=0?n=arguments[t]:(r===void 0&&(r=s.cwd()),n=r),f(n),n.length!==0&&(i=n+"/"+i,e=n.charCodeAt(0)===47)}return i=o(i,!e),e?i.length>0?"/"+i:"/":i.length>0?i:"."},normalize:function(i){if(f(i),i.length===0)return".";var e=i.charCodeAt(0)===47,r=i.charCodeAt(i.length-1)===47;return i=o(i,!e),i.length===0&&!e&&(i="."),i.length>0&&r&&(i+="/"),e?"/"+i:i},isAbsolute:function(i){return f(i),i.length>0&&i.charCodeAt(0)===47},join:function(){if(arguments.length===0)return".";for(var i,e=0;e<arguments.length;++e){var r=arguments[e];f(r),r.length>0&&(i===void 0?i=r:i+="/"+r)}return i===void 0?".":c.normalize(i)},relative:function(i,e){if(f(i),f(e),i===e||(i=c.resolve(i),e=c.resolve(e),i===e))return"";for(var r=1;r<i.length&&i.charCodeAt(r)===47;++r);for(var t=i.length,n=t-r,l=1;l<e.length&&e.charCodeAt(l)===47;++l);for(var d=e.length,p=d-l,b=n<p?n:p,m=-1,w=0;w<=b;++w){if(w===b){if(p>b){if(e.charCodeAt(l+w)===47)return e.slice(l+w+1);if(w===0)return e.slice(l+w)}else n>b&&(i.charCodeAt(r+w)===47?m=w:w===0&&(m=0));break}var E=i.charCodeAt(r+w),I=e.charCodeAt(l+w);if(E!==I)break;E===47&&(m=w)}var y="";for(w=r+m+1;w<=t;++w)(w===t||i.charCodeAt(w)===47)&&(y.length===0?y+="..":y+="/..");return y.length>0?y+e.slice(l+m):(l+=m,e.charCodeAt(l)===47&&++l,e.slice(l))},_makeLong:function(i){return i},dirname:function(i){if(f(i),i.length===0)return".";for(var e=i.charCodeAt(0),r=e===47,t=-1,n=!0,l=i.length-1;l>=1;--l)if(e=i.charCodeAt(l),e===47){if(!n){t=l;break}}else n=!1;return t===-1?r?"/":".":r&&t===1?"//":i.slice(0,t)},basename:function(i,e){if(e!==void 0&&typeof e!="string")throw new TypeError('"ext" argument must be a string');f(i);var r=0,t=-1,n=!0,l;if(e!==void 0&&e.length>0&&e.length<=i.length){if(e.length===i.length&&e===i)return"";var d=e.length-1,p=-1;for(l=i.length-1;l>=0;--l){var b=i.charCodeAt(l);if(b===47){if(!n){r=l+1;break}}else p===-1&&(n=!1,p=l+1),d>=0&&(b===e.charCodeAt(d)?--d===-1&&(t=l):(d=-1,t=p))}return r===t?t=p:t===-1&&(t=i.length),i.slice(r,t)}else{for(l=i.length-1;l>=0;--l)if(i.charCodeAt(l)===47){if(!n){r=l+1;break}}else t===-1&&(n=!1,t=l+1);return t===-1?"":i.slice(r,t)}},extname:function(i){f(i);for(var e=-1,r=0,t=-1,n=!0,l=0,d=i.length-1;d>=0;--d){var p=i.charCodeAt(d);if(p===47){if(!n){r=d+1;break}continue}t===-1&&(n=!1,t=d+1),p===46?e===-1?e=d:l!==1&&(l=1):e!==-1&&(l=-1)}return e===-1||t===-1||l===0||l===1&&e===t-1&&e===r+1?"":i.slice(e,t)},format:function(i){if(i===null||typeof i!="object")throw new TypeError('The "pathObject" argument must be of type Object. Received type '+typeof i);return u("/",i)},parse:function(i){f(i);var e={root:"",dir:"",base:"",ext:"",name:""};if(i.length===0)return e;var r=i.charCodeAt(0),t=r===47,n;t?(e.root="/",n=1):n=0;for(var l=-1,d=0,p=-1,b=!0,m=i.length-1,w=0;m>=n;--m){if(r=i.charCodeAt(m),r===47){if(!b){d=m+1;break}continue}p===-1&&(b=!1,p=m+1),r===46?l===-1?l=m:w!==1&&(w=1):l!==-1&&(w=-1)}return l===-1||p===-1||w===0||w===1&&l===p-1&&l===d+1?p!==-1&&(d===0&&t?e.base=e.name=i.slice(1,p):e.base=e.name=i.slice(d,p)):(d===0&&t?(e.name=i.slice(1,l),e.base=i.slice(1,p)):(e.name=i.slice(d,l),e.base=i.slice(d,p)),e.ext=i.slice(l,p)),d>0?e.dir=i.slice(0,d-1):t&&(e.dir="/"),e},sep:"/",delimiter:":",win32:null,posix:null};return c.posix=c,Rr=c,Rr}function Ml(s){if(typeof s=="string")s=new URL(s);else if(!(s instanceof URL))throw new Deno.errors.InvalidData("invalid argument path , must be a string or URL");if(s.protocol!=="file:")throw new Deno.errors.InvalidData("invalid url scheme");return xr?Ll(s):Ul(s)}function Ll(s){let f=s.hostname,o=s.pathname;for(let u=0;u<o.length;u++)if(o[u]==="%"){let c=o.codePointAt(u+2)||32;if(o[u+1]==="2"&&c===102||o[u+1]==="5"&&c===99)throw new Deno.errors.InvalidData("must not include encoded \\ or / characters")}if(o=o.replace(Os,"\\"),o=decodeURIComponent(o),f!=="")return`\\\\${f}${o}`;{let u=o.codePointAt(1)|32,c=o[2];if(u<ks||u>Ts||c!==":")throw new Deno.errors.InvalidData("file url path must be absolute");return o.slice(1)}}function Ul(s){if(s.hostname!=="")throw new Deno.errors.InvalidData("invalid file url hostname");let f=s.pathname;for(let o=0;o<f.length;o++)if(f[o]==="%"){let u=f.codePointAt(o+2)||32;if(f[o+1]==="2"&&u===102)throw new Deno.errors.InvalidData("must not include encoded / characters")}return decodeURIComponent(f)}function jl(s){let f=kn.resolve(s),o=s.charCodeAt(s.length-1);(o===Is||xr&&o===As)&&f[f.length-1]!==kn.sep&&(f+="/");let u=new URL("file://");return f.includes("%")&&(f=f.replace(Ps,"%25")),!xr&&f.includes("\\")&&(f=f.replace(Cs,"%5C")),f.includes(`
`)&&(f=f.replace(Rs,"%0A")),f.includes("\r")&&(f=f.replace(Bs,"%0D")),f.includes("	")&&(f=f.replace(xs,"%09")),u.pathname=f,u}function Es(s){if(typeof s=="string")s=new URL(s);else if(!(s instanceof URL))throw new Deno.errors.InvalidData("invalid argument path , must be a string or URL");if(s.protocol!=="file:")throw new Deno.errors.InvalidData("invalid url scheme");return Mr?Nl(s):Dl(s)}function Nl(s){let f=s.hostname,o=s.pathname;for(let u=0;u<o.length;u++)if(o[u]==="%"){let c=o.codePointAt(u+2)||32;if(o[u+1]==="2"&&c===102||o[u+1]==="5"&&c===99)throw new Deno.errors.InvalidData("must not include encoded \\ or / characters")}if(o=o.replace(Hs,"\\"),o=decodeURIComponent(o),f!=="")return`\\\\${f}${o}`;{let u=o.codePointAt(1)|32,c=o[2];if(u<$s||u>qs||c!==":")throw new Deno.errors.InvalidData("file url path must be absolute");return o.slice(1)}}function Dl(s){if(s.hostname!=="")throw new Deno.errors.InvalidData("invalid file url hostname");let f=s.pathname;for(let o=0;o<f.length;o++)if(f[o]==="%"){let u=f.codePointAt(o+2)||32;if(f[o+1]==="2"&&u===102)throw new Deno.errors.InvalidData("must not include encoded / characters")}return decodeURIComponent(f)}function Ss(s){let f=An.resolve(s),o=s.charCodeAt(s.length-1);(o===Ws||Mr&&o===Fs)&&f[f.length-1]!==An.sep&&(f+="/");let u=new URL("file://");return f.includes("%")&&(f=f.replace(Vs,"%25")),!Mr&&f.includes("\\")&&(f=f.replace(zs,"%5C")),f.includes(`
`)&&(f=f.replace(Qs,"%0A")),f.includes("\r")&&(f=f.replace(Ks,"%0D")),f.includes("	")&&(f=f.replace(Gs,"%09")),u.pathname=f,u}var Ue,no,ft,oo,so,ao,lo,vr,ii,ni,oi,uo,ho,_r,qt,Er,Rr,In,kn,co,As,Is,ks,Ts,xr,Os,Ps,Cs,Rs,Bs,xs,fo,Ms,Ls,Us,js,Ns,Ds,Fs,Ws,$s,qs,Mr,Hs,Vs,zs,Qs,Ks,Gs,Fl=it(()=>{fe(),pe(),de(),Il(),Tl(),Pl(),Bl(),vs(),Ue={},no=Lt,ft={isString:function(s){return typeof s=="string"},isObject:function(s){return typeof s=="object"&&s!==null},isNull:function(s){return s===null},isNullOrUndefined:function(s){return s==null}},Ue.parse=ar,Ue.resolve=function(s,f){return ar(s,!1,!0).resolve(f)},Ue.resolveObject=function(s,f){return s?ar(s,!1,!0).resolveObject(f):f},Ue.format=function(s){return ft.isString(s)&&(s=ar(s)),s instanceof ht?s.format():ht.prototype.format.call(s)},Ue.Url=ht,oo=/^([a-z0-9.+-]+:)/i,so=/:[0-9]*$/,ao=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,lo=["{","}","|","\\","^","`"].concat(["<",">",'"',"`"," ","\r",`
`,"	"]),vr=["'"].concat(lo),ii=["%","/","?",";","#"].concat(vr),ni=["/","?","#"],oi=/^[+a-z0-9A-Z_-]{0,63}$/,uo=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,ho={javascript:!0,"javascript:":!0},_r={javascript:!0,"javascript:":!0},qt={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},Er=pt,ht.prototype.parse=function(s,f,o){if(!ft.isString(s))throw new TypeError("Parameter 'url' must be a string, not "+typeof s);var u=s.indexOf("?"),c=u!==-1&&u<s.indexOf("#")?"?":"#",i=s.split(c);i[0]=i[0].replace(/\\/g,"/");var e=s=i.join(c);if(e=e.trim(),!o&&s.split("#").length===1){var r=ao.exec(e);if(r)return this.path=e,this.href=e,this.pathname=r[1],r[2]?(this.search=r[2],this.query=f?Er.parse(this.search.substr(1)):this.search.substr(1)):f&&(this.search="",this.query={}),this}var t=oo.exec(e);if(t){var n=(t=t[0]).toLowerCase();this.protocol=n,e=e.substr(t.length)}if(o||t||e.match(/^\/\/[^@\/]+@[^@\/]+/)){var l=e.substr(0,2)==="//";!l||t&&_r[t]||(e=e.substr(2),this.slashes=!0)}if(!_r[t]&&(l||t&&!qt[t])){for(var d,p,b=-1,m=0;m<ni.length;m++)(w=e.indexOf(ni[m]))!==-1&&(b===-1||w<b)&&(b=w);for((p=b===-1?e.lastIndexOf("@"):e.lastIndexOf("@",b))!==-1&&(d=e.slice(0,p),e=e.slice(p+1),this.auth=decodeURIComponent(d)),b=-1,m=0;m<ii.length;m++){var w;(w=e.indexOf(ii[m]))!==-1&&(b===-1||w<b)&&(b=w)}b===-1&&(b=e.length),this.host=e.slice(0,b),e=e.slice(b),this.parseHost(),this.hostname=this.hostname||"";var E=this.hostname[0]==="["&&this.hostname[this.hostname.length-1]==="]";if(!E)for(var I=this.hostname.split(/\./),y=(m=0,I.length);m<y;m++){var _=I[m];if(_&&!_.match(oi)){for(var N="",B=0,A=_.length;B<A;B++)_.charCodeAt(B)>127?N+="x":N+=_[B];if(!N.match(oi)){var k=I.slice(0,m),M=I.slice(m+1),J=_.match(uo);J&&(k.push(J[1]),M.unshift(J[2])),M.length&&(e="/"+M.join(".")+e),this.hostname=k.join(".");break}}}this.hostname.length>255?this.hostname="":this.hostname=this.hostname.toLowerCase(),E||(this.hostname=no.toASCII(this.hostname));var X=this.port?":"+this.port:"",ue=this.hostname||"";this.host=ue+X,this.href+=this.host,E&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),e[0]!=="/"&&(e="/"+e))}if(!ho[n])for(m=0,y=vr.length;m<y;m++){var C=vr[m];if(e.indexOf(C)!==-1){var q=encodeURIComponent(C);q===C&&(q=escape(C)),e=e.split(C).join(q)}}var K=e.indexOf("#");K!==-1&&(this.hash=e.substr(K),e=e.slice(0,K));var j=e.indexOf("?");if(j!==-1?(this.search=e.substr(j),this.query=e.substr(j+1),f&&(this.query=Er.parse(this.query)),e=e.slice(0,j)):f&&(this.search="",this.query={}),e&&(this.pathname=e),qt[n]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){X=this.pathname||"";var te=this.search||"";this.path=X+te}return this.href=this.format(),this},ht.prototype.format=function(){var s=this.auth||"";s&&(s=(s=encodeURIComponent(s)).replace(/%3A/i,":"),s+="@");var f=this.protocol||"",o=this.pathname||"",u=this.hash||"",c=!1,i="";this.host?c=s+this.host:this.hostname&&(c=s+(this.hostname.indexOf(":")===-1?this.hostname:"["+this.hostname+"]"),this.port&&(c+=":"+this.port)),this.query&&ft.isObject(this.query)&&Object.keys(this.query).length&&(i=Er.stringify(this.query));var e=this.search||i&&"?"+i||"";return f&&f.substr(-1)!==":"&&(f+=":"),this.slashes||(!f||qt[f])&&c!==!1?(c="//"+(c||""),o&&o.charAt(0)!=="/"&&(o="/"+o)):c||(c=""),u&&u.charAt(0)!=="#"&&(u="#"+u),e&&e.charAt(0)!=="?"&&(e="?"+e),f+c+(o=o.replace(/[?#]/g,function(r){return encodeURIComponent(r)}))+(e=e.replace("#","%23"))+u},ht.prototype.resolve=function(s){return this.resolveObject(ar(s,!1,!0)).format()},ht.prototype.resolveObject=function(s){if(ft.isString(s)){var f=new ht;f.parse(s,!1,!0),s=f}for(var o=new ht,u=Object.keys(this),c=0;c<u.length;c++){var i=u[c];o[i]=this[i]}if(o.hash=s.hash,s.href==="")return o.href=o.format(),o;if(s.slashes&&!s.protocol){for(var e=Object.keys(s),r=0;r<e.length;r++){var t=e[r];t!=="protocol"&&(o[t]=s[t])}return qt[o.protocol]&&o.hostname&&!o.pathname&&(o.path=o.pathname="/"),o.href=o.format(),o}if(s.protocol&&s.protocol!==o.protocol){if(!qt[s.protocol]){for(var n=Object.keys(s),l=0;l<n.length;l++){var d=n[l];o[d]=s[d]}return o.href=o.format(),o}if(o.protocol=s.protocol,s.host||_r[s.protocol])o.pathname=s.pathname;else{for(var p=(s.pathname||"").split("/");p.length&&!(s.host=p.shift()););s.host||(s.host=""),s.hostname||(s.hostname=""),p[0]!==""&&p.unshift(""),p.length<2&&p.unshift(""),o.pathname=p.join("/")}if(o.search=s.search,o.query=s.query,o.host=s.host||"",o.auth=s.auth,o.hostname=s.hostname||s.host,o.port=s.port,o.pathname||o.search){var b=o.pathname||"",m=o.search||"";o.path=b+m}return o.slashes=o.slashes||s.slashes,o.href=o.format(),o}var w=o.pathname&&o.pathname.charAt(0)==="/",E=s.host||s.pathname&&s.pathname.charAt(0)==="/",I=E||w||o.host&&s.pathname,y=I,_=o.pathname&&o.pathname.split("/")||[],N=(p=s.pathname&&s.pathname.split("/")||[],o.protocol&&!qt[o.protocol]);if(N&&(o.hostname="",o.port=null,o.host&&(_[0]===""?_[0]=o.host:_.unshift(o.host)),o.host="",s.protocol&&(s.hostname=null,s.port=null,s.host&&(p[0]===""?p[0]=s.host:p.unshift(s.host)),s.host=null),I=I&&(p[0]===""||_[0]==="")),E)o.host=s.host||s.host===""?s.host:o.host,o.hostname=s.hostname||s.hostname===""?s.hostname:o.hostname,o.search=s.search,o.query=s.query,_=p;else if(p.length)_||(_=[]),_.pop(),_=_.concat(p),o.search=s.search,o.query=s.query;else if(!ft.isNullOrUndefined(s.search))return N&&(o.hostname=o.host=_.shift(),(J=!!(o.host&&o.host.indexOf("@")>0)&&o.host.split("@"))&&(o.auth=J.shift(),o.host=o.hostname=J.shift())),o.search=s.search,o.query=s.query,ft.isNull(o.pathname)&&ft.isNull(o.search)||(o.path=(o.pathname?o.pathname:"")+(o.search?o.search:"")),o.href=o.format(),o;if(!_.length)return o.pathname=null,o.search?o.path="/"+o.search:o.path=null,o.href=o.format(),o;for(var B=_.slice(-1)[0],A=(o.host||s.host||_.length>1)&&(B==="."||B==="..")||B==="",k=0,M=_.length;M>=0;M--)(B=_[M])==="."?_.splice(M,1):B===".."?(_.splice(M,1),k++):k&&(_.splice(M,1),k--);if(!I&&!y)for(;k--;k)_.unshift("..");!I||_[0]===""||_[0]&&_[0].charAt(0)==="/"||_.unshift(""),A&&_.join("/").substr(-1)!=="/"&&_.push("");var J,X=_[0]===""||_[0]&&_[0].charAt(0)==="/";return N&&(o.hostname=o.host=X?"":_.length?_.shift():"",(J=!!(o.host&&o.host.indexOf("@")>0)&&o.host.split("@"))&&(o.auth=J.shift(),o.host=o.hostname=J.shift())),(I=I||o.host&&_.length)&&!X&&_.unshift(""),_.length?o.pathname=_.join("/"):(o.pathname=null,o.path=null),ft.isNull(o.pathname)&&ft.isNull(o.search)||(o.path=(o.pathname?o.pathname:"")+(o.search?o.search:"")),o.auth=s.auth||o.auth,o.slashes=o.slashes||s.slashes,o.href=o.format(),o},ht.prototype.parseHost=function(){var s=this.host,f=so.exec(s);f&&((f=f[0])!==":"&&(this.port=f.substr(1)),s=s.substr(0,s.length-f.length)),s&&(this.hostname=s)},Ue.Url,Ue.format,Ue.resolve,Ue.resolveObject,Rr={},In=!1,kn=xl(),co=typeof Deno<"u"?Deno.build.os==="windows"?"win32":Deno.build.os:void 0,Ue.URL=typeof URL<"u"?URL:null,Ue.pathToFileURL=jl,Ue.fileURLToPath=Ml,Ue.Url,Ue.format,Ue.resolve,Ue.resolveObject,Ue.URL,As=92,Is=47,ks=97,Ts=122,xr=co==="win32",Os=/\//g,Ps=/%/g,Cs=/\\/g,Rs=/\n/g,Bs=/\r/g,xs=/\t/g,fo=typeof Deno<"u"?Deno.build.os==="windows"?"win32":Deno.build.os:void 0,Ue.URL=typeof URL<"u"?URL:null,Ue.pathToFileURL=Ss,Ue.fileURLToPath=Es,Ms=Ue.Url,Ls=Ue.format,Us=Ue.resolve,js=Ue.resolveObject,Ns=Ue.parse,Ds=Ue.URL,Fs=92,Ws=47,$s=97,qs=122,Mr=fo==="win32",Hs=/\//g,Vs=/%/g,zs=/\\/g,Qs=/\n/g,Ks=/\r/g,Gs=/\t/g}),Wl=me((s,f)=>{fe(),pe(),de(),f.exports=function(){throw new Error("ws does not work in the browser. Browser clients must use the native WebSocket object")}}),Mn=me(s=>{fe(),pe(),de(),Object.defineProperty(s,"__esModule",{value:!0}),s.BufferedDuplex=void 0,s.writev=u;var f=Xt(),o=(Je(),Ne(Ye));function u(i,e){let r=new Array(i.length);for(let t=0;t<i.length;t++)typeof i[t].chunk=="string"?r[t]=o.Buffer.from(i[t].chunk,"utf8"):r[t]=i[t].chunk;this._write(o.Buffer.concat(r),"binary",e)}var c=class extends f.Duplex{constructor(i,e,r){super({objectMode:!0}),this.proxy=e,this.socket=r,this.writeQueue=[],i.objectMode||(this._writev=u.bind(this)),this.isSocketOpen=!1,this.proxy.on("data",t=>{!this.destroyed&&this.readable&&this.push(t)})}_read(i){this.proxy.read(i)}_write(i,e,r){this.isSocketOpen?this.writeToProxy(i,e,r):this.writeQueue.push({chunk:i,encoding:e,cb:r})}_final(i){this.writeQueue=[],this.proxy.end(i)}_destroy(i,e){this.writeQueue=[],this.proxy.destroy(),e(i)}socketReady(){this.emit("connect"),this.isSocketOpen=!0,this.processWriteQueue()}writeToProxy(i,e,r){this.proxy.write(i,e)===!1?this.proxy.once("drain",r):r()}processWriteQueue(){for(;this.writeQueue.length>0;){let{chunk:i,encoding:e,cb:r}=this.writeQueue.shift();this.writeToProxy(i,e,r)}}};s.BufferedDuplex=c}),Sr=me(s=>{fe(),pe(),de();var f=s&&s.__importDefault||function(I){return I&&I.__esModule?I:{default:I}};Object.defineProperty(s,"__esModule",{value:!0}),s.streamBuilder=s.browserStreamBuilder=void 0;var o=(Je(),Ne(Ye)),u=f(Wl()),c=f(kt()),i=Xt(),e=f(Fr()),r=Mn(),t=(0,c.default)("mqttjs:ws"),n=["rejectUnauthorized","ca","cert","key","pfx","passphrase"];function l(I,y){let _=`${I.protocol}://${I.hostname}:${I.port}${I.path}`;return typeof I.transformWsUrl=="function"&&(_=I.transformWsUrl(_,I,y)),_}function d(I){let y=I;return I.port||(I.protocol==="wss"?y.port=443:y.port=80),I.path||(y.path="/"),I.wsOptions||(y.wsOptions={}),!e.default&&!I.forceNativeWebSocket&&I.protocol==="wss"&&n.forEach(_=>{Object.prototype.hasOwnProperty.call(I,_)&&!Object.prototype.hasOwnProperty.call(I.wsOptions,_)&&(y.wsOptions[_]=I[_])}),y}function p(I){let y=d(I);if(y.hostname||(y.hostname=y.host),!y.hostname){if(typeof document>"u")throw new Error("Could not determine host. Specify host manually.");let _=new URL(document.URL);y.hostname=_.hostname,y.port||(y.port=Number(_.port))}return y.objectMode===void 0&&(y.objectMode=!(y.binary===!0||y.binary===void 0)),y}function b(I,y,_){t("createWebSocket"),t(`protocol: ${_.protocolId} ${_.protocolVersion}`);let N=_.protocolId==="MQIsdp"&&_.protocolVersion===3?"mqttv3.1":"mqtt";t(`creating new Websocket for url: ${y} and protocol: ${N}`);let B;return _.createWebsocket?B=_.createWebsocket(y,[N],_):B=new u.default(y,[N],_.wsOptions),B}function m(I,y){let _=y.protocolId==="MQIsdp"&&y.protocolVersion===3?"mqttv3.1":"mqtt",N=l(y,I),B;return y.createWebsocket?B=y.createWebsocket(N,[_],y):B=new WebSocket(N,[_]),B.binaryType="arraybuffer",B}var w=(I,y)=>{t("streamBuilder");let _=d(y);_.hostname=_.hostname||_.host||"localhost";let N=l(_,I),B=b(I,N,_),A=u.default.createWebSocketStream(B,_.wsOptions);return A.url=N,B.on("close",()=>{A.destroy()}),A};s.streamBuilder=w;var E=(I,y)=>{t("browserStreamBuilder");let _,N=p(y).browserBufferSize||1024*512,B=y.browserBufferTimeout||1e3,A=!y.objectMode,k=m(I,y),M=X(y,j,te);y.objectMode||(M._writev=r.writev.bind(M)),M.on("close",()=>{k.close()});let J=typeof k.addEventListener<"u";k.readyState===k.OPEN?(_=M,_.socket=k):(_=new r.BufferedDuplex(y,M,k),J?k.addEventListener("open",ue):k.onopen=ue),J?(k.addEventListener("close",C),k.addEventListener("error",q),k.addEventListener("message",K)):(k.onclose=C,k.onerror=q,k.onmessage=K);function X(ae,ie,ve){let z=new i.Transform({objectMode:ae.objectMode});return z._write=ie,z._flush=ve,z}function ue(){t("WebSocket onOpen"),_ instanceof r.BufferedDuplex&&_.socketReady()}function C(ae){t("WebSocket onClose",ae),_.end(),_.destroy()}function q(ae){t("WebSocket onError",ae);let ie=new Error("WebSocket error");ie.event=ae,_.destroy(ie)}async function K(ae){if(!M||M.destroyed||!M.readable)return;let{data:ie}=ae;ie instanceof ArrayBuffer?ie=o.Buffer.from(ie):ie instanceof Blob?ie=o.Buffer.from(await new Response(ie).arrayBuffer()):ie=o.Buffer.from(ie,"utf8"),M.push(ie)}function j(ae,ie,ve){if(k.bufferedAmount>N){setTimeout(j,B,ae,ie,ve);return}A&&typeof ae=="string"&&(ae=o.Buffer.from(ae,"utf8"));try{k.send(ae)}catch(z){return ve(z)}ve()}function te(ae){k.close(),ae()}return _};s.browserStreamBuilder=E}),Ln={};rr(Ln,{Server:()=>He,Socket:()=>He,Stream:()=>He,_createServerHandle:()=>He,_normalizeArgs:()=>He,_setSimultaneousAccepts:()=>He,connect:()=>He,createConnection:()=>He,createServer:()=>He,default:()=>Ys,isIP:()=>He,isIPv4:()=>He,isIPv6:()=>He});function He(){throw new Error("Node.js net module is not supported by JSPM core outside of Node.js")}var Ys,Js=it(()=>{fe(),pe(),de(),Ys={_createServerHandle:He,_normalizeArgs:He,_setSimultaneousAccepts:He,connect:He,createConnection:He,createServer:He,isIP:He,isIPv4:He,isIPv6:He,Server:He,Socket:He,Stream:He}}),Xs=me((s,f)=>{fe(),pe(),de(),f.exports={}}),po=me(s=>{fe(),pe(),de();var f=s&&s.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(s,"__esModule",{value:!0});var o=f((Js(),Ne(Ln))),u=f(kt()),c=f(Xs()),i=(0,u.default)("mqttjs:tcp"),e=(r,t)=>{if(t.port=t.port||1883,t.hostname=t.hostname||t.host||"localhost",t.socksProxy)return(0,c.default)(t.hostname,t.port,t.socksProxy,{timeout:t.socksTimeout});let{port:n,path:l}=t,d=t.hostname;return i("port %d and host %s",n,d),o.default.createConnection({port:n,host:d,path:l})};s.default=e}),Zs={};rr(Zs,{default:()=>ea});var ea,$l=it(()=>{fe(),pe(),de(),ea={}}),go=me(s=>{fe(),pe(),de();var f=s&&s.__rest||function(l,d){var p={};for(var b in l)Object.prototype.hasOwnProperty.call(l,b)&&d.indexOf(b)<0&&(p[b]=l[b]);if(l!=null&&typeof Object.getOwnPropertySymbols=="function")for(var m=0,b=Object.getOwnPropertySymbols(l);m<b.length;m++)d.indexOf(b[m])<0&&Object.prototype.propertyIsEnumerable.call(l,b[m])&&(p[b[m]]=l[b[m]]);return p},o=s&&s.__importDefault||function(l){return l&&l.__esModule?l:{default:l}};Object.defineProperty(s,"__esModule",{value:!0});var u=o(($l(),Ne(Zs))),c=o((Js(),Ne(Ln))),i=o(kt()),e=o(Xs()),r=(0,i.default)("mqttjs:tls");function t(l){let{host:d,port:p,socksProxy:b}=l,m=f(l,["host","port","socksProxy"]);return u.default.connect(b?Object.assign(Object.assign({},m),{socket:(0,e.default)(d,p,b,{timeout:l.socksTimeout})}):l)}var n=(l,d)=>{d.port=d.port||8883,d.host=d.hostname||d.host||"localhost",c.default.isIP(d.host)===0&&(d.servername=d.host),d.rejectUnauthorized=d.rejectUnauthorized!==!1,delete d.path,r("port %d host %s rejectUnauthorized %b",d.port,d.host,d.rejectUnauthorized);let p=t(d);p.on("secureConnect",()=>{d.rejectUnauthorized&&!p.authorized?p.emit("error",new Error("TLS not authorized")):p.removeListener("error",b)});function b(m){d.rejectUnauthorized&&l.emit("error",m),p.end()}return p.on("error",b),p};s.default=n}),bo=me(s=>{fe(),pe(),de(),Object.defineProperty(s,"__esModule",{value:!0});var f=(Je(),Ne(Ye)),o=Xt(),u=Mn(),c,i,e;function r(){let p=new o.Transform;return p._write=(b,m,w)=>{c.send({data:b.buffer,success(){w()},fail(E){w(new Error(E))}})},p._flush=b=>{c.close({success(){b()}})},p}function t(p){p.hostname||(p.hostname="localhost"),p.path||(p.path="/"),p.wsOptions||(p.wsOptions={})}function n(p,b){let m=p.protocol==="wxs"?"wss":"ws",w=`${m}://${p.hostname}${p.path}`;return p.port&&p.port!==80&&p.port!==443&&(w=`${m}://${p.hostname}:${p.port}${p.path}`),typeof p.transformWsUrl=="function"&&(w=p.transformWsUrl(w,p,b)),w}function l(){c.onOpen(()=>{e.socketReady()}),c.onMessage(p=>{let{data:b}=p;b instanceof ArrayBuffer?b=f.Buffer.from(b):b=f.Buffer.from(b,"utf8"),i.push(b)}),c.onClose(()=>{e.emit("close"),e.end(),e.destroy()}),c.onError(p=>{let b=new Error(p.errMsg);e.destroy(b)})}var d=(p,b)=>{if(b.hostname=b.hostname||b.host,!b.hostname)throw new Error("Could not determine host. Specify host manually.");let m=b.protocolId==="MQIsdp"&&b.protocolVersion===3?"mqttv3.1":"mqtt";t(b);let w=n(b,p);c=wx.connectSocket({url:w,protocols:[m]}),i=r(),e=new u.BufferedDuplex(b,i,c),e._destroy=(I,y)=>{c.close({success(){y&&y(I)}})};let E=e.destroy;return e.destroy=(I,y)=>(e.destroy=E,setTimeout(()=>{c.close({fail(){e._destroy(I,y)}})},0),e),l(),e};s.default=d}),mo=me(s=>{fe(),pe(),de(),Object.defineProperty(s,"__esModule",{value:!0});var f=(Je(),Ne(Ye)),o=Xt(),u=Mn(),c,i,e,r=!1;function t(){let b=new o.Transform;return b._write=(m,w,E)=>{c.sendSocketMessage({data:m.buffer,success(){E()},fail(){E(new Error)}})},b._flush=m=>{c.closeSocket({success(){m()}})},b}function n(b){b.hostname||(b.hostname="localhost"),b.path||(b.path="/"),b.wsOptions||(b.wsOptions={})}function l(b,m){let w=b.protocol==="alis"?"wss":"ws",E=`${w}://${b.hostname}${b.path}`;return b.port&&b.port!==80&&b.port!==443&&(E=`${w}://${b.hostname}:${b.port}${b.path}`),typeof b.transformWsUrl=="function"&&(E=b.transformWsUrl(E,b,m)),E}function d(){r||(r=!0,c.onSocketOpen(()=>{e.socketReady()}),c.onSocketMessage(b=>{if(typeof b.data=="string"){let m=f.Buffer.from(b.data,"base64");i.push(m)}else{let m=new FileReader;m.addEventListener("load",()=>{let w=m.result;w instanceof ArrayBuffer?w=f.Buffer.from(w):w=f.Buffer.from(w,"utf8"),i.push(w)}),m.readAsArrayBuffer(b.data)}}),c.onSocketClose(()=>{e.end(),e.destroy()}),c.onSocketError(b=>{e.destroy(b)}))}var p=(b,m)=>{if(m.hostname=m.hostname||m.host,!m.hostname)throw new Error("Could not determine host. Specify host manually.");let w=m.protocolId==="MQIsdp"&&m.protocolVersion===3?"mqttv3.1":"mqtt";n(m);let E=l(m,b);return c=m.my,c.connectSocket({url:E,protocols:w}),i=t(),e=new u.BufferedDuplex(m,i,c),d(),e};s.default=p}),ql=me(s=>{fe(),pe(),de();var f=s&&s.__importDefault||function(d){return d&&d.__esModule?d:{default:d}};Object.defineProperty(s,"__esModule",{value:!0}),s.connectAsync=l;var o=f(kt()),u=f((Fl(),Ne(_s))),c=f(yn()),i=f(Fr());typeof(Me==null?void 0:Me.nextTick)!="function"&&(Me.nextTick=setImmediate);var e=(0,o.default)("mqttjs"),r=null;function t(d){let p;d.auth&&(p=d.auth.match(/^(.+):(.+)$/),p?(d.username=p[1],d.password=p[2]):d.username=d.auth)}function n(d,p){var b,m,w;if(e("connecting to an MQTT broker..."),typeof d=="object"&&!p&&(p=d,d=""),p=p||{},d&&typeof d=="string"){let y=u.default.parse(d,!0),_={};if(y.port!=null&&(_.port=Number(y.port)),_.host=y.hostname,_.query=y.query,_.auth=y.auth,_.protocol=y.protocol,_.path=y.path,p=Object.assign(Object.assign({},_),p),!p.protocol)throw new Error("Missing protocol");p.protocol=p.protocol.replace(/:$/,"")}if(p.unixSocket=p.unixSocket||((b=p.protocol)===null||b===void 0?void 0:b.includes("+unix")),p.unixSocket?p.protocol=p.protocol.replace("+unix",""):!(!((m=p.protocol)===null||m===void 0)&&m.startsWith("ws"))&&!(!((w=p.protocol)===null||w===void 0)&&w.startsWith("wx"))&&delete p.path,t(p),p.query&&typeof p.query.clientId=="string"&&(p.clientId=p.query.clientId),i.default||p.unixSocket?p.socksProxy=void 0:p.socksProxy===void 0&&typeof Me<"u"&&(p.socksProxy=Me.env.MQTTJS_SOCKS_PROXY),p.cert&&p.key)if(p.protocol){if(["mqtts","wss","wxs","alis"].indexOf(p.protocol)===-1)switch(p.protocol){case"mqtt":p.protocol="mqtts";break;case"ws":p.protocol="wss";break;case"wx":p.protocol="wxs";break;case"ali":p.protocol="alis";break;default:throw new Error(`Unknown protocol for secure connection: "${p.protocol}"!`)}}else throw new Error("Missing secure protocol key");if(r||(r={},!i.default&&!p.forceNativeWebSocket?(r.ws=Sr().streamBuilder,r.wss=Sr().streamBuilder,r.mqtt=po().default,r.tcp=po().default,r.ssl=go().default,r.tls=r.ssl,r.mqtts=go().default):(r.ws=Sr().browserStreamBuilder,r.wss=Sr().browserStreamBuilder,r.wx=bo().default,r.wxs=bo().default,r.ali=mo().default,r.alis=mo().default)),!r[p.protocol]){let y=["mqtts","wss"].indexOf(p.protocol)!==-1;p.protocol=["mqtt","mqtts","ws","wss","wx","wxs","ali","alis"].filter((_,N)=>y&&N%2===0?!1:typeof r[_]=="function")[0]}if(p.clean===!1&&!p.clientId)throw new Error("Missing clientId for unclean clients");p.protocol&&(p.defaultProtocol=p.protocol);function E(y){return p.servers&&((!y._reconnectCount||y._reconnectCount===p.servers.length)&&(y._reconnectCount=0),p.host=p.servers[y._reconnectCount].host,p.port=p.servers[y._reconnectCount].port,p.protocol=p.servers[y._reconnectCount].protocol?p.servers[y._reconnectCount].protocol:p.defaultProtocol,p.hostname=p.host,y._reconnectCount++),e("calling streambuilder for",p.protocol),r[p.protocol](y,p)}let I=new c.default(E,p);return I.on("error",()=>{}),I}function l(d,p,b=!0){return new Promise((m,w)=>{let E=n(d,p),I={connect:_=>{y(),m(E)},end:()=>{y(),m(E)},error:_=>{y(),E.end(),w(_)}};b===!1&&(I.close=()=>{I.error(new Error("Couldn't connect to server"))});function y(){Object.keys(I).forEach(_=>{E.off(_,I[_])})}Object.keys(I).forEach(_=>{E.on(_,I[_])})})}s.default=n}),yo=me(s=>{fe(),pe(),de();var f=s&&s.__createBinding||(Object.create?function(b,m,w,E){E===void 0&&(E=w);var I=Object.getOwnPropertyDescriptor(m,w);(!I||("get"in I?!m.__esModule:I.writable||I.configurable))&&(I={enumerable:!0,get:function(){return m[w]}}),Object.defineProperty(b,E,I)}:function(b,m,w,E){E===void 0&&(E=w),b[E]=m[w]}),o=s&&s.__setModuleDefault||(Object.create?function(b,m){Object.defineProperty(b,"default",{enumerable:!0,value:m})}:function(b,m){b.default=m}),u=s&&s.__importStar||function(){var b=function(m){return b=Object.getOwnPropertyNames||function(w){var E=[];for(var I in w)Object.prototype.hasOwnProperty.call(w,I)&&(E[E.length]=I);return E},b(m)};return function(m){if(m&&m.__esModule)return m;var w={};if(m!=null)for(var E=b(m),I=0;I<E.length;I++)E[I]!=="default"&&f(w,m,E[I]);return o(w,m),w}}(),c=s&&s.__exportStar||function(b,m){for(var w in b)w!=="default"&&!Object.prototype.hasOwnProperty.call(m,w)&&f(m,b,w)},i=s&&s.__importDefault||function(b){return b&&b.__esModule?b:{default:b}};Object.defineProperty(s,"__esModule",{value:!0}),s.ReasonCodes=s.KeepaliveManager=s.UniqueMessageIdProvider=s.DefaultMessageIdProvider=s.Store=s.MqttClient=s.connectAsync=s.connect=s.Client=void 0;var e=i(yn());s.MqttClient=e.default;var r=i(Jo());s.DefaultMessageIdProvider=r.default;var t=i(Al());s.UniqueMessageIdProvider=t.default;var n=i(Xo());s.Store=n.default;var l=u(ql());s.connect=l.default,Object.defineProperty(s,"connectAsync",{enumerable:!0,get:function(){return l.connectAsync}});var d=i(gs());s.KeepaliveManager=d.default,s.Client=e.default,c(yn(),s),c(nr(),s);var p=Dr();Object.defineProperty(s,"ReasonCodes",{enumerable:!0,get:function(){return p.ReasonCodes}})}),Hl=me(s=>{fe(),pe(),de();var f=s&&s.__createBinding||(Object.create?function(e,r,t,n){n===void 0&&(n=t);var l=Object.getOwnPropertyDescriptor(r,t);(!l||("get"in l?!r.__esModule:l.writable||l.configurable))&&(l={enumerable:!0,get:function(){return r[t]}}),Object.defineProperty(e,n,l)}:function(e,r,t,n){n===void 0&&(n=t),e[n]=r[t]}),o=s&&s.__setModuleDefault||(Object.create?function(e,r){Object.defineProperty(e,"default",{enumerable:!0,value:r})}:function(e,r){e.default=r}),u=s&&s.__importStar||function(){var e=function(r){return e=Object.getOwnPropertyNames||function(t){var n=[];for(var l in t)Object.prototype.hasOwnProperty.call(t,l)&&(n[n.length]=l);return n},e(r)};return function(r){if(r&&r.__esModule)return r;var t={};if(r!=null)for(var n=e(r),l=0;l<n.length;l++)n[l]!=="default"&&f(t,r,n[l]);return o(t,r),t}}(),c=s&&s.__exportStar||function(e,r){for(var t in e)t!=="default"&&!Object.prototype.hasOwnProperty.call(r,t)&&f(r,e,t)};Object.defineProperty(s,"__esModule",{value:!0});var i=u(yo());s.default=i,c(yo(),s)});const Vl=Hl();/*! Bundled license information:

@jspm/core/nodelibs/browser/buffer.js:
  (*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> *)

safe-buffer/index.js:
  (*! safe-buffer. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> *)
*/class zl{constructor(f){Le(this,"client",null);Le(this,"sessionId");Le(this,"statusCallback",null);Le(this,"errorCallback",null);Le(this,"statusTimeout",null);Le(this,"statusTimeoutMs",5e3);this.sessionId=f}connect(f={}){const{host:o="mqtt.cloud.ut.ee",port:u=8084,useTLS:c=!0,statusTimeoutMs:i}=f;i!==void 0&&(this.statusTimeoutMs=i);const e=c?"wss":"ws",r={rejectUnauthorized:!0,clientId:this.sessionId,reconnectPeriod:i};this.client=Vl.connect(`${e}://${o}:${u}`,r);let t=setTimeout(()=>{t=null,console.warn("Connection timeout reached"),this.client&&(console.log("Disconnecting client due to connection timeout"),this.disconnect()),this.errorCallback&&this.errorCallback(-1)},this.statusTimeoutMs);this.client.on("connect",n=>{var l,d;t&&(clearTimeout(t),t=null),n.returnCode===0?(console.log("MQTT connected"),(l=this.client)==null||l.subscribe(`session/${this.sessionId}/status`),this.startStatusTimeout()):(console.warn("MQTT connection failed with return code:",n.returnCode),(d=this.errorCallback)==null||d.call(this,n.returnCode))}),this.client.on("message",(n,l)=>{this.handleMessage(n,l)})}startStatusTimeout(){this.clearStatusTimeout(),this.statusTimeout=setTimeout(()=>{var f,o;console.warn("Status timeout reached, disconnecting MQTT client"),(f=wo)==null||f.update(u=>u&&{...u,state:"shutting-down"}),this.disconnect(),(o=this.errorCallback)==null||o.call(this,-2)},this.statusTimeoutMs)}resetStatusTimeout(){this.startStatusTimeout()}clearStatusTimeout(){this.statusTimeout&&(clearTimeout(this.statusTimeout),this.statusTimeout=null)}onStatus(f){this.statusCallback=f}onError(f){this.errorCallback=f}handleMessage(f,o){const u=`session/${this.sessionId}/status`;if(f===u&&this.statusCallback){const c=JSON.parse(o.toString());this.statusCallback(c),this.resetStatusTimeout()}}publishGoal(f){this.publish(`session/${this.sessionId}/goal`,f)}publishRating(f,o){this.publish(`session/${this.sessionId}/rating`,{rating:f,datetime:o})}publish(f,o){this.client&&this.client.publish(f,JSON.stringify(o),{qos:1})}disconnect(){this.clearStatusTimeout(),this.client&&(this.client.end(!0),this.client=null)}}function Ql(s,f=5e3){return new Promise((o,u)=>{Kr.update(e=>(e&&e.disconnect(),null));const c=new zl(s);let i=!1;c.onStatus(e=>{wo.set(e),i||(i=!0,vo.set(s),Kr.set(c),o(c))}),c.onError(e=>{i||(i=!0,Kr.set(null),console.log("MQTT error with return code:",e),console.log("MQTT client set to null"),e===-1?St.set({key:"login_error_no_internet",params:{}}):e===-2?St.set({key:"session_closed",params:{id:s}}):St.set({key:"login_error_other",params:{returnCode:e.toString()}}),u())}),c.connect({statusTimeoutMs:f})})}var Kl=Lr('<input type="number" inputmode="numeric" pattern="\\d"/>'),Gl=Lr('<div class="error svelte-ehqysg"> </div>'),Yl=Lr('<div class="validating-container svelte-ehqysg"><div class="validating-message svelte-ehqysg"> </div> <div class="validating-spinner svelte-ehqysg"></div></div>'),Jl=Lr('<div class="login-container svelte-ehqysg"><form class="login-form svelte-ehqysg" autocomplete="off"><label for="session-id" class="svelte-ehqysg"> </label> <div class="session-id-inputs svelte-ehqysg"></div> <!></form></div>');function Xl(s,f){oa(f,!0);const[o,u]=ca(),c=()=>sr(vo,"$sessionId",o),i=()=>sr(St,"$loginErrorKey",o),e=()=>sr(y,"$sessionIdLabel",o),r=()=>sr(De(N),"$loginErrorMessage",o),t=()=>sr(_,"$validatingMessage",o);let n=br(Fn(Array(6).fill(""))),l=br(0),d=br(!1),p=Fn([]),b=br(!1);sa(()=>{c()&&(Xe(n,c().split(""),!0),m()),i()&&Xe(b,!0)}),aa(()=>{p&&p[0]&&p[0].focus()});function m(){if(!(De(d)||De(b))&&De(n).every(q=>q.length===1)){Xe(d,!0);const q=De(n).join("");Ql(q).then(()=>{St.set(null),wa.set(!0),va.set({key:"loading_map",params:{}}),_a("/app")}).catch(()=>{Xe(b,!0),Xe(l,5),setTimeout(()=>{var K;(K=p[5])==null||K.focus()},0)}).finally(()=>{Xe(d,!1)})}}function w(q,K){var ie;const j=q.target,te=j.value.replace(/\D/g,"");if(te.length===0){De(b)&&(St.set(null),Xe(b,!1)),De(n)[K]="",j.value="";return}const ae=te.replace(De(n)[K],"")[0];De(n)[K]!==ae&&De(b)&&(St.set(null),Xe(b,!1)),De(n)[K]=ae,j.value=ae,K<5&&(Xe(l,K+1),(ie=p[De(l)])==null||ie.focus()),m()}function E(q,K){var j,te,ae;q.key==="ArrowLeft"&&K>0?(Xe(l,K-1),(j=p[De(l)])==null||j.focus(),q.preventDefault()):q.key==="ArrowRight"&&K<5?(Xe(l,K+1),(te=p[De(l)])==null||te.focus(),q.preventDefault()):q.key==="Backspace"&&(De(b)&&(St.set(null),Xe(b,!1)),De(n)[K]!==""&&(De(n)[K]=""),K>0&&(Xe(l,K-1),(ae=p[De(l)])==null||ae.focus()),q.preventDefault())}function I(q,K){var ve;const j=q.clipboardData;if(!j)return;const te=j.getData("text").replace(/\D/g,"");if(te.length===0)return;De(b)&&(St.set(null),Xe(b,!1));const ae=6-K,ie=Math.min(te.length,ae);for(let z=0;z<ie;z++)K+z<6&&(De(n)[K+z]=te[z],p[K+z].value=te[z]);Xe(l,K+ie),ie===ae&&Xe(l,K+ie-1),(ve=p[De(l)])==null||ve.focus(),q.preventDefault(),m()}const y=Qr("session_id_label"),_=Qr("validating");let N=ua(()=>i()?Qr(i().key,i().params):null);var B=Jl(),A=Zt(B),k=Zt(A),M=Zt(k,!0);Ft(k);var J=Wn(k,2);da(J,21,()=>De(n),pa,(q,K,j)=>{var te=Kl();ga(te);let ae;te.__input=ie=>w(ie,j),te.__keydown=ie=>E(ie,j),ba(te,"aria-label",`Digit ${j+1}`),fa(te,(ie,ve)=>p[ve]=ie,ie=>p==null?void 0:p[ie],()=>[j]),mr(ie=>{ae=ma(te,1,"digit-input svelte-ehqysg",null,ae,ie),ya(te,De(K)),te.disabled=De(d)},[()=>({selected:De(l)===j&&!De(d)})]),Vr("paste",te,ie=>I(ie,j)),Vr("focus",te,()=>Xe(l,j,!0)),yr(q,te)}),Ft(J);var X=Wn(J,2);{var ue=q=>{var K=Gl(),j=Zt(K,!0);Ft(K),mr(()=>zr(j,r())),yr(q,K)},C=(q,K)=>{{var j=te=>{var ae=Yl(),ie=Zt(ae),ve=Zt(ie,!0);Ft(ie),ha(2),Ft(ae),mr(()=>zr(ve,t())),yr(te,ae)};$n(q,te=>{De(d)&&te(j)},K)}};$n(X,q=>{i()?q(ue):q(C,!1)})}Ft(A),Ft(B),mr(()=>zr(M,e())),Vr("submit",A,q=>q.preventDefault()),yr(s,B),la(),u()}na(["input","keydown"]);function au(s){Xl(s,{})}export{au as component};
